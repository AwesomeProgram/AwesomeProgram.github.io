<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>贡献方式 &mdash; Solidity 0.8.13 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/a4_railroad_diagram.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/toggle.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/js/toggle.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Solidity 品牌指南" href="brand-guide.html" />
    <link rel="prev" title="已知bug列表" href="bugs.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #65afff" >
            <a href="index.html">
            <img src="_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                0.8.13
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
    
              <p class="caption" role="heading"><span class="caption-text">Basics</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="introduction-to-smart-contracts.html">智能合约概述</a></li>
<li class="toctree-l1"><a class="reference internal" href="installing-solidity.html">安装 Solidity 编译器</a></li>
<li class="toctree-l1"><a class="reference internal" href="solidity-by-example.html">Solidity 合约示例</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Language Description</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="layout-of-source-files.html">Solidity 源文件结构</a></li>
<li class="toctree-l1"><a class="reference internal" href="structure-of-a-contract.html">合约结构</a></li>
<li class="toctree-l1"><a class="reference internal" href="types.html">类型</a></li>
<li class="toctree-l1"><a class="reference internal" href="units-and-global-variables.html">单位和全局变量</a></li>
<li class="toctree-l1"><a class="reference internal" href="control-structures.html">表达式和控制结构</a></li>
<li class="toctree-l1"><a class="reference internal" href="contracts.html">合约</a></li>
<li class="toctree-l1"><a class="reference internal" href="assembly.html">内联汇编</a></li>
<li class="toctree-l1"><a class="reference internal" href="cheatsheet.html">速查表</a></li>
<li class="toctree-l1"><a class="reference internal" href="grammar.html">语法</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Compiler</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="using-the-compiler.html">使用编译器</a></li>
<li class="toctree-l1"><a class="reference internal" href="analysing-compilation-output.html">分析编译器的输出结果</a></li>
<li class="toctree-l1"><a class="reference internal" href="ir-breaking-changes.html">基于Solidity中间表征的Codegen变化</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Internals</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="internals/layout_in_storage.html">存储中的状态变量储存结构</a></li>
<li class="toctree-l1"><a class="reference internal" href="internals/layout_in_memory.html">内存中的存储结构</a></li>
<li class="toctree-l1"><a class="reference internal" href="internals/layout_in_calldata.html">调用数据的存储结构</a></li>
<li class="toctree-l1"><a class="reference internal" href="internals/variable_cleanup.html">清理变量</a></li>
<li class="toctree-l1"><a class="reference internal" href="internals/source_mappings.html">源代码映射</a></li>
<li class="toctree-l1"><a class="reference internal" href="internals/optimizer.html">优化器</a></li>
<li class="toctree-l1"><a class="reference internal" href="metadata.html">合约的元数据</a></li>
<li class="toctree-l1"><a class="reference internal" href="abi-spec.html">合约ABI规范</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Additional Material</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="050-breaking-changes.html">Solidity v0.5.0 突破性变化</a></li>
<li class="toctree-l1"><a class="reference internal" href="060-breaking-changes.html">Solidity 0.6.0 版本突破性变化</a></li>
<li class="toctree-l1"><a class="reference internal" href="070-breaking-changes.html">Solidity v0.7.0 突破性变化</a></li>
<li class="toctree-l1"><a class="reference internal" href="080-breaking-changes.html">Solidity v0.8.0 突破性变化</a></li>
<li class="toctree-l1"><a class="reference internal" href="natspec-format.html">风格指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="security-considerations.html">安全考虑</a></li>
<li class="toctree-l1"><a class="reference internal" href="smtchecker.html">SMT检查器和形式化验证</a></li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">资源</a></li>
<li class="toctree-l1"><a class="reference internal" href="path-resolution.html">Import Path Resolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="yul.html">Yul</a></li>
<li class="toctree-l1"><a class="reference internal" href="style-guide.html">风格指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="common-patterns.html">通用模式</a></li>
<li class="toctree-l1"><a class="reference internal" href="bugs.html">已知bug列表</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">贡献方式</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id4">团队电话会议</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id5">如何报告问题</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pull-request">Pull Request 的工作流</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id7">运行编译器测试</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id8">先决条件</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id11">运行测试</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id14">编写和运行语法测试</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#afl-fuzzer">通过 AFL 运行 Fuzzer</a></li>
<li class="toctree-l2"><a class="reference internal" href="#whiskers">Whiskers 系统</a></li>
<li class="toctree-l2"><a class="reference internal" href="#documentation-style">文档风格指南</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id16">英语</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id21">标题的大小写</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id23">扩写缩写</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id24">主动和被动语态</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id25">常用术语</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id26">代码示例</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id27">运行文档测试</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id28">Solidity语言设计</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="brand-guide.html">Solidity 品牌指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="language-influences.html">Language Influences</a></li>
</ul>

    <ul>
        <li>
            <a href="genindex.html">Keyword Index</a>
        </li>
    </ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #65afff" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Solidity</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>贡献方式</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/contributing.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="id1">
<h1>贡献方式<a class="headerlink" href="#id1" title="Permalink to this heading"></a></h1>
<p>对于大家的帮助，我们一如既往地感激。而且有很多选择，您可以为 Solidity 做出贡献。</p>
<p>特别是，我们感谢在以下领域的支持:</p>
<ul class="simple">
<li><p>报告问题。</p></li>
<li><p>修复和回应 <a class="reference external" href="https://github.com/ethereum/solidity/issues">Solidity的GitHub问题</a>，特别是那些被标记为
<a class="reference external" href="https://github.com/ethereum/solidity/labels/good%20first%20issue">“很好的第一个问题”</a>，这是
作为外部贡献者的介绍性问题。</p></li>
<li><p>完善文档。</p></li>
<li><p>将文档翻译成更多的语言。</p></li>
<li><p>在 <a class="reference external" href="https://ethereum.stackexchange.com">StackExchange</a> 和
<a class="reference external" href="https://gitter.im/ethereum/solidity">Solidity Gitter Chat</a> 上回答其他用户的问题。</p></li>
<li><p>通过在 <a class="reference external" href="https://forum.soliditylang.org/">Solidity论坛</a> 上提出语言修改或新功能并提供反馈，参与语言设计过程。</p></li>
</ul>
<p>为了开始参与，您可以尝试 <a class="reference internal" href="installing-solidity.html#building-from-source"><span class="std std-ref">从源代码编译</span></a>，以熟悉 Solidity 的组件和构建过程。
此外，精通在 Solidity 中编写智能合约可能是有用的。</p>
<p>请注意，本项目发布时有一个 <a class="reference external" href="https://raw.githubusercontent.com/ethereum/solidity/develop/CODE_OF_CONDUCT.md">贡献者行为准则</a>。通过参与这个项目–在问题、拉动请求或Gitter频道-您同意遵守其条款。</p>
<section id="id4">
<h2>团队电话会议<a class="headerlink" href="#id4" title="Permalink to this heading"></a></h2>
<p>如果您有问题或拉动请求要讨论，或有兴趣听听团队和贡献者正在做什么，您可以加入我们的公共团队电话会议：</p>
<ul class="simple">
<li><p>每周一下午3点，欧洲中部/中部时间。</p></li>
<li><p>每周三下午2点，欧洲中部/西部时间。</p></li>
</ul>
<p>这两个会议都在 <a class="reference external" href="https://meet.ethereum.org/solidity">Jitsi</a> 举行。</p>
</section>
<section id="id5">
<h2>如何报告问题<a class="headerlink" href="#id5" title="Permalink to this heading"></a></h2>
<p>要报告一个问题，请使用
<a class="reference external" href="https://github.com/ethereum/solidity/issues">GitHub问题跟踪器</a>。
当报告问题时，请提及以下细节：</p>
<ul class="simple">
<li><p>Solidity版本。</p></li>
<li><p>源代码（如果可以的话）。</p></li>
<li><p>操作系统。</p></li>
<li><p>重现该问题的步骤。</p></li>
<li><p>实际行为与预期行为。</p></li>
</ul>
<p>将导致问题的源代码减少到最低限度总是非常有帮助的，有时甚至可以澄清一个误解。</p>
</section>
<section id="pull-request">
<h2>Pull Request 的工作流<a class="headerlink" href="#pull-request" title="Permalink to this heading"></a></h2>
<p>为了进行贡献，请 fork 一个 <code class="docutils literal notranslate"><span class="pre">develop</span></code> 分支并在那里进行修改。
除了您 <em>做了什么</em> 之外，您还需要在提交信息中说明，
您 <em>为什么</em> 做这些修改（除非只是个微小的改动）。</p>
<p>在进行了 fork 之后，如果您还需要从 <code class="docutils literal notranslate"><span class="pre">develop</span></code> 分支 pull 任何变更的话
（例如，为了解决潜在的合并冲突），请避免使用 <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">rebase</span></code> ，
而是用 <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">rebase</span></code> 您的分支。</p>
<p>此外，如果您正在编写一个新的功能，请确保您在 <code class="docutils literal notranslate"><span class="pre">test/</span></code> 下添加适当的测试案例（见下文）。</p>
<p>但是，如果您在进行一个更大的变更，请先与
<a class="reference external" href="https://gitter.im/ethereum/solidity-dev">Solidity Development Gitter channel</a>
进行商量（与上文提到的那个功能不同，这个变更侧重于编译器和编程语言开发，而不是编程语言的使用）。</p>
<p>新的特性和 bug 修复会被添加到 <code class="docutils literal notranslate"><span class="pre">Changelog.md</span></code> 文件中：使用的时候请遵循上述方式。</p>
<p>最后，请确保您遵守了这个项目的 <a class="reference external" href="https://github.com/ethereum/solidity/blob/develop/CODING_STYLE.md">编码风格</a> 。
还有，虽然我们采用了持续集成测试，但是在提交 pull request 之前，请测试您的代码并确保它能在本地进行编译。</p>
<p>感谢您的帮助！</p>
</section>
<section id="id7">
<h2>运行编译器测试<a class="headerlink" href="#id7" title="Permalink to this heading"></a></h2>
<section id="id8">
<h3>先决条件<a class="headerlink" href="#id8" title="Permalink to this heading"></a></h3>
<p>为了运行所有的编译器测试，您可能想选择性地安装一些依赖项
（ <a class="reference external" href="https://github.com/ethereum/evmone/releases">evmone</a>，
<a class="reference external" href="https://github.com/Z3Prover/z3">libz3</a>， 和
<a class="reference external" href="https://github.com/ewasm/hera">libhera</a>）。</p>
<p>在macOS上，一些测试脚本需要安装 GNU 核心工具。
这可以用Homebrew来完成： <code class="docutils literal notranslate"><span class="pre">brew</span> <span class="pre">install</span> <span class="pre">coreutils</span></code>。</p>
<p>在Windows系统上，确保您有创建符号链接的权限，否则一些测试可能会失败。
管理员应该有这个权限，但您也可以
<a class="reference external" href="https://docs.microsoft.com/en-us/windows/security/threat-protection/security-policy-settings/create-symbolic-links#policy-management">将其授予其他用户</a>
或 <a class="reference external" href="https://docs.microsoft.com/en-us/windows/apps/get-started/enable-your-device-for-development">启用开发者模式</a>。</p>
</section>
<section id="id11">
<h3>运行测试<a class="headerlink" href="#id11" title="Permalink to this heading"></a></h3>
<p>Solidity包括不同类型的测试，其中大部分捆绑在
<a class="reference external" href="https://www.boost.org/doc/libs/release/libs/test/doc/html/index.html">Boost C++测试框架</a> 应用程序 <code class="docutils literal notranslate"><span class="pre">soltest</span></code>。
运行 <code class="docutils literal notranslate"><span class="pre">build/test/soltest</span></code> 或其包装器 <code class="docutils literal notranslate"><span class="pre">scripts/soltest.sh</span></code> 对大多数变化来说是足够的。</p>
<p><code class="docutils literal notranslate"><span class="pre">./scripts/tests.sh</span></code> 脚本自动执行大多数Solidity测试，
包括那些捆绑在 <a class="reference external" href="https://www.boost.org/doc/libs/release/libs/test/doc/html/index.html">Boost C++测试框架</a> 应用程序 <code class="docutils literal notranslate"><span class="pre">soltest</span></code>
（或其包装器 <code class="docutils literal notranslate"><span class="pre">scripts/soltest.sh</span></code>）中的测试，以及命令行测试和编译测试。</p>
<p>测试系统会自动尝试发现 <a class="reference external" href="https://github.com/ethereum/evmone/releases">evmone</a> 的位置，以运行语义测试。</p>
<p><code class="docutils literal notranslate"><span class="pre">evmone</span></code> 库必须位于 <code class="docutils literal notranslate"><span class="pre">deps</span></code> 或 <code class="docutils literal notranslate"><span class="pre">deps/lib</span></code> 目录下，相对于当前工作目录，
其父目录或其父的父目录。另外，可以通过 <code class="docutils literal notranslate"><span class="pre">ETH_EVMONE</span></code> 环境变量指定 <code class="docutils literal notranslate"><span class="pre">evmone</span></code> 共享对象的明确位置。</p>
<p><code class="docutils literal notranslate"><span class="pre">evmone</span></code> 主要用于运行语义和gas测试。
如果您没有安装它，您可以通过向 <code class="docutils literal notranslate"><span class="pre">scripts/soltest.sh</span></code> 传递 <code class="docutils literal notranslate"><span class="pre">--no-semantic-tests</span></code> 标志来跳过这些测试。</p>
<p>运行Ewasm测试默认是禁用的，可以通过 <code class="docutils literal notranslate"><span class="pre">./scripts/soltest.sh</span> <span class="pre">--ewasm</span></code> 明确启用，
要求 <a class="reference external" href="https://github.com/ewasm/hera">hera</a> 被 <code class="docutils literal notranslate"><span class="pre">soltest</span></code> 找到。
定位 <code class="docutils literal notranslate"><span class="pre">hera</span></code> 库的机制与 <code class="docutils literal notranslate"><span class="pre">evmone</span></code> 相同，只是用于指定明确位置的变量被称为 <code class="docutils literal notranslate"><span class="pre">ETH_HERA</span></code>。</p>
<p><code class="docutils literal notranslate"><span class="pre">evmone</span></code> 和 <code class="docutils literal notranslate"><span class="pre">hera</span></code> 库的文件名后缀都应该
是Linux上的 <code class="docutils literal notranslate"><span class="pre">.so</span></code>，Windows系统上的 <code class="docutils literal notranslate"><span class="pre">.dll</span></code>，MacOS上的 <code class="docutils literal notranslate"><span class="pre">.dylib</span></code>。</p>
<p>为了运行SMT测试， <code class="docutils literal notranslate"><span class="pre">libz3</span></code> 库必须被安装，并在编译器配置阶段被 <code class="docutils literal notranslate"><span class="pre">cmake</span></code> 可以找到。</p>
<p>如果您的系统没有安装 <code class="docutils literal notranslate"><span class="pre">libz3</span></code> 库，您应该在运行 <code class="docutils literal notranslate"><span class="pre">./scripts/tests.sh</span></code> 或 <code class="docutils literal notranslate"><span class="pre">./scripts/soltest.sh</span> <span class="pre">--no-smt</span></code> 之前，
通过导出 <code class="docutils literal notranslate"><span class="pre">SMT_FLAGS=--no-smt</span></code> 来禁用SMT测试。
这些测试是 <code class="docutils literal notranslate"><span class="pre">libsolidity/smtCheckerTests</span></code> 和 <code class="docutils literal notranslate"><span class="pre">libsolidity/smtCheckerTestsJSON</span></code>。</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>要获得Soltest运行的所有单元测试的列表，请运行 <code class="docutils literal notranslate"><span class="pre">./build/test/soltest</span> <span class="pre">--list_content=HRF</span></code>。</p>
</div>
<p>为了获得更快的结果，您可以运行一个子集，或特定的测试。</p>
<p>要运行测试的一个子集，可以使用过滤器：
<code class="docutils literal notranslate"><span class="pre">./scripts/soltest.sh</span> <span class="pre">-t</span> <span class="pre">TestSuite/TestName</span></code>,
其中 <code class="docutils literal notranslate"><span class="pre">TestName</span></code> 可以是通配符 <code class="docutils literal notranslate"><span class="pre">*</span></code>。</p>
<p>或者，举例来说，运行yul 消歧义器的所有测试：
<code class="docutils literal notranslate"><span class="pre">./scripts/soltest.sh</span> <span class="pre">-t</span> <span class="pre">&quot;yulOptimizerTests/disambiguator/*&quot;</span> <span class="pre">--no-smt</span></code>。</p>
<p><code class="docutils literal notranslate"><span class="pre">./build/test/soltest</span> <span class="pre">--help</span></code> 有关于所有可用选项的广泛帮助。</p>
<p>尤其是可以查看：</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.boost.org/doc/libs/release/libs/test/doc/html/boost_test/utf_reference/rt_param_reference/show_progress.html">show_progress (-p)</a> 来显示测试完成。</p></li>
<li><p><a class="reference external" href="https://www.boost.org/doc/libs/release/libs/test/doc/html/boost_test/utf_reference/rt_param_reference/run_test.html">run_test (-t)</a> 来运行特定的测试案例，以及</p></li>
<li><p><a class="reference external" href="https://www.boost.org/doc/libs/release/libs/test/doc/html/boost_test/utf_reference/rt_param_reference/report_level.html">report-level (-r)</a> 给出一个更详细的报告。</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>那些在Windows环境下使用的人，想在没有libz3的情况下运行上述基本集，可以使用Git Bash，
使用命令为： <code class="docutils literal notranslate"><span class="pre">./build/test/Release/soltest.exe</span> <span class="pre">--</span> <span class="pre">--no-smt</span></code>。
如果您在普通的命令提示符下运行，使用 <code class="docutils literal notranslate"><span class="pre">.\build\test\Release\soltest.exe</span> <span class="pre">--</span> <span class="pre">--no-smt</span></code>。</p>
</div>
<p>如果您想使用GDB进行调试，确保您的构建方式与 “通常” 不同。
例如，您可以在您的 <code class="docutils literal notranslate"><span class="pre">build</span></code> 文件夹中运行以下命令：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cmake -DCMAKE_BUILD_TYPE<span class="o">=</span>Debug ..
make
</pre></div>
</div>
<p>这会创建了一些符号，所以当您使用 <code class="docutils literal notranslate"><span class="pre">--debug</span></code> 标志调试测试时，
您可以访问其中的函数和变量，您可以用它来中断或打印。</p>
<p>CI运行额外的测试（包括 <code class="docutils literal notranslate"><span class="pre">solc-js</span></code> 和测试第三方Solidity框架），需要编译 Emscripten 目标。</p>
</section>
<section id="id14">
<h3>编写和运行语法测试<a class="headerlink" href="#id14" title="Permalink to this heading"></a></h3>
<p>语法测试检查编译器是否对无效的代码产生正确的错误信息，并正确接受有效的代码。
它们被保存在 <code class="docutils literal notranslate"><span class="pre">tests/libsolidity/syntaxTests</span></code> 文件夹下的单个文件中。
这些文件必须包含注释，说明各自测试的预期结果。
测试套件会根据给定的期望值进行编译和检查。</p>
<p>例如： <code class="docutils literal notranslate"><span class="pre">./test/libsolidity/syntaxTests/double_stateVariable_declaration.sol</span></code></p>
<p class="remix-link-container"><a class="remix-link reference external" href="https://remix.ethereum.org/?language=solidity&amp;version=0.8.13&amp;code=Y29udHJhY3QgdGVzdCB7CiAgICB1aW50MjU2IHZhcmlhYmxlOwogICAgdWludDEyOCB2YXJpYWJsZTsKfQovLyAtLS0tCi8vIOWjsOaYjumUmeivr++8mu+8iDM2LTUy77yJ44CC5qCH6K+G56ym5bey6KKr5aOw5piO44CC"><span class="link-icon"></span><span class="link-text">open in Remix</span></a></p>
<div class="highlight-solidity notranslate"><div class="highlight"><pre><span></span><span class="k">contract</span><span class="w"> </span><span class="ni">test</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint256</span><span class="w"> </span><span class="nv">variable</span><span class="p">;</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint128</span><span class="w"> </span><span class="nv">variable</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="c1">// ----</span>
<span class="c1">// 声明错误：（36-52）。标识符已被声明。</span>
</pre></div>
</div>
<p>语法测试必须至少包含被测合约本身，后面是分隔符 <code class="docutils literal notranslate"><span class="pre">//----</span></code>。
分隔符后面的注释是用来描述预期的编译器错误或警告的。
数字范围表示错误发生在源代码中的位置。
如果您希望合约在编译时没有任何错误或警告，您可以不使用分隔符和后面的注释。</p>
<p>在上面的例子中，状态变量 <code class="docutils literal notranslate"><span class="pre">variable</span></code> 被声明了两次，这是不允许的。这导致了一个 <code class="docutils literal notranslate"><span class="pre">声明错误</span></code>，说明标识符已经被声明。</p>
<p>用来进行那些测试的工具叫做 <code class="docutils literal notranslate"><span class="pre">isoltest</span></code>，可以在 <code class="docutils literal notranslate"><span class="pre">./build/test/tools/</span></code> 下找到。
它是一个交互工具，允许您使用您喜欢的文本编辑器编辑失败的合约。
让我们把第二个 <code class="docutils literal notranslate"><span class="pre">variable</span></code> 的声明去掉来使测试失败：</p>
<p class="remix-link-container"><a class="remix-link reference external" href="https://remix.ethereum.org/?language=solidity&amp;version=0.8.13&amp;code=Y29udHJhY3QgdGVzdCB7CiAgICB1aW50MjU2IHZhcmlhYmxlOwp9Ci8vIC0tLS0KLy8g5aOw5piO6ZSZ6K+v77ya77yIMzYtNTLvvInjgILmoIfor4bnrKblt7Looqvlo7DmmI7jgII="><span class="link-icon"></span><span class="link-text">open in Remix</span></a></p>
<div class="highlight-solidity notranslate"><div class="highlight"><pre><span></span><span class="k">contract</span><span class="w"> </span><span class="ni">test</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint256</span><span class="w"> </span><span class="nv">variable</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="c1">// ----</span>
<span class="c1">// 声明错误：（36-52）。标识符已被声明。</span>
</pre></div>
</div>
<p>再次运行 <code class="docutils literal notranslate"><span class="pre">./build/test/tools/isoltest</span></code> 就会得到一个失败的测试：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>syntaxTests/double_stateVariable_declaration.sol: FAIL
    Contract:
        contract test {
            uint256 variable;
        }

    Expected result:
        DeclarationError: (36-52): Identifier already declared.
    Obtained result:
        Success
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">isoltest</span></code> 在获得的结果旁边打印出预期的结果，
还提供了一个编辑，更新，跳过当前合约文件或退出应用程序的办法。</p>
<p>它为失败的测试提供了几种选择：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">edit</span></code>：  <code class="docutils literal notranslate"><span class="pre">isoltest</span></code> 试图在一个编辑器中打开合约，以便您可以调整它。它或者使用命令行上给出的编辑器（如 <code class="docutils literal notranslate"><span class="pre">isoltest</span> <span class="pre">--editor</span> <span class="pre">/path/to/editor</span></code>），或者在环境变量 <code class="docutils literal notranslate"><span class="pre">EDITOR</span></code> 中，或者只是 <code class="docutils literal notranslate"><span class="pre">/usr/bin/editor</span></code> （按这个顺序）。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">update</span></code>： 更新测试中的合约。这将会移除包含了不匹配异常的注解，或者增加缺失的预想结果。然后测试会重新开始。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">skip</span></code>： 跳过这一特定测试的执行。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">quit</span></code>： 退出 <code class="docutils literal notranslate"><span class="pre">isoltest</span></code>。</p></li>
</ul>
<p>所有这些选项都适用于当前的合约，除了 <code class="docutils literal notranslate"><span class="pre">quit</span></code>，它可以停止整个测试过程。</p>
<p>在上边的情况自动更新合约会把它变为</p>
<p class="remix-link-container"><a class="remix-link reference external" href="https://remix.ethereum.org/?language=solidity&amp;version=0.8.13&amp;code=Y29udHJhY3QgdGVzdCB7CiAgICB1aW50MjU2IHZhcmlhYmxlOwp9Ci8vIC0tLS0="><span class="link-icon"></span><span class="link-text">open in Remix</span></a></p>
<div class="highlight-solidity notranslate"><div class="highlight"><pre><span></span><span class="k">contract</span><span class="w"> </span><span class="ni">test</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="kt">uint256</span><span class="w"> </span><span class="nv">variable</span><span class="p">;</span><span class="w"></span>
<span class="p">}</span><span class="w"></span>
<span class="c1">// ----</span>
</pre></div>
</div>
<p>并重新运行测试。它将会通过：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Re-running test case...
syntaxTests/double_stateVariable_declaration.sol: OK
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>为合约文件选择一个能解释其测试内容的名字，例如： <code class="docutils literal notranslate"><span class="pre">double_variable_declaration.sol</span></code>。
不要把一个以上的合约放在一个文件中，除非您在测试继承或跨合约的调用。
每个文件应该测试您的新功能的一个方面。</p>
</div>
</section>
</section>
<section id="afl-fuzzer">
<h2>通过 AFL 运行 Fuzzer<a class="headerlink" href="#afl-fuzzer" title="Permalink to this heading"></a></h2>
<p>Fuzzing 是一种测试技术，它可以通过运行多少不等的随机输入来找出异常的执行状态（片段故障、异常等等）。
现代的 fuzzer 已经可以很聪明地在输入中进行直接的查询。
我们有一个专门的程序叫做 <code class="docutils literal notranslate"><span class="pre">solfuzzer</span></code>，它可以将源代码作为输入，
当发生一个内部编译错误，片段故障或者类似的错误时失败，但当代码包含错误的时候则不会失败。
通过这种方法，fuzzing 工具可以找到那些编译级别的内部错误。</p>
<p>我们主要使用 <a class="reference external" href="https://lcamtuf.coredump.cx/afl/">AFL</a> 来进行 fuzzing 测试。
您需要手工下载和构建 AFL。然后用 AFL 作为编译器来构建 Solidity（或只是 <code class="docutils literal notranslate"><span class="pre">solfuzzer</span></code> 二进制文件）：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span> build
<span class="c1"># 如果需要的话</span>
make clean
cmake .. -DCMAKE_C_COMPILER<span class="o">=</span>path/to/afl-gcc -DCMAKE_CXX_COMPILER<span class="o">=</span>path/to/afl-g++
make solfuzzer
</pre></div>
</div>
<p>在这个阶段，您应该能够看到类似以下的信息：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Scanning dependencies of target solfuzzer
[ 98%] Building CXX object test/tools/CMakeFiles/solfuzzer.dir/fuzzer.cpp.o
afl-cc 2.52b by &lt;lcamtuf@google.com&gt;
afl-as 2.52b by &lt;lcamtuf@google.com&gt;
[+] Instrumented 1949 locations (64-bit, non-hardened mode, ratio 100%).
[100%] Linking CXX executable solfuzzer
</pre></div>
</div>
<p>如果指示信息没有出现，尝试切换指向AFL的clang二进制文件的cmake标志：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># 如果之前失败了</span>
make clean
cmake .. -DCMAKE_C_COMPILER<span class="o">=</span>path/to/afl-clang -DCMAKE_CXX_COMPILER<span class="o">=</span>path/to/afl-clang++
make solfuzzer
</pre></div>
</div>
<p>否则，在执行时，fuzzer 就会停止，并出现错误，说二进制没有被检测到。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>afl-fuzz 2.52b by &lt;lcamtuf@google.com&gt;
... (truncated messages)
[*] Validating target binary...

[-] Looks like the target binary is not instrumented! The fuzzer depends on
    compile-time instrumentation to isolate interesting test cases while
    mutating the input data. For more information, and for tips on how to
    instrument binaries, please see /usr/share/doc/afl-doc/docs/README.

    When source code is not available, you may be able to leverage QEMU
    mode support. Consult the README for tips on how to enable this.
    (It is also possible to use afl-fuzz as a traditional, &quot;dumb&quot; fuzzer.
    For that, you can use the -n option - but expect much worse results.)

[-] PROGRAM ABORT : No instrumentation detected
         Location : check_binary(), afl-fuzz.c:6920
</pre></div>
</div>
<p>接下来，您需要一些示例源文件。这使得 fuzzer 更容易发现错误。
您可以从语法测试中复制一些文件，或者从文档或其他测试中提取测试文件。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mkdir /tmp/test_cases
<span class="nb">cd</span> /tmp/test_cases
<span class="c1"># 从测试中提取：</span>
path/to/solidity/scripts/isolate_tests.py path/to/solidity/test/libsolidity/SolidityEndToEndTest.cpp
<span class="c1"># 从文件中摘录：</span>
path/to/solidity/scripts/isolate_tests.py path/to/solidity/docs
</pre></div>
</div>
<p>AFL 的文档指出，账册（初始的输入文件）不应该太大。
每个文件本身不应该超过 1 kB，并且每个功能最多只能有一个输入文件；
所以最好从少量的输入文件开始。
此外还有一个叫做 <code class="docutils literal notranslate"><span class="pre">afl-cmin</span></code> 的工具，
可以将输入文件整理为可以具有近似行为的二进制代码。</p>
<p>现在运行 fuzzer（ <code class="docutils literal notranslate"><span class="pre">-m</span></code> 参数将使用的内存大小扩展为 60 MB）：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>afl-fuzz -m <span class="m">60</span> -i /tmp/test_cases -o /tmp/fuzzer_reports -- /path/to/solfuzzer
</pre></div>
</div>
<p>fuzzer 会将导致失败的源文件创建在 <code class="docutils literal notranslate"><span class="pre">/tmp/fuzzer_reports</span></code> 中。
通常它会找到产生相似错误的类似的源文件。
您可以使用 <code class="docutils literal notranslate"><span class="pre">scripts/uniqueErrors.sh</span></code> 工具来那些独特的错误。</p>
</section>
<section id="whiskers">
<h2>Whiskers 系统<a class="headerlink" href="#whiskers" title="Permalink to this heading"></a></h2>
<p><em>Whiskers</em> 是一个类似于 <a class="reference external" href="https://mustache.github.io">Mustache</a> 的字符串模板化系统。
它被编译器用在不同的地方，以帮助代码的可读性，从而帮助代码的可维护性和可验证性。</p>
<p>该语法与Mustache有很大区别。模板标记 <code class="docutils literal notranslate"><span class="pre">{{</span></code> 和 <code class="docutils literal notranslate"><span class="pre">}}</span></code> 被 <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> 和 <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> 取代，
以帮助解析并避免与 <a class="reference internal" href="yul.html#yul"><span class="std std-ref">Yul</span></a> 的冲突
（符号 <code class="docutils literal notranslate"><span class="pre">&lt;</span></code> 和 <code class="docutils literal notranslate"><span class="pre">&gt;</span></code> 在内联汇编中是无效的，而 <code class="docutils literal notranslate"><span class="pre">{</span></code> 和 <code class="docutils literal notranslate"><span class="pre">}</span></code> 是用来限定块的）。
另一个限制是，列表只能解决一个深度的问题，而且它们不会递归。这在将来可能会改变。</p>
<p>下面是一个粗略的说明：</p>
<p>任何出现的 <code class="docutils literal notranslate"><span class="pre">&lt;name&gt;</span></code> 的地方都会被提供的变量 <code class="docutils literal notranslate"><span class="pre">name</span></code> 的字符串值替换，没有任何转义，也没有迭代替换。
可以用 <code class="docutils literal notranslate"><span class="pre">&lt;#name&gt;...&lt;/name&gt;</span></code> 来划定一个区域。
该区域中的内容将进行多次拼接，每次拼接会使用相应变量集中的值替换区域中的 <code class="docutils literal notranslate"><span class="pre">&lt;inner&gt;</span></code> 项，
模板系统中提供了多少组变量集，就会进行多少次拼接。顶层变量也可以在这种区域内使用。</p>
<p>还有一些判断条件的表达式 <code class="docutils literal notranslate"><span class="pre">&lt;?name</span> <span class="pre">&lt;!name&gt;...&lt;/name&gt;</span></code>，
根据布尔参数 <code class="docutils literal notranslate"><span class="pre">name</span></code> 的值，会在第一段或第二段继续递归地替换模板。
如果使用 <code class="docutils literal notranslate"><span class="pre">&lt;?+name&gt;...&lt;!+name&gt;...&lt;/+name&gt;</span></code> 这种表达式，那么检查的是字符串参数 <code class="docutils literal notranslate"><span class="pre">name</span></code> 是否为非空。</p>
</section>
<section id="documentation-style">
<span id="id15"></span><h2>文档风格指南<a class="headerlink" href="#documentation-style" title="Permalink to this heading"></a></h2>
<p>在下面的部分，您可以找到专门针对 Solidity 文档贡献的风格建议。</p>
<section id="id16">
<h3>英语<a class="headerlink" href="#id16" title="Permalink to this heading"></a></h3>
<p>使用英语，除非使用项目或品牌名称，否则首选英式拼写。
尽量减少使用当地的俚语和参考资料，尽量使您的语言对所有的读者都尽可能清晰。以下是一些参考资料，希望对大家有所帮助：</p>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Simplified_Technical_English">简化技术英语</a></p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/International_English">国际英语</a></p></li>
<li><p><a class="reference external" href="https://en.oxforddictionaries.com/spelling/british-and-spelling">英式英语拼写</a></p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>虽然官方的 Solidity 文档是用英语写的，但也有社区贡献的其他语言的 <a class="reference internal" href="index.html#translations"><span class="std std-ref">翻译</span></a> 可用。
请参考 <a class="reference external" href="https://github.com/solidity-docs/translation-guide">翻译指南</a> 以了解如何为社区翻译作出贡献。</p>
</div>
</section>
<section id="id21">
<h3>标题的大小写<a class="headerlink" href="#id21" title="Permalink to this heading"></a></h3>
<p>在标题中使用 <a class="reference external" href="https://titlecase.com">标题大小写</a>。
这意味着标题中的所有主词都要大写，但不包括冠词，连接词和介词，除非它们是标题的开头。</p>
<p>例如，下列各项都是正确的：</p>
<ul class="simple">
<li><p>Title Case for Headings.</p></li>
<li><p>For Headings Use Title Case.</p></li>
<li><p>Local and State Variable Names.</p></li>
<li><p>Order of Layout.</p></li>
</ul>
</section>
<section id="id23">
<h3>扩写缩写<a class="headerlink" href="#id23" title="Permalink to this heading"></a></h3>
<p>使用扩展的缩略语来表达单词，例如：</p>
<ul class="simple">
<li><p>“Do not” 替代 “Don’t”。</p></li>
<li><p>“Can not” 替代 “Can’t”。</p></li>
</ul>
</section>
<section id="id24">
<h3>主动和被动语态<a class="headerlink" href="#id24" title="Permalink to this heading"></a></h3>
<p>主动语态通常被推荐用于教程风格的文档，因为它有助于读者理解谁或什么在执行一项任务。
然而，由于 Solidity 文档是教程和参考内容的混合物，被动语态有时更适用。</p>
<p>综上所述：</p>
<ul class="simple">
<li><p>在技术参考方面使用被动语态，例如语言定义和Ethereum虚拟机的内部情况。</p></li>
<li><p>在描述关于如何应用 Solidity 某方面的建议时，使用主动语态。</p></li>
</ul>
<p>例如，下面的内容是被动语态，因为它指定了 Solidity 的一个方面：</p>
<blockquote>
<div><p>函数可以被声明为 <code class="docutils literal notranslate"><span class="pre">pure</span></code>，在这种情况下，它们承诺不读取或修改状态。</p>
</div></blockquote>
<p>例如，下面是主动语态，因为它讨论了Solidity的一个应用：</p>
<blockquote>
<div><p>在调用编译器时，您可以指定如何发现一个路径的第一个元素，也可以指定路径前缀的重映射。</p>
</div></blockquote>
</section>
<section id="id25">
<h3>常用术语<a class="headerlink" href="#id25" title="Permalink to this heading"></a></h3>
<ul class="simple">
<li><p>“函数参数“ 和 “返回变量“，而不是输入和输出参数。</p></li>
</ul>
</section>
<section id="id26">
<h3>代码示例<a class="headerlink" href="#id26" title="Permalink to this heading"></a></h3>
<p>CI进程在您创建PR时，使用 <code class="docutils literal notranslate"><span class="pre">./test/cmdlineTests.sh</span></code> 脚本测试所有
以 <code class="docutils literal notranslate"><span class="pre">pragma</span> <span class="pre">solidity</span></code>， <code class="docutils literal notranslate"><span class="pre">contract</span></code>， <code class="docutils literal notranslate"><span class="pre">library</span></code> 或 <code class="docutils literal notranslate"><span class="pre">interface</span></code> 开头的代码块格式的示例代码。
如果您正在添加新的代码实例，在创建PR之前确保它们能够工作并通过测试。</p>
<p>确保所有的代码实例以 <code class="docutils literal notranslate"><span class="pre">pragma</span></code> 版本开始，跨越合约代码有效的最大范围。
例如 <code class="docutils literal notranslate"><span class="pre">pragma</span> <span class="pre">solidity</span> <span class="pre">&gt;=0.4.0</span> <span class="pre">&lt;0.9.0;</span></code>。</p>
</section>
<section id="id27">
<h3>运行文档测试<a class="headerlink" href="#id27" title="Permalink to this heading"></a></h3>
<p>通过运行 <code class="docutils literal notranslate"><span class="pre">./scripts/docs.sh</span></code> 来确保您的贡献通过我们的文档测试，
它安装了文档所需的依赖，并检查任何问题，如无效的链接或语法问题。</p>
</section>
</section>
<section id="id28">
<h2>Solidity语言设计<a class="headerlink" href="#id28" title="Permalink to this heading"></a></h2>
<p>为了积极参与语言设计过程，并分享您关于Solidity未来的想法，请加入 <a class="reference external" href="https://forum.soliditylang.org/">Solidity论坛</a>。</p>
<p>Solidity论坛作为提出和讨论新的语言功能及其在早期构思阶段的实现或现有功能的修改的一个地方。</p>
<p>一旦提案变得更加具体，
它们的实施也将在 <a class="reference external" href="https://github.com/ethereum/solidity">Solidity GitHub仓库</a> 中以问题的形式讨论。</p>
<p>除了论坛和问题讨论之外，我们还定期举办语言设计讨论会议，对选定的主题，问题或功能实现进行详细的辩论。
这些会议的邀请函通过论坛共享。</p>
<p>我们也在论坛中分享反馈调查和其他与语言设计相关的内容。</p>
<p>如果您想知道团队在实施新功能方面的情况，
您可以在 <a class="reference external" href="https://github.com/ethereum/solidity/projects/43">Solidity Github项目</a> 中关注实施状况。
设计积压中的问题需要进一步规范，将在语言设计电话会议或常规团队电话会议中讨论。
您可以通过从默认分支（ <cite>develop</cite> ）到 <a class="reference external" href="https://github.com/ethereum/solidity/tree/breaking">breaking 分支</a>
来查看下一个突破性版本即将发生的变化。</p>
<p>对于特殊情况和问题，您可以通过 <a class="reference external" href="https://gitter.im/ethereum/solidity-dev">Solidity-dev Gitter 频道</a> 与我们联系，
这是一个专门的聊天室，用于围绕 Solidity 编译器和语言开发进行对话。</p>
<p>我们很高兴听到你对我们如何改进语言设计过程，使之更加协作和透明的想法。</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="bugs.html" class="btn btn-neutral float-left" title="已知bug列表" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="brand-guide.html" class="btn btn-neutral float-right" title="Solidity 品牌指南" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016-2021, Ethereum.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
    <p>
        <a href="credits-and-attribution.html">Credits and attribution</a>.
    </p>


</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
    <span class="fa fa-book fa-element"> RTD </span>

    <span class="fa fa-element">
    <input class="container_toggle" type="checkbox" id="switch" name="mode">
    <label for="switch"></label>
    </span>

    <span class="fa fa-v fa-element"> v:  <span class="fa fa-caret-down"></span></span>

    </span>
    <div class="rst-other-versions">
        <dl>
            <dt>Downloads</dt> 
        </dl>
        <dl>
            <dt>Versions</dt> 
        </dl>
        <dl>
            
            <dt>On Read the Docs</dt>
            <dd>
                <a href="///projects//?fromdocs=">Project Home</a>
            </dd>
            <dd>
                <a href="///builds//?fromdocs=">Builds</a>
            </dd>
        </dl>
    </div>
</div><script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>