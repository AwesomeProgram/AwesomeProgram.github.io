<!DOCTYPE HTML>
<html lang="zh-CN" class="sidebar-visible no-js navy">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>å¯åŠ¨åŒºå—é“¾ç½‘ç»œ - ä¿¡æ¯æŠ€æœ¯ | AwesomeProgram</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="æ‰€æ€å³æ‰€è§ï¼Œæ‰€è§å³æ‰€å¾—ï¼Œæ‰€å¾—çš†æ‰€æƒ³ï¼ŒæŠ€æœ¯ä»æœªåœæ­‡ï¼Œä¹Ÿæœªæ›¾ç¼ºä¹">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "navy";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('navy')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../PrefixChapter.html">å‰è¨€</a></li><li class="chapter-item expanded "><a href="../rust/chapter_1.html"><strong aria-hidden="true">1.</strong> Rust</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../rust/chapter_1_1.html"><strong aria-hidden="true">1.1.</strong> Rust è¯­æ³•ç»“æ„</a></li><li class="chapter-item expanded "><a href="../rust/chapter_1_4.html"><strong aria-hidden="true">1.2.</strong> Rust æ ‡å‡†åº“</a></li><li class="chapter-item expanded "><a href="../rust/chapter_1_5.html"><strong aria-hidden="true">1.3.</strong> Rust å·¥å…·é“¾</a></li><li class="chapter-item expanded "><a href="../rust/chapter_1_6.html"><strong aria-hidden="true">1.4.</strong> Rust ç±»å‹æ“ä½œ</a></li><li class="chapter-item expanded "><a href="../rust/chapter_1_7.html"><strong aria-hidden="true">1.5.</strong> Rust ç¼–ç èŒƒå¼</a></li></ol></li><li class="chapter-item expanded "><a href="../go/chapter_1.html"><strong aria-hidden="true">2.</strong> Go</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../go/chapter_1_1.html"><strong aria-hidden="true">2.1.</strong> Go è¯­æ³•ç»“æ„</a></li><li class="chapter-item expanded "><a href="../go/chapter_1_2.html"><strong aria-hidden="true">2.2.</strong> Go æ ‡å‡†åº“</a></li></ol></li><li class="chapter-item expanded "><a href="../js-ts/chapter_1.html"><strong aria-hidden="true">3.</strong> JavaScript-TypeScript</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../js-ts/chapter_1_1.html"><strong aria-hidden="true">3.1.</strong> JSä¸TS è¯­æ³•ç»“æ„</a></li><li class="chapter-item expanded "><a href="../js-ts/chapter_1_2.html"><strong aria-hidden="true">3.2.</strong> JSä¸TS æ ‡å‡†åº“</a></li></ol></li><li class="chapter-item expanded "><a href="../c-cpp/chapter_1.html"><strong aria-hidden="true">4.</strong> C-C++</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../c-cpp/chapter_1_1.html"><strong aria-hidden="true">4.1.</strong> Cä¸C++ è¯­æ³•ç»“æ„</a></li><li class="chapter-item expanded "><a href="../c-cpp/chapter_1_2.html"><strong aria-hidden="true">4.2.</strong> Cä¸C++ æ ‡å‡†åº“</a></li></ol></li><li class="chapter-item expanded "><a href="../chapter_3.html"><strong aria-hidden="true">5.</strong> å„è¯­è¨€å¯¹æ¯”</a></li><li class="chapter-item expanded "><a href="../blockchain/chapter_1.html"><strong aria-hidden="true">6.</strong> åŒºå—é“¾</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../blockchain/chapter_1_1.html"><strong aria-hidden="true">6.1.</strong> åŒºå—é“¾ç®€å²</a></li><li class="chapter-item expanded "><a href="../blockchain/chapter_1_2.html"><strong aria-hidden="true">6.2.</strong> åŒºå—é“¾æ¡†æ¶</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../blockchain/chapter_1_2_1.html"><strong aria-hidden="true">6.2.1.</strong> substrate</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../blockchain/chapter_1_2_1_1.html"><strong aria-hidden="true">6.2.1.1.</strong> åŸºæœ¬åŸç†</a></li><li class="chapter-item expanded "><a href="../blockchain/chapter_1_2_1_2.html"><strong aria-hidden="true">6.2.1.2.</strong> æ„å»ºä¸ç¼–ç </a></li><li class="chapter-item expanded "><a href="../blockchain/chapter_1_2_1_3.html" class="active"><strong aria-hidden="true">6.2.1.3.</strong> å¯åŠ¨åŒºå—é“¾ç½‘ç»œ</a></li><li class="chapter-item expanded "><a href="../blockchain/chapter_1_2_1_4.html"><strong aria-hidden="true">6.2.1.4.</strong> è‡ªå®šä¹‰pallet</a></li><li class="chapter-item expanded "><a href="../blockchain/chapter_1_2_1_5.html"><strong aria-hidden="true">6.2.1.5.</strong> å¼€å‘æ™ºèƒ½åˆçº¦</a></li><li class="chapter-item expanded "><a href="../blockchain/chapter_1_2_1_6.html"><strong aria-hidden="true">6.2.1.6.</strong> æ¡¥æ¥å…¶å®ƒé“¾</a></li><li class="chapter-item expanded "><a href="../blockchain/chapter_1_2_1_7.html"><strong aria-hidden="true">6.2.1.7.</strong> å·¥å…·é›†æˆ</a></li><li class="chapter-item expanded "><a href="../blockchain/chapter_1_2_1_8.html"><strong aria-hidden="true">6.2.1.8.</strong> æµ‹è¯•</a></li></ol></li><li class="chapter-item expanded "><a href="../blockchain/chapter_1_2_2.html"><strong aria-hidden="true">6.2.2.</strong> fabric</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../blockchain/chapter_1_2_2_1.html"><strong aria-hidden="true">6.2.2.1.</strong> åŸºæœ¬åŸç†</a></li><li class="chapter-item expanded "><a href="../blockchain/chapter_1_2_2_2.html"><strong aria-hidden="true">6.2.2.2.</strong> æ„å»ºä¸å¼€å‘</a></li></ol></li><li class="chapter-item expanded "><a href="../blockchain/chapter_1_2_3.html"><strong aria-hidden="true">6.2.3.</strong> EOSIO</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../blockchain/chapter_1_2_3_1.html"><strong aria-hidden="true">6.2.3.1.</strong> åŸºæœ¬åŸç†</a></li><li class="chapter-item expanded "><a href="../blockchain/chapter_1_2_3_2.html"><strong aria-hidden="true">6.2.3.2.</strong> æ„å»ºä¸å¼€å‘</a></li></ol></li><li class="chapter-item expanded "><a href="../blockchain/chapter_1_3.html"><strong aria-hidden="true">6.2.4.</strong> æ™ºèƒ½åˆçº¦ä¸DApp</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../blockchain/chapter_1_3_1.html"><strong aria-hidden="true">6.2.4.1.</strong> Move</a></li><li class="chapter-item expanded "><a href="../blockchain/chapter_1_3_2.html"><strong aria-hidden="true">6.2.4.2.</strong> Solidity</a></li><li class="chapter-item expanded "><a href="../blockchain/chapter_1_3_3.html"><strong aria-hidden="true">6.2.4.3.</strong> Hardhat</a></li></ol></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../cloud/chapter_1.html"><strong aria-hidden="true">7.</strong> äº‘è®¡ç®—</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../cloud/chapter_1_1.html"><strong aria-hidden="true">7.1.</strong> äº‘è®¡ç®—ç®€å²</a></li><li class="chapter-item expanded "><a href="../cloud/chapter_1_2.html"><strong aria-hidden="true">7.2.</strong> èµ„æºç¼–æ’æ¡†æ¶</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../cloud/chapter_1_2_1.html"><strong aria-hidden="true">7.2.1.</strong> kubernetes</a></li><li class="chapter-item expanded "><a href="../cloud/chapter_1_2_2.html"><strong aria-hidden="true">7.2.2.</strong> openstack</a></li></ol></li><li class="chapter-item expanded "><a href="../cloud/chapter_1_3.html"><strong aria-hidden="true">7.3.</strong> è™šæ‹ŸåŒ–</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../cloud/chapter_1_3_1.html"><strong aria-hidden="true">7.3.1.</strong> è®¡ç®—</a></li><li class="chapter-item expanded "><a href="../cloud/chapter_1_3_2.html"><strong aria-hidden="true">7.3.2.</strong> ç½‘ç»œ</a></li><li class="chapter-item expanded "><a href="../cloud/chapter_1_3_3.html"><strong aria-hidden="true">7.3.3.</strong> å­˜å‚¨</a></li></ol></li><li class="chapter-item expanded "><a href="../cloud/chapter_1_4.html"><strong aria-hidden="true">7.4.</strong> å®¹å™¨</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../cloud/chapter_1_4_1.html"><strong aria-hidden="true">7.4.1.</strong> docker</a></li><li class="chapter-item expanded "><a href="../cloud/chapter_1_4_2.html"><strong aria-hidden="true">7.4.2.</strong> containerd</a></li><li class="chapter-item expanded "><a href="../cloud/chapter_1_4_3.html"><strong aria-hidden="true">7.4.3.</strong> podman</a></li></ol></li><li class="chapter-item expanded "><a href="../cloud/chapter_1_5.html"><strong aria-hidden="true">7.5.</strong> é«˜çº§è¯­è¨€è™šæ‹Ÿæœº</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../cloud/chapter_1_5_1.html"><strong aria-hidden="true">7.5.1.</strong> wasm</a></li><li class="chapter-item expanded "><a href="../cloud/chapter_1_5_2.html"><strong aria-hidden="true">7.5.2.</strong> jvm</a></li><li class="chapter-item expanded "><a href="../cloud/chapter_1_5_3.html"><strong aria-hidden="true">7.5.3.</strong> evm</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../privacy/chapter_1.html"><strong aria-hidden="true">8.</strong> éšç§è®¡ç®—</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../privacy/chapter_1_1.html"><strong aria-hidden="true">8.1.</strong> å¯†ç å­¦ç›¸å…³</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../privacy/chapter_1_1_1.html"><strong aria-hidden="true">8.1.1.</strong> é›¶çŸ¥è¯†è¯æ˜</a></li><li class="chapter-item expanded "><a href="../privacy/chapter_1_1_2.html"><strong aria-hidden="true">8.1.2.</strong> MPC</a></li><li class="chapter-item expanded "><a href="../privacy/chapter_1_1_3.html"><strong aria-hidden="true">8.1.3.</strong> å·®åˆ†éšç§</a></li><li class="chapter-item expanded "><a href="../privacy/chapter_1_1_4.html"><strong aria-hidden="true">8.1.4.</strong> ç§˜å¯†å…±äº«</a></li><li class="chapter-item expanded "><a href="../privacy/chapter_1_1_5.html"><strong aria-hidden="true">8.1.5.</strong> åŒæ€åŠ å¯†</a></li></ol></li><li class="chapter-item expanded "><a href="../privacy/chapter_1_2.html"><strong aria-hidden="true">8.2.</strong> å¯ä¿¡æ‰§è¡Œç¯å¢ƒ</a></li><li class="chapter-item expanded "><a href="../privacy/chapter_1_3.html"><strong aria-hidden="true">8.3.</strong> è”é‚¦å­¦ä¹ </a></li></ol></li><li class="chapter-item expanded "><a href="../quantum/chapter_1.html"><strong aria-hidden="true">9.</strong> é‡å­è®¡ç®—</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../quantum/chapter_1_1.html"><strong aria-hidden="true">9.1.</strong> é‡å­çŠ¶æ€ä¸é‡å­æ¯”ç‰¹</a></li><li class="chapter-item expanded "><a href="../quantum/chapter_1_2.html"><strong aria-hidden="true">9.2.</strong> å¤šé‡å­æ¯”ç‰¹ä¸é‡å­çº ç¼ </a></li><li class="chapter-item expanded "><a href="../quantum/chapter_1_3.html"><strong aria-hidden="true">9.3.</strong> é‡å­åè®®å’Œé‡å­ç®—æ³•</a></li><li class="chapter-item expanded "><a href="../quantum/chapter_1_4.html"><strong aria-hidden="true">9.4.</strong> é‡å­ç®—æ³•çš„åº”ç”¨</a></li><li class="chapter-item expanded "><a href="../quantum/chapter_1_5.html"><strong aria-hidden="true">9.5.</strong> ä½¿ç”¨é‡å­ç”µè·¯ç ”ç©¶é‡å­ç¡¬ä»¶</a></li><li class="chapter-item expanded "><a href="../quantum/chapter_1_6.html"><strong aria-hidden="true">9.6.</strong> ä½¿ç”¨å¾®æ³¢è„‰å†²ç ”ç©¶é‡å­ç¡¬ä»¶</a></li><li class="chapter-item expanded "><a href="../quantum/chapter_1_7.html"><strong aria-hidden="true">9.7.</strong> é‡å­è®¡ç®—å®éªŒå®¤</a></li><li class="chapter-item expanded "><a href="../quantum/chapter_1_8.html"><strong aria-hidden="true">9.8.</strong> é‡å­è®¡ç®—æ¸¸æˆå’Œæ¼”ç¤º</a></li><li class="chapter-item expanded "><a href="../quantum/chapter_1_9.html"><strong aria-hidden="true">9.9.</strong> é‡å­è®¡ç®—åº”ç”¨å¼€å‘</a></li></ol></li><li class="chapter-item expanded "><a href="../chapter_8.html"><strong aria-hidden="true">10.</strong> è½¯è€ƒè®°å½•</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">ä¿¡æ¯æŠ€æœ¯ | AwesomeProgram</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="å¯åŠ¨åŒºå—é“¾ç½‘ç»œ"><a class="header" href="#å¯åŠ¨åŒºå—é“¾ç½‘ç»œ">å¯åŠ¨åŒºå—é“¾ç½‘ç»œ</a></h1>
<p>æœ¬èŠ‚æ•™ç¨‹æ¼”ç¤ºäº†ä½¿ç”¨åŸºäº Substrate çš„åŒºå—é“¾èŠ‚ç‚¹çš„åŸºç¡€çŸ¥è¯†ï¼ŒåŒ…æ‹¬å¦‚ä½•ä½¿èŠ‚ç‚¹åœ¨å¯¹ç­‰ç½‘ç»œä¸­ç›¸äº’é€šä¿¡ï¼Œä»¥åŠå¦‚ä½•æ”¶é›†å…³äºèŠ‚ç‚¹æ“ä½œçš„æŒ‡æ ‡ã€‚é€šå¸¸ï¼Œä½ åº”è¯¥æŒ‰ç…§åˆ—å‡ºçš„é¡ºåºå®Œæˆæ•™ç¨‹ï¼Œå› ä¸ºå®ƒä»¬ä¸ºå°è¯•åé¢çš„æ•™ç¨‹æˆ–æ‰§è¡Œæ›´å¤æ‚çš„ä»»åŠ¡å¥ å®šäº†åŸºç¡€ã€‚åé¢çš„æ•™ç¨‹åŠ å¼ºæˆ–æ‰©å±•äº†åœ¨æœ¬æ•™ç¨‹ä¸­å­¦ä¹ çš„åŸºæœ¬ä¸»é¢˜ã€‚</p>
<h2 id="æ„å»ºæœ¬åœ°åŒºå—é“¾"><a class="header" href="#æ„å»ºæœ¬åœ°åŒºå—é“¾">æ„å»ºæœ¬åœ°åŒºå—é“¾</a></h2>
<h3 id="ç¼–è¯‘substrateèŠ‚ç‚¹"><a class="header" href="#ç¼–è¯‘substrateèŠ‚ç‚¹">ç¼–è¯‘SubstrateèŠ‚ç‚¹</a></h3>
<pre><code class="language-bash editable noplayground">git clone https://github.com/substrate-developer-hub/substrate-node-template

cd substrate-node-template &amp;&amp; git checkout polkadot-v0.9.26

rustup update
rustup update nightly
rustup target add wasm32-unknown-unknown --toolchain nightly

cargo build --release
</code></pre>
<h3 id="å¯åŠ¨èŠ‚ç‚¹"><a class="header" href="#å¯åŠ¨èŠ‚ç‚¹">å¯åŠ¨èŠ‚ç‚¹</a></h3>
<pre><code class="language-bash editable noplayground">./target/release/node-template --dev   
</code></pre>
<p><img src="https://awesomeprogram.gitee.io/imgdata/tech_bc_subnos.jpg" alt="" /></p>
<h3 id="å®‰è£…front-end-template"><a class="header" href="#å®‰è£…front-end-template">å®‰è£…front-end template</a></h3>
<pre><code class="language-bash editable noplayground">node --version
yarn --version
npm install -g yarn
git clone https://github.com/substrate-developer-hub/substrate-front-end-template
cd substrate-front-end-template
yarn install
</code></pre>
<h3 id="å¯åŠ¨front-end-template"><a class="header" href="#å¯åŠ¨front-end-template">å¯åŠ¨front-end template</a></h3>
<pre><code class="language-bash editable noplayground">yarn start
</code></pre>
<p>è®¿é—® http://localhost:8000/</p>
<p><img src="https://awesomeprogram.gitee.io/imgdata/tech_bc_subfronts.jpg" alt="" /></p>
<h3 id="åœæ­¢æœ¬åœ°èŠ‚ç‚¹"><a class="header" href="#åœæ­¢æœ¬åœ°èŠ‚ç‚¹">åœæ­¢æœ¬åœ°èŠ‚ç‚¹</a></h3>
<ol>
<li>è¿”å›æ˜¾ç¤ºèŠ‚ç‚¹è¾“å‡ºçš„ç»ˆç«¯ã€‚</li>
<li>æŒ‰ Control-c ç»ˆæ­¢æ­£åœ¨è¿è¡Œçš„è¿›ç¨‹ã€‚</li>
<li>éªŒè¯ç»ˆç«¯æ˜¯å¦è¿”å›åˆ° substrate-node-template ç›®å½•ä¸­çš„ç»ˆç«¯æç¤ºã€‚</li>
</ol>
<h2 id="æ¨¡æ‹ŸåŒºå—é“¾ç§æœ‰ç½‘ç»œ"><a class="header" href="#æ¨¡æ‹ŸåŒºå—é“¾ç§æœ‰ç½‘ç»œ">æ¨¡æ‹ŸåŒºå—é“¾ç§æœ‰ç½‘ç»œ</a></h2>
<p>åœ¨æœ¬èŠ‚æ•™ç¨‹ä¸­ï¼Œä½ å°†çœ‹åˆ°æƒå¨å…±è¯†æ¨¡å‹åœ¨å®è·µä¸­æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Œå®ƒä½¿ç”¨ä¸¤ä¸ªé¢„å®šä¹‰çš„æƒå¨å¸æˆ·ä½¿èŠ‚ç‚¹èƒ½å¤Ÿç”Ÿæˆå—ã€‚åœ¨è¿™ä¸ªæ¨¡æ‹Ÿç½‘ç»œä¸­ï¼Œä¸¤ä¸ªèŠ‚ç‚¹ä½¿ç”¨ä¸åŒçš„å¸æˆ·å’Œå¯†é’¥å¯åŠ¨ï¼Œä½†åœ¨ä¸€å°è®¡ç®—æœºä¸Šè¿è¡Œã€‚</p>
<h3 id="å¯åŠ¨ç¬¬ä¸€ä¸ªåŒºå—é“¾èŠ‚ç‚¹"><a class="header" href="#å¯åŠ¨ç¬¬ä¸€ä¸ªåŒºå—é“¾èŠ‚ç‚¹">å¯åŠ¨ç¬¬ä¸€ä¸ªåŒºå—é“¾èŠ‚ç‚¹</a></h3>
<p>æœ¬æ•™ç¨‹é€šè¿‡ä½¿ç”¨åä¸º alice å’Œ bob çš„é¢„å®šä¹‰å¸æˆ·åœ¨å•ä¸ªæœ¬åœ°è®¡ç®—æœºä¸Šè¿è¡Œä¸¤ä¸ª Substrate èŠ‚ç‚¹æ¥æ¨¡æ‹Ÿç§æœ‰ç½‘ç»œã€‚</p>
<h4 id="æ¸…é™¤ä¹‹å‰æ—§é“¾çš„æ•°æ®"><a class="header" href="#æ¸…é™¤ä¹‹å‰æ—§é“¾çš„æ•°æ®">æ¸…é™¤ä¹‹å‰æ—§é“¾çš„æ•°æ®</a></h4>
<pre><code class="language-bash editable noplayground">./target/release/node-template purge-chain --base-path /tmp/alice --chain local

# Are you sure to remove &quot;/tmp/alice/chains/local_testnet/db&quot;? [y/N]:
y
</code></pre>
<h4 id="ä½¿ç”¨-alice-è´¦æˆ·å¯åŠ¨æœ¬åœ°åŒºå—é“¾èŠ‚ç‚¹"><a class="header" href="#ä½¿ç”¨-alice-è´¦æˆ·å¯åŠ¨æœ¬åœ°åŒºå—é“¾èŠ‚ç‚¹">ä½¿ç”¨ alice è´¦æˆ·å¯åŠ¨æœ¬åœ°åŒºå—é“¾èŠ‚ç‚¹</a></h4>
<pre><code class="language-bash editable noplayground">./target/release/node-template \
--base-path /tmp/alice \
--chain local \
--alice \
--port 30333 \
--ws-port 9945 \
--rpc-port 9933 \
--node-key 0000000000000000000000000000000000000000000000000000000000000001 \
--telemetry-url &quot;wss://telemetry.polkadot.io/submit/ 0&quot; \
--validator
</code></pre>
<h3 id="å›é¡¾å‘½ä»¤è¡Œé€‰é¡¹"><a class="header" href="#å›é¡¾å‘½ä»¤è¡Œé€‰é¡¹">å›é¡¾å‘½ä»¤è¡Œé€‰é¡¹</a></h3>
<div class="table-wrapper"><table><thead><tr><th style="text-align: left">é€‰é¡¹</th><th style="text-align: left">æè¿°</th></tr></thead><tbody>
<tr><td style="text-align: left"><code>--base-path</code></td><td style="text-align: left">æŒ‡å®šç”¨äºå­˜å‚¨ä¸æ­¤é“¾ç›¸å…³çš„æ‰€æœ‰æ•°æ®çš„ç›®å½•ã€‚</td></tr>
<tr><td style="text-align: left"><code>--chain local</code></td><td style="text-align: left">æŒ‡å®šè¦ä½¿ç”¨çš„ chain specificationï¼Œæœ‰æ•ˆçš„é¢„å®šä¹‰ chain specifications åŒ…æ‹¬ <code>local</code>ã€<code>development</code> å’Œ <code>staging</code>ã€‚</td></tr>
<tr><td style="text-align: left"><code>--alice</code></td><td style="text-align: left">å°† <code>alice</code> å¸æˆ·çš„é¢„å®šä¹‰å¯†é’¥æ·»åŠ åˆ°èŠ‚ç‚¹çš„å¯†é’¥åº“ä¸­ã€‚é€šè¿‡æ­¤è®¾ç½®ï¼Œalice å¸æˆ·ç”¨äºåŒºå—ç”Ÿæˆå’Œæœ€ç»ˆç¡®è®¤ã€‚</td></tr>
<tr><td style="text-align: left"><code>--port 30333</code></td><td style="text-align: left">æŒ‡å®šè¦ç›‘å¬ peer-to-peerï¼ˆ<code>p2p</code>ï¼‰é€šä¿¡çš„ç«¯å£ã€‚ç”±äºæœ¬æ•™ç¨‹ä½¿ç”¨åœ¨åŒä¸€ç‰©ç†è®¡ç®—æœºä¸Šè¿è¡Œçš„ä¸¤ä¸ªèŠ‚ç‚¹æ¥æ¨¡æ‹Ÿç½‘ç»œï¼Œæ‰€ä»¥ä½ å¿…é¡»ä¸ºè‡³å°‘ä¸€ä¸ªå¸æˆ·æ˜¾å¼æŒ‡å®šä¸åŒçš„ç«¯å£ã€‚</td></tr>
<tr><td style="text-align: left"><code>--ws-port 9945</code></td><td style="text-align: left">æŒ‡å®šè¦ç›‘å¬ä¼ å…¥ WebSocket æµé‡çš„ç«¯å£ï¼Œé»˜è®¤ç«¯å£ä¸º <code>9944</code>ï¼Œæœ¬æ•™ç¨‹ä½¿ç”¨è‡ªå®šä¹‰ web socket ç«¯å£å·ï¼ˆ9945ï¼‰ã€‚</td></tr>
<tr><td style="text-align: left"><code>--rpc-port 9933</code></td><td style="text-align: left">æŒ‡å®šè¦ç›‘å¬ä¼ å…¥ RPC é€šä¿¡çš„ç«¯å£ï¼Œé»˜è®¤ç«¯å£æ˜¯ <code>9933</code>ã€‚</td></tr>
<tr><td style="text-align: left"><code>--node-key &lt;key&gt;</code></td><td style="text-align: left">æŒ‡å®šç”¨äº <code>libp2p</code> ç½‘ç»œçš„ Ed25519 å¯†é’¥ï¼Œä½ åº”è¯¥åœ¨å¼€å‘å’Œæµ‹è¯•æ—¶ä½¿ç”¨æ­¤é€‰é¡¹ã€‚</td></tr>
<tr><td style="text-align: left"><code>--telemetry-url</code></td><td style="text-align: left">æŒ‡å®šå‘é€é¥æµ‹æ•°æ®çš„ä½ç½®ã€‚å¯¹äºæœ¬æ•™ç¨‹ï¼Œä½ å¯ä»¥å°†é¥æµ‹æ•°æ®å‘é€åˆ°ç”± Parity æ‰˜ç®¡çš„æœåŠ¡å™¨ï¼Œè¯¥æœåŠ¡å™¨å¯ä¾›ä»»ä½•äººä½¿ç”¨ã€‚</td></tr>
<tr><td style="text-align: left"><code>--validator</code></td><td style="text-align: left">æŒ‡å®šæ­¤èŠ‚ç‚¹å‚ä¸ç½‘ç»œçš„åŒºå—ç”Ÿæˆå’Œæœ€ç»ˆç¡®è®¤ã€‚</td></tr>
</tbody></table>
</div>
<p>æœ‰å…³ node template å¯ç”¨çš„å‘½ä»¤è¡Œé€‰é¡¹çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹ç”¨æ³•å¸®åŠ©ï¼š
<code>./target/release/node-template --help</code></p>
<h3 id="æŸ¥çœ‹æ˜¾ç¤ºçš„èŠ‚ç‚¹æ¶ˆæ¯"><a class="header" href="#æŸ¥çœ‹æ˜¾ç¤ºçš„èŠ‚ç‚¹æ¶ˆæ¯">æŸ¥çœ‹æ˜¾ç¤ºçš„èŠ‚ç‚¹æ¶ˆæ¯</a></h3>
<p>å¦‚æœèŠ‚ç‚¹æˆåŠŸå¯åŠ¨ï¼Œç»ˆç«¯å°†æ˜¾ç¤ºæè¿°ç½‘ç»œæ“ä½œçš„æ¶ˆæ¯ã€‚ä¾‹å¦‚ï¼Œä½ åº”è¯¥çœ‹åˆ°ç±»ä¼¼çš„è¾“å‡ºï¼š</p>
<pre><code class="language-bash editable noplayground">2022-08-16 15:29:55 Substrate Node    
2022-08-16 15:29:55 âœŒï¸  version 4.0.0-dev-de262935ede    
2022-08-16 15:29:55 â¤ï¸  by Substrate DevHub &lt;https://github.com/substrate-developer-hub&gt;, 2017-2022    
2022-08-16 15:29:55 ğŸ“‹ Chain specification: Local Testnet    
2022-08-16 15:29:55 ğŸ·  Node name: Alice    
2022-08-16 15:29:55 ğŸ‘¤ Role: AUTHORITY    
2022-08-16 15:29:55 ğŸ’¾ Database: RocksDb at /tmp/alice/chains/local_testnet/db/full    
2022-08-16 15:29:55 â›“  Native runtime: node-template-100 (node-template-1.tx1.au1)    
2022-08-16 15:29:55 ğŸ”¨ Initializing Genesis block/state (state: 0x6894â€¦033d, header-hash: 0x2cdcâ€¦a07f)    
2022-08-16 15:29:55 ğŸ‘´ Loading GRANDPA authority set from genesis on what appears to be first startup.    
2022-08-16 15:29:56 Using default protocol ID &quot;sup&quot; because none is configured in the chain specs    
2022-08-16 15:29:56 ğŸ·  Local node identity is: 12D3KooWEyoppNCUx8Yx66oV9fJnriXwCcXwDDUA2kj6vnc6iDEp    
2022-08-16 15:29:56 ğŸ’» Operating system: macos    
2022-08-16 15:29:56 ğŸ’» CPU architecture: x86_64    
2022-08-16 15:29:56 ğŸ“¦ Highest known block at #0    
2022-08-16 15:29:56 ã€½ï¸ Prometheus exporter started at 127.0.0.1:9615    
2022-08-16 15:29:56 Running JSON-RPC HTTP server: addr=127.0.0.1:9933, allowed origins=Some([&quot;http://localhost:*&quot;, &quot;http://127.0.0.1:*&quot;, &quot;https://localhost:*&quot;, &quot;https://127.0.0.1:*&quot;, &quot;https://polkadot.js.org&quot;])    
2022-08-16 15:29:56 Running JSON-RPC WS server: addr=127.0.0.1:9945, allowed origins=Some([&quot;http://localhost:*&quot;, &quot;http://127.0.0.1:*&quot;, &quot;https://localhost:*&quot;, &quot;https://127.0.0.1:*&quot;, &quot;https://polkadot.js.org&quot;])    
2022-08-16 15:29:56 creating instance on iface 192.168.1.125    
2022-08-16 15:30:01 ğŸ’¤ Idle (0 peers), best: #0 (0x2cdcâ€¦a07f), finalized #0 (0x2cdcâ€¦a07f), â¬‡ 0 â¬† 0
...
</code></pre>
<p><img src="https://awesomeprogram.gitee.io/imgdata/tech_bc_subpeersingle.jpg" alt="" /></p>
<p>ç‰¹åˆ«æ˜¯ï¼Œä½ åº”è¯¥æ³¨æ„è¾“å‡ºä¸­çš„ä»¥ä¸‹æ¶ˆæ¯ï¼š</p>
<ul>
<li><code>ğŸ”¨ Initializing Genesis block/state (state: 0xea47â€¦9ba8, header-hash: 0x9d07â€¦7cce)</code> æ ‡è¯†èŠ‚ç‚¹æ­£åœ¨å¼€å§‹åˆå§‹åŒ–æˆ–ç”Ÿæˆåˆ›ä¸–å—ï¼Œå½“ä½ å¯åŠ¨ä¸‹ä¸€ä¸ªèŠ‚ç‚¹æ—¶ï¼Œè¯·éªŒè¯è¿™äº›å€¼æ˜¯å¦ç›¸åŒã€‚</li>
<li><code>ğŸ· Local node identity is: 12D3KooWEyoppNCUx8Yx66oV9fJnriXwCcXwDDUA2kj6vnc6iDEp</code> æŒ‡å®šå”¯ä¸€æ ‡è¯†æ­¤èŠ‚ç‚¹çš„å­—ç¬¦ä¸²ã€‚è¯¥å­—ç¬¦ä¸²ç”± <code>--node-key</code> ç¡®å®šï¼Œè¯¥é”®ä½¿ç”¨ <code>alice</code> å¸æˆ·å¯åŠ¨èŠ‚ç‚¹ã€‚ä½ ä½¿ç”¨æ­¤å­—ç¬¦ä¸²æ¥è¯†åˆ«å¯åŠ¨ç¬¬äºŒä¸ªèŠ‚ç‚¹è¿æ¥åˆ°è¯¥èŠ‚ç‚¹çš„ç½‘ç»œã€‚</li>
<li><code>2021-03-10 17:34:37 ğŸ’¤ Idle (0 peers), best: #0 (0x9d07â€¦7cce), finalized #0 (0x9d07â€¦7cce), â¬‡ 0 â¬† 0</code> è¡¨æ˜ç½‘ç»œä¸­æ²¡æœ‰å…¶ä»–èŠ‚ç‚¹ï¼Œä¹Ÿæ²¡æœ‰ç”ŸæˆåŒºå—ã€‚åœ¨å¼€å§‹ç”Ÿæˆå—ä¹‹å‰ï¼Œå¦ä¸€ä¸ªèŠ‚ç‚¹å¿…é¡»åŠ å…¥ç½‘ç»œã€‚</li>
</ul>
<h3 id="æ·»åŠ ç¬¬äºŒä¸ªèŠ‚ç‚¹åˆ°åŒºå—é“¾ç½‘ç»œ"><a class="header" href="#æ·»åŠ ç¬¬äºŒä¸ªèŠ‚ç‚¹åˆ°åŒºå—é“¾ç½‘ç»œ">æ·»åŠ ç¬¬äºŒä¸ªèŠ‚ç‚¹åˆ°åŒºå—é“¾ç½‘ç»œ</a></h3>
<p>ä½ ä½¿ç”¨ <code>alice</code> å¸æˆ·å¯†é’¥å¯åŠ¨çš„èŠ‚ç‚¹å·²ç»è¿è¡Œï¼Œç°åœ¨ä½ å¯ä»¥ä½¿ç”¨ <code>bob</code> å¸æˆ·å°†å¦ä¸€ä¸ªèŠ‚ç‚¹æ·»åŠ åˆ°è¯¥ç½‘ç»œä¸­ã€‚å› ä¸ºä½ æ­£åœ¨åŠ å…¥ä¸€ä¸ªå·²ç»è¿è¡Œçš„ç½‘ç»œï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨æ­£åœ¨è¿è¡ŒèŠ‚ç‚¹çš„æ ‡è¯†å°†æ–°èŠ‚ç‚¹åŠ å…¥çš„ç½‘ç»œã€‚è¿™äº›å‘½ä»¤ä¸ä½ ä¹‹å‰ä½¿ç”¨çš„å‘½ä»¤ç±»ä¼¼ï¼Œä½†æœ‰ä¸€äº›é‡è¦åŒºåˆ«ã€‚</p>
<pre><code class="language-bash editable noplayground">./target/release/node-template purge-chain --base-path /tmp/bob --chain local -y
# é€šè¿‡åœ¨å‘½ä»¤ä¸­æ·»åŠ -yï¼Œæ‚¨å¯ä»¥åˆ é™¤é“¾æ•°æ®ï¼Œè€Œæ— éœ€æç¤ºæ‚¨ç¡®è®¤æ“ä½œã€‚

./target/release/node-template \
--base-path /tmp/bob \
--chain local \
--bob \
--port 30334 \
--ws-port 9946 \
--rpc-port 9934 \
--telemetry-url &quot;wss://telemetry.polkadot.io/submit/ 0&quot; \
--validator \
--bootnodes /ip4/127.0.0.1/tcp/30333/p2p/12D3KooWEyoppNCUx8Yx66oV9fJnriXwCcXwDDUA2kj6vnc6iDEp
</code></pre>
<p>æ³¨æ„æ­¤å‘½ä»¤ä¸ä¸Šä¸€ä¸ªå‘½ä»¤ä¹‹é—´çš„ä»¥ä¸‹å·®å¼‚ï¼š</p>
<ul>
<li>å› ä¸ºä¸¤ä¸ªèŠ‚ç‚¹è¿è¡Œåœ¨åŒä¸€å°ç‰©ç†è®¡ç®—æœºä¸Šï¼Œæ‰€ä»¥ä½ å¿…é¡»æŒ‡å®šä¸åŒçš„å€¼ç»™è¿™äº›é€‰é¡¹ï¼Œ<code>--base-path</code>ã€<code>--port</code>ã€<code>--ws-port</code>ã€<code>--rpc-port</code></li>
<li>æ­¤å‘½ä»¤åŒ…å« <code>--bootnodes</code> é€‰é¡¹ï¼Œå¹¶ä¸”æŒ‡å®šä¸€ä¸ªå¼•å¯¼èŠ‚ç‚¹ï¼Œè¯¥èŠ‚ç‚¹ç”± <code>alice</code> å¯åŠ¨ã€‚</li>
</ul>
<p><code>--bootnodes</code> é€‰é¡¹ç”±ä»¥ä¸‹ä¿¡æ¯ç»„æˆï¼š</p>
<ul>
<li><code>ip4</code> è¡¨ç¤ºèŠ‚ç‚¹çš„IPåœ°å€ä½¿ç”¨IPv4æ ¼å¼ã€‚</li>
<li><code>127.0.0.1</code> ä¸ºè¿è¡Œçš„èŠ‚ç‚¹æŒ‡å®š IP åœ°å€ï¼Œåœ¨æœ¬æ¡ˆä¾‹ä¸­ï¼Œè¡¨ç¤º <code>localhost</code> çš„åœ°å€ã€‚</li>
<li><code>tcp</code> è¡¨ç¤ºå°† <code>TCP</code> æŒ‡å®šä¸ºç”¨äº peer-to-peer é€šä¿¡çš„åè®®ã€‚</li>
<li><code>30333</code> è¡¨ç¤ºæŒ‡å®šç”¨äº peer-to-peer é€šä¿¡çš„ç«¯å£å·ï¼Œåœ¨æœ¬æ¡ˆä¾‹ä¸­ï¼Œè¡¨ç¤º TCP æµé‡çš„ç«¯å£å·ã€‚</li>
<li><code>12D3KooWEyoppNCUx8Yx66oV9fJnriXwCcXwDDUA2kj6vnc6iDEp</code> æ ‡è¯†è¦ä¸æ­¤ç½‘è·¯é€šä¿¡çš„è¿è¡ŒèŠ‚ç‚¹ï¼Œåœ¨æœ¬æ¡ˆä¾‹ä¸­ï¼Œè¡¨ç¤ºä¸ºä½¿ç”¨ <code>alice</code> è´¦æˆ·å¯åŠ¨èŠ‚ç‚¹çš„æ ‡è¯†ç¬¦ã€‚</li>
</ul>
<h3 id="éªŒè¯åŒºå—æ˜¯å¦å·²ç”Ÿæˆå’Œå·²æœ€ç»ˆç¡®è®¤"><a class="header" href="#éªŒè¯åŒºå—æ˜¯å¦å·²ç”Ÿæˆå’Œå·²æœ€ç»ˆç¡®è®¤">éªŒè¯åŒºå—æ˜¯å¦å·²ç”Ÿæˆå’Œå·²æœ€ç»ˆç¡®è®¤</a></h3>
<p>å¯åŠ¨ç¬¬äºŒä¸ªèŠ‚ç‚¹åï¼ŒèŠ‚ç‚¹åº”ä½œä¸ºå¯¹ç­‰èŠ‚ç‚¹ç›¸äº’è¿æ¥ï¼Œå¹¶å¼€å§‹ç”Ÿæˆå—ã€‚</p>
<ol>
<li>ç¡®è®¤ä½ åœ¨å¯åŠ¨ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„ç»ˆç«¯ä¸­çœ‹åˆ°ä¸ä»¥ä¸‹ç±»ä¼¼çš„è¡Œï¼š</li>
</ol>
<pre><code class="language-bash editable noplayground">2022-08-16 15:32:33 discovered: 12D3KooWBCbmQovz78Hq7MzPxdx9d1gZzXMsn6HtWj29bW51YUKB /ip4/127.0.0.1/tcp/30334
2022-08-16 15:32:33 discovered: 12D3KooWBCbmQovz78Hq7MzPxdx9d1gZzXMsn6HtWj29bW51YUKB /ip6/::1/tcp/30334
2022-08-16 15:32:36 ğŸ™Œ Starting consensus session on top of parent 0x2cdce15d31548063e89e10bd201faa63c623023bbc320346b9580ed3c40fa07f
2022-08-16 15:32:36 ğŸ Prepared block for proposing at 1 (5 ms) [hash: 0x9ab34110e4617454da33a3616efc394eb1ce95ee4bf0daab69aa4cb392d4104b; parent_hash: 0x2cdcâ€¦a07f; extrinsics (1): [0x4634â€¦cebf]] 
2022-08-16 15:32:36 ğŸ”– Pre-sealed block for proposal at 1. Hash now 0xf0869a5cb8ebd0fcc5f2bc194ced84ca782d9749604e888c8b9b515517179847, previously 0x9ab34110e4617454da33a3616efc394eb1ce95ee4bf0daab69aa4cb392d4104b.
2022-08-16 15:32:36 âœ¨ Imported #1 (0xf086â€¦9847)
2022-08-16 15:32:36 ğŸ’¤ Idle (1 peers), best: #1 (0xf086â€¦9847), finalized #0 (0x2cdcâ€¦a07f), â¬‡ 1.0kiB/s â¬† 1.0kiB/s
2022-08-16 15:32:41 ğŸ’¤ Idle (1 peers), best: #1 (0xf086â€¦9847), finalized #0 (0x2cdcâ€¦a07f), â¬‡ 0.6kiB/s â¬† 0.6kiB/s
2022-08-16 15:32:42 âœ¨ Imported #2 (0x0d5eâ€¦2a7f)
2022-08-16 15:32:46 ğŸ’¤ Idle (1 peers), best: #2 (0x0d5eâ€¦2a7f), finalized #0 (0x2cdcâ€¦a07f), â¬‡ 0.6kiB/s â¬† 0.6kiB/s
2022-08-16 15:32:48 ğŸ™Œ Starting consensus session on top of parent 0x0d5ef31979c2aa17fb88497018206d3057151119337293fe85d9526ebd1e2a7f
2022-08-16 15:32:48 ğŸ Prepared block for proposing at 3 (0 ms) [hash: 0xa307c0112bce39e0dc689132452154da2079a27375b44c4d94790b46a601346a; parent_hash: 0x0d5eâ€¦2a7f; extrinsics (1): [0x63ccâ€¦39a6]]    
2022-08-16 15:32:48 ğŸ”– Pre-sealed block for proposal at 3. Hash now 0x0c55670e745dd12892c9e7d5205085a78ccea98df393a822fa9b3865cfb3d51b, previously 0xa307c0112bce39e0dc689132452154da2079a27375b44c4d94790b46a601346a.
2022-08-16 15:32:48 âœ¨ Imported #3 (0x0c55â€¦d51b)
2022-08-16 15:32:51 ğŸ’¤ Idle (1 peers), best: #3 (0x0c55â€¦d51b), finalized #1 (0xf086â€¦9847), â¬‡ 0.7kiB/s â¬† 0.9kiB/s    
...
</code></pre>
<p><img src="https://awesomeprogram.gitee.io/imgdata/tech_bc_subpeersone.jpg" alt="" /></p>
<p><img src="https://awesomeprogram.gitee.io/imgdata/tech_bc_subpeerstwo.jpg" alt="" /></p>
<p>åœ¨è¿™äº›è¡Œä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°æœ‰å…³ä½ çš„åŒºå—é“¾çš„ä»¥ä¸‹ä¿¡æ¯ï¼š</p>
<ul>
<li>åœ¨è¿™ä¸ªç½‘ç»œä¸­å‘ç°ç¬¬äºŒä¸ªèŠ‚ç‚¹çš„æ ‡è¯†ï¼ˆ<code>12D3KooWBCbmQovz78Hq7MzPxdx9d1gZzXMsn6HtWj29bW51YUKB</code>ï¼‰ã€‚</li>
<li>è¯¥èŠ‚ç‚¹æœ‰ä¸€ä¸ªpeerï¼ˆ<code>1 peers</code>ï¼‰ã€‚</li>
<li>èŠ‚ç‚¹äº§ç”Ÿäº†ä¸€äº›å—ï¼ˆ<code>best: #3 (0x0c55â€¦d51b)</code>ï¼‰ã€‚</li>
<li>è¿™äº›å—è¢«æœ€ç»ˆç¡®è®¤ï¼ˆ<code>finalized #1 (0xf086â€¦9847)</code>ï¼‰ã€‚</li>
</ul>
<ol start="2">
<li>éªŒè¯ä½ åœ¨å¯åŠ¨ç¬¬äºŒä¸ªèŠ‚ç‚¹çš„ç»ˆç«¯ä¸­çœ‹åˆ°ç±»ä¼¼çš„è¾“å‡ºã€‚</li>
<li>åœ¨ç»ˆç«¯ä¸­æŒ‰ä¸‹çš„ Control-cï¼Œå…³é—­å…¶ä¸­ä¸€ä¸ªèŠ‚ç‚¹ã€‚å…³é—­èŠ‚ç‚¹åï¼Œä½ å°†çœ‹åˆ°å‰©ä½™èŠ‚ç‚¹ç°åœ¨æ²¡æœ‰å¯¹ç­‰èŠ‚ç‚¹ï¼Œå¹¶ä¸”å·²åœæ­¢ç”Ÿæˆå—ã€‚ä¾‹å¦‚ï¼š</li>
</ol>
<pre><code class="language-bash editable noplayground">2022-08-16 15:53:45 ğŸ’¤ Idle (1 peers), best: #143 (0x8f11â€¦1684), finalized #141 (0x5fe3â€¦5a25), â¬‡ 0.8kiB/s â¬† 0.7kiB/s
2022-08-16 15:53:50 ğŸ’¤ Idle (0 peers), best: #143 (0x8f11â€¦1684), finalized #141 (0x5fe3â€¦5a25), â¬‡ 83 B/s â¬† 83 B/s
</code></pre>
<p><img src="https://awesomeprogram.gitee.io/imgdata/tech_bc_subpeershut.jpg" alt="" /></p>
<ol start="4">
<li>é€šè¿‡åœ¨ç»ˆç«¯ä¸­æŒ‰ä¸‹ Control-c å…³é—­ç¬¬äºŒä¸ªèŠ‚ç‚¹ã€‚å¦‚æœä½ ä½¿ç”¨ <code>--dev</code> å‘½ä»¤è¡Œé€‰é¡¹åœ¨å¼€å‘æ¨¡å¼ä¸‹å¯åŠ¨èŠ‚ç‚¹çš„ï¼Œåˆ™èŠ‚ç‚¹çš„æ‰€æœ‰çŠ¶æ€éƒ½è¢«æ¸…é™¤ã€‚</li>
</ol>
<h2 id="æ·»åŠ å¯ä¿¡ä»»çš„èŠ‚ç‚¹"><a class="header" href="#æ·»åŠ å¯ä¿¡ä»»çš„èŠ‚ç‚¹">æ·»åŠ å¯ä¿¡ä»»çš„èŠ‚ç‚¹</a></h2>
<p>åœ¨æœ¬èŠ‚æ•™ç¨‹ä¸­ï¼Œä½ å°†ä¸ºç½‘ç»œä¸­çš„éªŒè¯å™¨èŠ‚ç‚¹ç”Ÿæˆè‡ªå·±çš„å¯†é’¥ã€‚é‡è¦çš„æ˜¯è¦è®°ä½ï¼ŒåŒºå—é“¾ç½‘ç»œä¸­çš„æ¯ä¸ªå‚ä¸è€…éƒ½è´Ÿè´£ç”Ÿæˆå”¯ä¸€å¯†é’¥ã€‚æœ‰å‡ ç§æ–¹æ³•å¯ä»¥ç”Ÿæˆå¯†é’¥ï¼Œä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ <code>node-template</code> å­å‘½ä»¤ã€ç‹¬ç«‹çš„ <strong>subkey</strong> å‘½ä»¤è¡Œç¨‹åºã€Polkadot-JS åº”ç”¨ç¨‹åºæˆ–è€…ç¬¬ä¸‰æ–¹å¯†é’¥ç”Ÿæˆç¨‹åºæ¥ç”Ÿæˆå¯†é’¥å¯¹ã€‚</p>
<p>è™½ç„¶ä½ å¯ä»¥ä½¿ç”¨é¢„å®šä¹‰çš„å¯†é’¥å¯¹æ¥å®Œæˆæœ¬æ•™ç¨‹ï¼Œä½†ä½ åº”è¯¥æ°¸è¿œä¸ä¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨è¿™äº› keyã€‚æœ¬æ•™ç¨‹ä¸ä½¿ç”¨é¢„å®šä¹‰çš„å¯†é’¥æˆ–æ›´å®‰å…¨çš„ <code>subkey</code> ç¨‹åºï¼Œè€Œæ˜¯æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨ Substrate node template å’Œ <code>key</code> å­å‘½ä»¤ç”Ÿæˆå¯†é’¥ã€‚</p>
<h3 id="ä½¿ç”¨-node-template-ç”Ÿæˆæœ¬åœ°å¯†é’¥"><a class="header" href="#ä½¿ç”¨-node-template-ç”Ÿæˆæœ¬åœ°å¯†é’¥">ä½¿ç”¨ node template ç”Ÿæˆæœ¬åœ°å¯†é’¥</a></h3>
<pre><code class="language-bash editable noplayground">./target/release/node-template key generate --scheme Sr25519 --password-interactive

</code></pre>
<p>è¯¥å‘½ä»¤ç”Ÿæˆå¯†é’¥å¹¶æ˜¾ç¤ºç±»ä¼¼å¦‚ä¸‹çš„è¾“å‡ºï¼š</p>
<pre><code class="language-bash editable noplayground">Secret phrase:  pig giraffe ceiling enter weird liar orange decline behind total despair fly
Secret seed:       0x0087016ebbdcf03d1b7b2ad9a958e14a43f2351cd42f2f0a973771b90fb0112f
Public key (hex):  0x1a4cc824f6585859851f818e71ac63cf6fdc81018189809814677b2a4699cf45
Account ID:        0x1a4cc824f6585859851f818e71ac63cf6fdc81018189809814677b2a4699cf45
Public key (SS58): 5CfBuoHDvZ4fd8jkLQicNL8tgjnK8pVG9AiuJrsNrRAx6CNW
SS58 Address:      5CfBuoHDvZ4fd8jkLQicNL8tgjnK8pVG9AiuJrsNrRAx6CNW
</code></pre>
<p>ç°åœ¨ä½ æœ‰äº† Sr25519 keyï¼Œå¯¹äºä¸€ä¸ªèŠ‚ç‚¹ä½¿ç”¨ <code>aura</code> ç”Ÿæˆå—ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œå¸æˆ·çš„ Sr25519 å…¬é’¥ä¸º <code>5CfBuoHDvZ4fd8jkLQicNL8tgjnK8pVG9AiuJrsNrRAx6CNW</code>ã€‚</p>
<p>ä½¿ç”¨åˆšåˆšç”Ÿæˆçš„å¸æˆ·çš„ <strong>secret phrase</strong>ï¼Œä½¿ç”¨ Ed25519 ç­¾åæ–¹æ¡ˆæ´¾ç”Ÿå¯†é’¥ã€‚</p>
<pre><code class="language-bash editable noplayground">./target/release/node-template key inspect --password-interactive --scheme Ed25519 &quot;pig giraffe ceiling enter weird liar orange decline behind total despair fly&quot;
</code></pre>
<p>è¯¥å‘½ä»¤æ˜¾ç¤ºç±»ä¼¼äºä»¥ä¸‹å†…å®¹çš„è¾“å‡ºï¼š</p>
<pre><code class="language-bash editable noplayground">Secret phrase `pig giraffe ceiling enter weird liar orange decline behind total despair fly` is account:
Secret seed:       0x0087016ebbdcf03d1b7b2ad9a958e14a43f2351cd42f2f0a973771b90fb0112f
Public key (hex):  0x2577ba03f47cdbea161851d737e41200e471cd7a31a5c88242a527837efc1e7b
Public key (SS58): 5CuqCGfwqhjGzSqz5mnq36tMe651mU9Ji8xQ4JRuUTvPcjVN
Account ID:        0x2577ba03f47cdbea161851d737e41200e471cd7a31a5c88242a527837efc1e7b
SS58 Address:      5CuqCGfwqhjGzSqz5mnq36tMe651mU9Ji8xQ4JRuUTvPcjVN
</code></pre>
<p>ç°åœ¨ä½ æœ‰äº† Ed25519 keyï¼Œå¯¹äºä¸€ä¸ªèŠ‚ç‚¹ä½¿ç”¨ <code>grandpa</code> æœ€ç»ˆç¡®è®¤å—ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œå¸æˆ·çš„ Ed25519 å…¬é’¥ä¸º <code>5CuqCGfwqhjGzSqz5mnq36tMe651mU9Ji8xQ4JRuUTvPcjVN</code>ã€‚</p>
<h3 id="ç”Ÿæˆç¬¬äºŒç»„å¯†é’¥"><a class="header" href="#ç”Ÿæˆç¬¬äºŒç»„å¯†é’¥">ç”Ÿæˆç¬¬äºŒç»„å¯†é’¥</a></h3>
<p>å¯¹äºæœ¬æ•™ç¨‹ï¼Œä¸“ç”¨ç½‘ç»œä»…åŒ…å«ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œå› æ­¤ä½ éœ€è¦ä¸¤ç»„ keyã€‚
ä¸ºäº†ä¾¿äºè¯´æ˜ï¼Œæœ¬æ•™ç¨‹ä¸­ä½¿ç”¨çš„ç¬¬äºŒç»„å…³é”®ç‚¹æ˜¯ï¼š</p>
<ul>
<li>Sr25519: 5EJPj83tJuJtTVE2v7B9ehfM7jNT44CBFaPWicvBwYyUKBS6 ï¼ˆ<code>aura</code>ï¼‰</li>
<li>Ed25519: 5FeJQsfmbbJLTH1pvehBxrZrT5kHvJFj84ZaY5LK7NU87gZS ï¼ˆ<code>grandpa</code>ï¼‰</li>
</ul>
<h3 id="åˆ›å»ºè‡ªå®šä¹‰-chain-specification"><a class="header" href="#åˆ›å»ºè‡ªå®šä¹‰-chain-specification">åˆ›å»ºè‡ªå®šä¹‰ chain specification</a></h3>
<p>ä¸ºäº†ç®€å•èµ·è§ï¼Œä½ åœ¨æœ¬èŠ‚æ•™ç¨‹ä¸­åˆ›å»ºçš„è‡ªå®šä¹‰ chain specification æ˜¯æœ¬åœ° chain specification çš„ä¿®æ”¹ç‰ˆæœ¬ï¼Œè¯´æ˜äº†å¦‚ä½•åˆ›å»ºåŒèŠ‚ç‚¹ç½‘ç»œã€‚å¦‚æœä½ æœ‰æ‰€éœ€çš„å¯†é’¥ï¼Œå¯ä»¥æŒ‰ç…§ç›¸åŒçš„æ­¥éª¤å‘ç½‘ç»œæ·»åŠ æ›´å¤šèŠ‚ç‚¹ã€‚</p>
<h4 id="ä¿®æ”¹æœ¬åœ°-chain-specification"><a class="header" href="#ä¿®æ”¹æœ¬åœ°-chain-specification">ä¿®æ”¹æœ¬åœ° chain specification</a></h4>
<p>ä½ å¯ä»¥ä¿®æ”¹é¢„å®šä¹‰çš„æœ¬åœ° chain specificationï¼Œè€Œä¸æ˜¯ç¼–å†™å…¨æ–°çš„ chain specificationã€‚</p>
<p>åœ¨æœ¬åœ° chain specification çš„åŸºç¡€ä¸Šåˆ›å»ºä¸€ä¸ªæ–°çš„ chain specificationï¼š</p>
<pre><code class="language-bash editable noplayground">./target/release/node-template build-spec --disable-default-bootnode --chain local &gt; customSpec.json
</code></pre>
<p>å¦‚æœä½ åœ¨æ–‡æœ¬ç¼–è¾‘å™¨ä¸­æ‰“å¼€ <code>customSpec.json</code> æ–‡ä»¶ï¼Œåˆ™ä¼šçœ‹åˆ°å®ƒåŒ…å«å¤šä¸ªå­—æ®µã€‚å…¶ä¸­ä¸€ä¸ªå­—æ®µæ˜¯ä½¿ç”¨ <code>cargo build --release</code> å‘½ä»¤æ„å»ºçš„è¿è¡Œæ—¶çš„ WebAssemblyï¼ˆWasmï¼‰äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ç”±äº WebAssemblyï¼ˆWASMï¼‰äºŒè¿›åˆ¶æ˜¯ä¸€ä¸ªäºŒè¿›åˆ¶å¤§å‹å¯¹è±¡ï¼ˆblobï¼‰ï¼Œå› æ­¤ä½ å¯ä»¥é¢„è§ˆç¬¬ä¸€è¡Œå’Œæœ€åå‡ è¡Œï¼Œä»¥æŸ¥çœ‹éœ€è¦æ›´æ”¹çš„å­—æ®µã€‚é¢„è§ˆ <code>customSpec.json</code> ä¸­çš„å‰å‡ ä¸ªå­—æ®µï¼Œé€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
<code>head customSpec.json</code></p>
<p>è¯¥å‘½ä»¤æ˜¾ç¤ºæ–‡ä»¶ä¸­çš„å‰å‡ ä¸ªå­—æ®µã€‚ä¾‹å¦‚ï¼š</p>
<pre><code class="language-bash editable noplayground">{
 &quot;name&quot;: &quot;Local Testnet&quot;,
 &quot;id&quot;: &quot;local_testnet&quot;,
 &quot;chainType&quot;: &quot;Local&quot;,
 &quot;bootNodes&quot;: [],
 &quot;telemetryEndpoints&quot;: null,
 &quot;protocolId&quot;: null,
 &quot;properties&quot;: null,
 &quot;consensusEngine&quot;: null,
 &quot;codeSubstitutes&quot;: {},
</code></pre>
<p>é¢„è§ˆ <code>customSpec.json</code> ä¸­çš„æœ€åå‡ ä¸ªå­—æ®µï¼Œé€šè¿‡è¿è¡Œä¸‹é¢çš„å‘½ä»¤
<code>tail -n 80 customSpec.json</code></p>
<p>æ­¤å‘½ä»¤æ˜¾ç¤º Wasm äºŒè¿›åˆ¶å­—æ®µåé¢çš„æœ€åéƒ¨åˆ†ï¼ŒåŒ…æ‹¬è¿è¡Œæ—¶ä½¿ç”¨çš„å‡ ä¸ª palletsï¼ˆå¦‚ <code>sudo</code> å’Œ <code>balances</code>ï¼‰çš„è¯¦ç»†ä¿¡æ¯ã€‚</p>
<p>åœ¨æ–‡æœ¬ç¼–è¾‘å™¨ä¸­æ‰“å¼€ <code>customSpec.json</code> æ–‡ä»¶ï¼Œä¿®æ”¹ <code>name</code> å­—æ®µä»¥å°†æ­¤  chain specification æ ‡è¯†ä¸ºè‡ªå®šä¹‰  chain specificationã€‚
<code>&quot;name&quot;: &quot;My Custom Testnet&quot;,</code></p>
<p>ä¿®æ”¹ <code>aura</code> å­—æ®µï¼Œé€šè¿‡ä¸ºæ¯ä¸ªç½‘ç»œå‚ä¸è€…æ·»åŠ  Sr25519 SS58 åœ°å€ keysï¼ŒæŒ‡å®šæœ‰æƒåˆ›å»ºå—çš„èŠ‚ç‚¹ã€‚</p>
<pre><code class="language-bash editable noplayground">&quot;aura&quot;: { &quot;authorities&quot;: [
 &quot;5CfBuoHDvZ4fd8jkLQicNL8tgjnK8pVG9AiuJrsNrRAx6CNW&quot;, &quot;5CXGP4oPXC1Je3zf5wEDkYeAqGcGXyKWSRX2Jm14GdME5Xc5&quot;
 ]
},
</code></pre>
<p>ä¿®æ”¹ <code>grandpa</code> å­—æ®µï¼Œä»¥æŒ‡å®šèŠ‚ç‚¹ï¼Œå¹¶é€šè¿‡ä¸ºæ¯ä¸ªç½‘ç»œå‚ä¸è€…æ·»åŠ  Ed25519 SS58 åœ°å€ keys æ¥æœ€ç»ˆç¡®å®šå—ã€‚</p>
<pre><code class="language-bash editable noplayground">&quot;grandpa&quot;: {
   &quot;authorities&quot;: [
     [
       &quot;5CuqCGfwqhjGzSqz5mnq36tMe651mU9Ji8xQ4JRuUTvPcjVN&quot;,
       1
     ],
     [
       &quot;5DpdMN4bVTMy67TfMMtinQTcUmLhZBWoWarHvEYPM4jYziqm&quot;,
       1
     ]
   ]
 },
</code></pre>
<p>è¯·æ³¨æ„ï¼Œåœ¨ <code>grandpa</code> éƒ¨åˆ†ä¸­æœ‰ä¸¤ä¸ª <code>authorities</code> å­—æ®µçš„æ•°æ®å€¼ã€‚ç¬¬ä¸€ä¸ªå€¼æ˜¯åœ°å€é”®ã€‚ç¬¬äºŒä¸ªå€¼ç”¨äºæ”¯æŒ <strong>weighted votes</strong>ã€‚åœ¨æœ¬ä¾‹ä¸­ï¼Œæ¯ä¸ªéªŒè¯è€…çš„æƒé‡ä¸º 1 ç¥¨ã€‚</p>
<h4 id="æ·»åŠ éªŒè¯è€…"><a class="header" href="#æ·»åŠ éªŒè¯è€…">æ·»åŠ éªŒè¯è€…</a></h4>
<p>å¦‚åˆšæ‰çœ‹åˆ°çš„ï¼Œä½ å¯ä»¥é€šè¿‡ä¿®æ”¹ <code>aura</code> å’Œ <code>grandpa</code> éƒ¨åˆ†åœ¨ chain specification ä¸­æ·»åŠ å’Œæ›´æ”¹æˆæƒåœ°å€ã€‚ä½ å¯ä»¥ä½¿ç”¨æ­¤æŠ€æœ¯æ·»åŠ ä»»æ„æ•°é‡çš„éªŒè¯è€…ã€‚
æ·»åŠ éªŒè¯ï¼š</p>
<ul>
<li>ä¿®æ”¹ <code>aura</code> éƒ¨åˆ†ï¼Œä½¿å…¶åŒ…å« <strong>Sr25519</strong> åœ°å€ã€‚</li>
<li>ä¿®æ”¹ <code>grandpa</code> éƒ¨åˆ†ï¼Œä½¿å…¶åŒ…å« <strong>Ed25519</strong> åœ°å€å’Œä¸€ä¸ªæŠ•ç¥¨æƒé‡ã€‚</li>
</ul>
<p>ç¡®ä¿ä¸ºæ¯ä¸ªéªŒè¯è€…ä½¿ç”¨å”¯ä¸€çš„é”®ï¼Œå¦‚æœä¸¤ä¸ªéªŒè¯å™¨æœ‰ç›¸åŒçš„é”®ï¼Œå®ƒä»¬å°±ä¼šäº§ç”Ÿå†²çªçš„å—ã€‚</p>
<h3 id="è½¬æ¢-chain-specification-ä¸ºåŸå§‹æ ¼å¼"><a class="header" href="#è½¬æ¢-chain-specification-ä¸ºåŸå§‹æ ¼å¼">è½¬æ¢ chain specification ä¸ºåŸå§‹æ ¼å¼</a></h3>
<p>åœ¨ä½¿ç”¨éªŒè¯è€…ä¿¡æ¯å‡†å¤‡ chain specification ä¹‹åï¼Œå¿…é¡»å°†å…¶è½¬æ¢ä¸º raw specification æ ¼å¼ï¼Œç„¶åæ‰èƒ½ä½¿ç”¨ã€‚raw chain specification åŒ…å«ä¸æœªè½¬æ¢ specification ç›¸åŒçš„ä¿¡æ¯ã€‚ç„¶è€Œï¼Œraw chain specification è¿˜åŒ…å«ç¼–ç çš„å­˜å‚¨å¯†é’¥ï¼ŒèŠ‚ç‚¹ä½¿ç”¨è¿™äº›å¯†é’¥æ¥å¼•ç”¨å…¶æœ¬åœ°å­˜å‚¨ä¸­çš„æ•°æ®ã€‚åˆ†é… raw chain specification å¯ç¡®ä¿æ¯ä¸ªèŠ‚ç‚¹ä½¿ç”¨é€‚å½“çš„å­˜å‚¨å¯†é’¥å­˜å‚¨æ•°æ®ã€‚
å°† chain specification è½¬æ¢ä¸ºä½¿ç”¨åŸå§‹æ ¼å¼ï¼š</p>
<pre><code class="language-bash editable noplayground">./target/release/node-template build-spec --chain=customSpec.json --raw --disable-default-bootnode &gt; customSpecRaw.json
</code></pre>
<h3 id="ä¸å…¶ä»–äººå…±äº«-chain-specification"><a class="header" href="#ä¸å…¶ä»–äººå…±äº«-chain-specification">ä¸å…¶ä»–äººå…±äº« chain specification</a></h3>
<p>å¦‚æœä½ æ­£åœ¨åˆ›å»ºç§äººåŒºå—é“¾ç½‘ç»œä»¥ä¸å…¶ä»–å‚ä¸è€…å…±äº«ï¼Œè¯·ç¡®ä¿åªæœ‰ä¸€ä¸ªäººåˆ›å»º chain specification å¹¶å…±äº«è¯¥ specification çš„æœ€ç»ˆåŸå§‹ç‰ˆæœ¬ï¼Œä¾‹å¦‚ <code>customSpecRaw.json</code> æ–‡ä»¶å’Œç½‘ç»œä¸­çš„æ‰€æœ‰å…¶ä»–éªŒè¯å™¨ã€‚</p>
<p>ç”±äº Rust ç¼–è¯‘å™¨ç”Ÿæˆçš„ä¼˜åŒ–çš„ WebAssembly äºŒè¿›åˆ¶æ–‡ä»¶åœ¨ç¡®å®šæ€§ä¸Šä¸å¯å¤åˆ¶ï¼Œå› æ­¤ç”Ÿæˆ Wasm è¿è¡Œæ—¶çš„äººéƒ½ä¼šç”Ÿæˆä¸€ä¸ªç•¥å¾®ä¸åŒçš„ Wasm blobã€‚ä¸ºäº†ç¡®ä¿ç¡®å®šæ€§ï¼ŒåŒºå—é“¾ç½‘ç»œä¸­çš„æ‰€æœ‰å‚ä¸è€…å¿…é¡»ä½¿ç”¨å®Œå…¨ç›¸åŒçš„ raw chain specification æ–‡ä»¶ã€‚</p>
<h3 id="å‡†å¤‡å¯åŠ¨ç§æœ‰ç½‘ç»œ"><a class="header" href="#å‡†å¤‡å¯åŠ¨ç§æœ‰ç½‘ç»œ">å‡†å¤‡å¯åŠ¨ç§æœ‰ç½‘ç»œ</a></h3>
<p>è¦ç»§ç»­ï¼Œè¯·éªŒè¯ä»¥ä¸‹å†…å®¹ï¼š</p>
<ul>
<li>ä½ å·²ä¸ºè‡³å°‘ä¸¤ä¸ªæˆæƒå¸æˆ·ç”Ÿæˆæˆ–æ”¶é›†äº†å¸æˆ·å¯†é’¥ã€‚</li>
<li>ä½ å·²ç»æ›´æ–°äº†è‡ªå®šä¹‰ chain specificationï¼Œä»¥åŒ…æ‹¬å—ç”Ÿæˆçš„ keyï¼ˆ<code>aura</code>ï¼‰å’Œå—æœ€ç»ˆç¡®è®¤çš„ keyï¼ˆ<code>grandpa</code>ï¼‰ã€‚</li>
<li>ä½ å·²ç»å°†è‡ªå®šä¹‰ chain specification è½¬æ¢ä¸ºåŸå§‹æ ¼å¼ï¼Œå¹¶å°†åŸå§‹ chain specification åˆ†å‘ç»™å‚ä¸ç§æœ‰ç½‘ç»œçš„èŠ‚ç‚¹ã€‚</li>
</ul>
<p>å¦‚æœä½ å®Œæˆäº†è¿™äº›æ­¥éª¤ï¼Œå°±å¯ä»¥å¯åŠ¨ç§æœ‰åŒºå—é“¾ä¸­çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹äº†ã€‚</p>
<h3 id="å¼€å§‹ç¬¬ä¸€ä¸ªèŠ‚ç‚¹"><a class="header" href="#å¼€å§‹ç¬¬ä¸€ä¸ªèŠ‚ç‚¹">å¼€å§‹ç¬¬ä¸€ä¸ªèŠ‚ç‚¹</a></h3>
<p>ä½œä¸ºç§æœ‰åŒºå—é“¾ç½‘ç»œçš„ç¬¬ä¸€ä¸ªå‚ä¸è€…ï¼Œä½ è´Ÿè´£å¯åŠ¨ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œè¢«ç§°ä¸º <strong>bootnode</strong>ã€‚
é€šè¿‡è¿è¡Œä¸ä»¥ä¸‹ç±»ä¼¼çš„å‘½ä»¤ï¼Œä½¿ç”¨è‡ªå®šä¹‰ chain specification å¯åŠ¨ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼š</p>
<pre><code class="language-bash editable noplayground">./target/release/node-template \
  --base-path /tmp/node01 \
  --chain ./customSpecRaw.json \
  --port 30333 \
  --ws-port 9945 \
  --rpc-port 9933 \
  --telemetry-url &quot;wss://telemetry.polkadot.io/submit/ 0&quot; \
  --validator \
  --rpc-methods Unsafe \
  --name MyNode01 \
  --password-interactive
</code></pre>
<p>æ³¨æ„ä»¥ä¸‹å‘½ä»¤è¡Œé€‰é¡¹å¯åŠ¨èŠ‚ç‚¹ï¼š</p>
<ul>
<li><code>--base path</code> å‘½ä»¤è¡Œé€‰é¡¹æŒ‡å®šä¸ç¬¬ä¸€ä¸ªèŠ‚ç‚¹å…³è”é“¾çš„è‡ªå®šä¹‰ä½ç½®ã€‚</li>
<li><code>--chain</code> å‘½ä»¤è¡Œé€‰é¡¹æŒ‡å®šè‡ªå®šä¹‰ chain specificationã€‚</li>
<li><code>--validator</code> å‘½ä»¤è¡Œé€‰é¡¹æŒ‡ç¤ºæ­¤èŠ‚ç‚¹å·²ç»è¢«é“¾æˆæƒã€‚</li>
<li><code>--rpc-methods Unsafe</code> å‘½ä»¤è¡Œé€‰é¡¹å…è®¸ä½ ä½¿ç”¨ä¸å®‰å…¨çš„é€šä¿¡æ¨¡å¼ï¼Œåœ¨æœ¬æ•™ç¨‹ç»§ç»­è¿™æ ·ç”¨ï¼Œå› ä¸ºä½ çš„åŒºå—é“¾æœªåœ¨ç”Ÿäº§è®¾ç½®ä¸­ä½¿ç”¨ã€‚</li>
<li><code>--name</code> å‘½ä»¤è¡Œé€‰é¡¹ä½¿ä½ èƒ½å¤Ÿåœ¨é¥æµ‹ UI ä¸­ä¸ºèŠ‚ç‚¹æä¾›ä¸€ä¸ªæ–¹ä¾¿é˜…è¯»çš„åç§°ã€‚</li>
</ul>
<p>æ­¤å‘½ä»¤è¿˜ä½¿ç”¨è‡ªå·±çš„ keys è€Œä¸æ˜¯é¢„å®šä¹‰çš„å¸æˆ·å¯åŠ¨èŠ‚ç‚¹ã€‚ç”±äºä½ æ²¡æœ‰ä½¿ç”¨å·²çŸ¥ keys çš„é¢„å®šä¹‰å¸æˆ·ï¼Œå› æ­¤ä½ éœ€è¦åœ¨å•ç‹¬çš„æ­¥éª¤ä¸­å°† keys æ·»åŠ åˆ°å¯†é’¥åº“ä¸­ã€‚</p>
<h3 id="æŸ¥çœ‹æœ‰å…³èŠ‚ç‚¹æ“ä½œçš„ä¿¡æ¯"><a class="header" href="#æŸ¥çœ‹æœ‰å…³èŠ‚ç‚¹æ“ä½œçš„ä¿¡æ¯">æŸ¥çœ‹æœ‰å…³èŠ‚ç‚¹æ“ä½œçš„ä¿¡æ¯</a></h3>
<p>å¯åŠ¨æœ¬åœ°èŠ‚ç‚¹åï¼Œæœ‰å…³æ‰€æ‰§è¡Œæ“ä½œçš„ä¿¡æ¯å°†æ˜¾ç¤ºåœ¨ç»ˆç«¯å¤–å£³ä¸­ã€‚åœ¨è¯¥ç»ˆç«¯ä¸­ï¼ŒéªŒè¯çœ‹åˆ°çš„è¾“å‡ºä¸ä»¥ä¸‹ç±»ä¼¼ï¼š</p>
<pre><code class="language-bash editable noplayground">2021-11-03 15:32:14 Substrate Node
2021-11-03 15:32:14 âœŒï¸  version 3.0.0-monthly-2021-09+1-bf52814-x86_64-macos
2021-11-03 15:32:14 â¤ï¸  by Substrate DevHub &lt;https://github.com/substrate-developer-hub&gt;, 2017-2021
2021-11-03 15:32:14 ğŸ“‹ Chain specification: My Custom Testnet
2021-11-03 15:32:14 ğŸ· Node name: MyNode01
2021-11-03 15:32:14 ğŸ‘¤ Role: AUTHORITY
2021-11-03 15:32:14 ğŸ’¾ Database: RocksDb at /tmp/node01/chains/local_testnet/db
2021-11-03 15:32:14 â›“  Native runtime: node-template-100 (node-template-1.tx1.au1)
2021-11-03 15:32:15 ğŸ”¨ Initializing Genesis block/state (state: 0x2bdeâ€¦8f66, header-hash: 0x6c78â€¦37de)
2021-11-03 15:32:15 ğŸ‘´ Loading GRANDPA authority set from genesis on what appears to be first startup.
2021-11-03 15:32:15 â±  Loaded block-time = 6s from block 0x6c78abc724f83285d1487ddcb1f948a2773cb38219c4674f84c727833be737de
2021-11-03 15:32:15 Using default protocol ID &quot;sup&quot; because none is configured in the chain specs
2021-11-03 15:32:15 ğŸ· Local node identity is: 12D3KooWLmrYDLoNTyTYtRdDyZLWDe1paxzxTw5RgjmHLfzW96SX
2021-11-03 15:32:15 ğŸ“¦ Highest known block at #0
2021-11-03 15:32:15 ã€½ï¸ Prometheus exporter started at 127.0.0.1:9615
2021-11-03 15:32:15 Listening for new connections on 127.0.0.1:9945.
2021-11-03 15:32:20 ğŸ’¤ Idle (0 peers), best: #0 (0x6c78â€¦37de), finalized #0 (0x6c78â€¦37de), â¬‡ 0 â¬† 0
</code></pre>
<p>æ³¨æ„ä»¥ä¸‹ä¿¡æ¯ï¼š</p>
<ul>
<li>è¾“å‡ºè¡¨æ˜æ‰€ä½¿ç”¨çš„ chain specification æ˜¯ä½ ä½¿ç”¨ <code>--chain</code> å‘½ä»¤è¡Œé€‰é¡¹åˆ›å»ºå’ŒæŒ‡å®šçš„è‡ªå®šä¹‰ chain specificationã€‚</li>
<li>è¾“å‡ºè¡¨æ˜è¯¥èŠ‚ç‚¹æ˜¯æœ‰æˆæƒçš„ï¼Œå› ä¸ºä½ ä½¿ç”¨ <code>--validator</code> å‘½ä»¤è¡Œé€‰é¡¹å¯åŠ¨äº†è¯¥èŠ‚ç‚¹ã€‚</li>
<li>è¾“å‡ºæ˜¾ç¤ºäº†ä½¿ç”¨å—å“ˆå¸Œåˆå§‹åŒ–çš„ <strong>åˆ›ä¸–å—</strong><code>(state: 0x2bdeâ€¦8f66, header-hash: 0x6c78â€¦37de)</code>ã€‚</li>
<li>è¾“å‡ºæŒ‡å®šäº†èŠ‚ç‚¹çš„ <strong>æœ¬åœ°èŠ‚ç‚¹æ ‡è¯†</strong>ï¼Œåœ¨æœ¬ä¾‹ä¸­ï¼ŒèŠ‚ç‚¹æ ‡è¯†ä¸º <code>12D3KooWLmrYDLoNTyTYtRdDyZLWDe1paxzxTw5RgjmHLfzW96SX</code>ã€‚</li>
<li>è¾“å‡ºæŒ‡å®šç”¨äºèŠ‚ç‚¹çš„ IP åœ°å€æ˜¯æœ¬åœ°ä¸»æœº <code>127.0.0.1</code>ã€‚</li>
</ul>
<p>è¿™äº›å€¼ç”¨äºæœ¬èŠ‚æ•™ç¨‹ç¤ºä¾‹ä¸­ä½ çš„èŠ‚ç‚¹ï¼Œä½ å¿…é¡»å°†èŠ‚ç‚¹çš„å€¼æä¾›ç»™å…¶ä»–ç½‘ç»œå‚ä¸è€…ä»¥è¿æ¥åˆ° bootnodeã€‚ç°åœ¨ä½ å·²ç»ä½¿ç”¨è‡ªå·±çš„å¯†é’¥æˆåŠŸå¯åŠ¨äº†ä¸€ä¸ªéªŒè¯å™¨èŠ‚ç‚¹ï¼Œå¹¶çœ‹åˆ°äº†èŠ‚ç‚¹æ ‡è¯†ï¼Œä½ å¯ä»¥ç»§ç»­ä¸‹ä¸€æ­¥ã€‚ä½†æ˜¯ï¼Œåœ¨å°†å¯†é’¥æ·»åŠ åˆ°å¯†é’¥åº“ä¹‹å‰ï¼Œè¯·æŒ‰ Control-c åœæ­¢è¯¥èŠ‚ç‚¹ã€‚</p>
<h3 id="å°†-key-æ·»åŠ åˆ°å¯†é’¥åº“"><a class="header" href="#å°†-key-æ·»åŠ åˆ°å¯†é’¥åº“">å°† key æ·»åŠ åˆ°å¯†é’¥åº“</a></h3>
<p>å¯åŠ¨ç¬¬ä¸€ä¸ªèŠ‚ç‚¹åï¼Œå°šæœªç”Ÿæˆä»»ä½•å—ã€‚ä¸‹ä¸€æ­¥æ˜¯ä¸ºç½‘ç»œä¸­çš„æ¯ä¸ªèŠ‚ç‚¹å‘å¯†é’¥åº“æ·»åŠ ä¸¤ç§ç±»å‹çš„ keyã€‚
å¯¹äºæ¯ä¸ªèŠ‚ç‚¹ï¼š</p>
<ul>
<li>æ·»åŠ  <code>aura</code> æˆæƒ keys ä»¥å¯ç”¨åŒºå—çš„ç”Ÿæˆã€‚</li>
<li>æ·»åŠ  <code>grandpa</code> æˆæƒ keys ä»¥å¯ç”¨åŒºå—çš„æœ€ç»ˆç¡®è®¤ã€‚</li>
</ul>
<p>æœ‰å‡ ç§æ–¹æ³•å¯ä»¥å°† key æ’å…¥å¯†é’¥åº“ã€‚å¯¹äºæœ¬èŠ‚æ•™ç¨‹ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>key</code> å­å‘½ä»¤æ’å…¥æœ¬åœ°ç”Ÿæˆçš„ keyã€‚</p>
<p>é€šè¿‡è¿è¡Œä¸ä»¥ä¸‹ç±»ä¼¼çš„å‘½ä»¤ï¼Œæ’å…¥ä» <code>key</code> å­å‘½ä»¤ç”Ÿæˆçš„ <code>aura</code> å¯†é’¥ï¼ˆkeyï¼‰ï¼š</p>
<pre><code class="language-bash editable noplayground">./target/release/node-template key insert --base-path /tmp/node01 \
  --chain customSpecRaw.json \
  --scheme Sr25519 \
  --suri &lt;your-secret-seed&gt; \
  --password-interactive \
  --key-type aura
</code></pre>
<p>ä½¿ç”¨ secret phrase æˆ–è€… secret seed æ›¿æ¢ <code>&lt;your-secret-seed&gt;</code> ï¼Œåœ¨ä¹‹å‰ <a href="#%E4%BD%BF%E7%94%A8-node-template-%E7%94%9F%E6%88%90%E6%9C%AC%E5%9C%B0%E5%AF%86%E9%92%A5"><strong>ä½¿ç”¨ node template ç”Ÿæˆæœ¬åœ°å¯†é’¥</strong></a> çš„éƒ¨åˆ†æŸ¥æ‰¾ç›¸å…³çš„ç¬¬ä¸€ä¸ªå¯†é’¥å¯¹ã€‚</p>
<p>åœ¨æœ¬èŠ‚æ•™ç¨‹ä¸­ï¼Œsecret phrase æ˜¯ <code>pig giraffe ceiling enter weird liar orange decline behind total despair fly</code>ï¼Œå› æ­¤ <code>--suri</code> å‘½ä»¤è¡Œé€‰é¡¹ä½¿ç”¨è¿™æ®µå­—ç¬¦ä¸²å°† key æ’å…¥å¯†é’¥åº“ã€‚
<code>--suri &quot;pig giraffe ceiling enter weird liar orange decline behind total despair fly&quot;</code></p>
<p>ä½ ä¹Ÿå¯ä»¥ä»æŒ‡å®šçš„æ–‡ä»¶ä½ç½®æ’å…¥ keyï¼Œæœ‰å…³å¯ç”¨å‘½ä»¤è¡Œé€‰é¡¹çš„ä¿¡æ¯ï¼Œè¯·è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
<code>./target/release/node-template key insert --help</code></p>
<p>è¾“å…¥ç”Ÿæˆå¯†é’¥çš„å¯†ç ã€‚</p>
<p>é€šè¿‡è¿è¡Œä¸ä»¥ä¸‹ç±»ä¼¼çš„å‘½ä»¤ï¼Œæ’å…¥ä» key å­å‘½ä»¤ç”Ÿæˆçš„ <code>grandpa</code> å¯†é’¥ï¼ˆkeyï¼‰ï¼š</p>
<pre><code class="language-bash editable noplayground">./target/release/node-template key insert \
  --base-path /tmp/node01 \
  --chain customSpecRaw.json \
  --scheme Ed25519 \
  --suri &lt;your-secret-key&gt; \
  --password-interactive \
  --key-type gran
</code></pre>
<p>ä½¿ç”¨ secret phrase æˆ–è€… secret seed æ›¿æ¢ <code>&lt;your-secret-seed&gt;</code> ï¼Œåœ¨ä¹‹å‰ <a href="#%E4%BD%BF%E7%94%A8-node-template-%E7%94%9F%E6%88%90%E6%9C%AC%E5%9C%B0%E5%AF%86%E9%92%A5"><strong>ä½¿ç”¨ node template ç”Ÿæˆæœ¬åœ°å¯†é’¥</strong></a> çš„éƒ¨åˆ†æŸ¥æ‰¾ç›¸å…³çš„ç¬¬ä¸€ä¸ªå¯†é’¥å¯¹ã€‚</p>
<p>åœ¨æœ¬èŠ‚æ•™ç¨‹ä¸­ï¼Œsecret phrase æ˜¯ <code>pig giraffe ceiling enter weird liar orange decline behind total despair fly</code>ï¼Œå› æ­¤ <code>--suri</code> å‘½ä»¤è¡Œé€‰é¡¹ä½¿ç”¨è¿™æ®µå­—ç¬¦ä¸²å°† key æ’å…¥å¯†é’¥åº“ã€‚
<code>--suri &quot;pig giraffe ceiling enter weird liar orange decline behind total despair fly&quot;</code></p>
<p>è¾“å…¥ç”Ÿæˆå¯†é’¥çš„å¯†ç ã€‚</p>
<p>é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯ä½ çš„å¯†é’¥ï¼ˆkeyï¼‰æ˜¯å¦ä½äº <code>node01</code> çš„å¯†é’¥åº“ä¸­ï¼š</p>
<pre><code class="language-bash editable noplayground">ls /tmp/node01/chains/local_testnet/keystore
</code></pre>
<p>è¯¥å‘½ä»¤æ˜¾ç¤ºç±»ä¼¼äºä»¥ä¸‹çš„è¾“å‡ºï¼š</p>
<pre><code class="language-bash editable noplayground">617572611441ddcb22724420b87ee295c6d47c5adff0ce598c87d3c749b776ba9a647f04
6772616e1441ddcb22724420b87ee295c6d47c5adff0ce598c87d3c749b776ba9a647f04
</code></pre>
<p>åœ¨ /tmp/node01 ä¸‹çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„å¯†é’¥åº“ä¸­æ·»åŠ äº† keys åï¼Œä½ å¯ä»¥ä½¿ç”¨å…ˆå‰åœ¨ <a href="#%E5%BC%80%E5%A7%8B%E7%AC%AC%E4%B8%80%E4%B8%AA%E8%8A%82%E7%82%B9">å¼€å§‹ç¬¬ä¸€ä¸ªèŠ‚ç‚¹</a> ä¸­ä½¿ç”¨çš„å‘½ä»¤é‡æ–°å¯åŠ¨èŠ‚ç‚¹ã€‚</p>
<h3 id="å¼€å¯å…è®¸å…¶ä»–å‚ä¸è€…åŠ å…¥"><a class="header" href="#å¼€å¯å…è®¸å…¶ä»–å‚ä¸è€…åŠ å…¥">å¼€å¯å…è®¸å…¶ä»–å‚ä¸è€…åŠ å…¥</a></h3>
<p>ç°åœ¨å¯ä»¥ä½¿ç”¨ <code>--bootnodes</code> å’Œ <code>--validator</code> å‘½ä»¤è¡Œé€‰é¡¹å…è®¸å…¶ä»–éªŒè¯è€…åŠ å…¥ç½‘ç»œã€‚</p>
<p>å‘ç§æœ‰ç½‘ç»œæ·»åŠ ç¬¬äºŒä¸ªéªŒè¯è€…åŒºå—é“¾èŠ‚ç‚¹ï¼š</p>
<pre><code class="language-bash editable noplayground">./target/release/node-template \
  --base-path /tmp/node02 \
  --chain ./customSpecRaw.json \
  --port 30334 \
  --ws-port 9946 \
  --rpc-port 9934 \
  --telemetry-url &quot;wss://telemetry.polkadot.io/submit/ 0&quot; \
  --validator \
  --rpc-methods Unsafe \
  --name MyNode02 \
  --bootnodes /ip4/127.0.0.1/tcp/30333/p2p/12D3KooWLmrYDLoNTyTYtRdDyZLWDe1paxzxTw5RgjmHLfzW96SX \
  --password-interactive
</code></pre>
<p>æ­¤å‘½ä»¤ä½¿ç”¨ <code>base-path</code>ã€<code>name</code> å’Œ <code>validator</code> å‘½ä»¤è¡Œé€‰é¡¹å°†æ­¤èŠ‚ç‚¹æ ‡è¯†ä¸ºä¸“ç”¨ç½‘ç»œçš„ç¬¬äºŒä¸ªéªŒè¯è€…ã€‚<code>--chain</code> å‘½ä»¤è¡Œé€‰é¡¹æŒ‡å®šè¦ä½¿ç”¨çš„ chain specification æ–‡ä»¶ï¼Œå¯¹äºç½‘ç»œä¸­çš„æ‰€æœ‰éªŒè¯è€…ï¼Œæ­¤æ–‡ä»¶å¿…é¡»å®Œå…¨ç›¸åŒã€‚ç¡®ä¿ä¸º <code>--bootnodes</code> å‘½ä»¤è¡Œé€‰é¡¹è®¾ç½®äº†æ­£ç¡®çš„ä¿¡æ¯ã€‚ç‰¹åˆ«æ˜¯ï¼Œè¯·ç¡®ä¿å·²ä»ç½‘ç»œä¸­çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æŒ‡å®šäº†æœ¬åœ°èŠ‚ç‚¹æ ‡è¯†ç¬¦ã€‚å¦‚æœæœªè®¾ç½®æ­£ç¡®çš„ <code>bootnode</code> æ ‡è¯†ç¬¦ï¼Œåˆ™ä¼šçœ‹åˆ°å¦‚ä¸‹é”™è¯¯ï¼š
<code>The bootnode you want to connect to at ... provided a different peer ID than the one you expect: ... </code></p>
<p>é€šè¿‡è¿è¡Œä¸ä»¥ä¸‹ç±»ä¼¼çš„å‘½ä»¤ï¼Œæ’å…¥ä» key å­å‘½ä»¤ç”Ÿæˆçš„ <code>aura</code> å¯†é’¥ï¼ˆkeyï¼‰ï¼š</p>
<pre><code class="language-bash editable noplayground">./target/release/node-template key insert --base-path /tmp/node02 \
  --chain customSpecRaw.json \
  --scheme Sr25519 \
  --suri &lt;second-participant-secret-seed&gt; \
  --password-interactive \
  --key-type aura
</code></pre>
<p>ä½¿ç”¨ secret phrase æˆ–è€… secret seed æ›¿æ¢ <code>&lt;second-participant-secret-seed&gt;</code> ï¼Œåœ¨ä¹‹å‰ <a href="#%E7%94%9F%E6%88%90%E7%AC%AC%E4%BA%8C%E7%BB%84%E5%AF%86%E9%92%A5"><strong>ç”Ÿæˆç¬¬äºŒç»„å¯†é’¥</strong></a> çš„éƒ¨åˆ†æŸ¥æ‰¾ç›¸å…³çš„ç¬¬äºŒä¸ªå¯†é’¥å¯¹ã€‚åªæœ‰ <code>--key-type</code> çš„å€¼æ˜¯ <code>aura</code> æ‰èƒ½å¼€å¯åŒºå—ç”ŸæˆåŠŸèƒ½ã€‚</p>
<p>è¾“å…¥ç”Ÿæˆå¯†é’¥çš„å¯†ç ã€‚</p>
<p>é€šè¿‡è¿è¡Œä¸ä»¥ä¸‹ç±»ä¼¼çš„å‘½ä»¤ï¼Œæ’å…¥ä» key å­å‘½ä»¤ç”Ÿæˆçš„ <code>grandpa</code> å¯†é’¥ï¼ˆkeyï¼‰ï¼š</p>
<pre><code class="language-bash editable noplayground">./target/release/node-template key insert --base-path /tmp/node02 \
  --chain customSpecRaw.json \
  --scheme Ed25519 --suri &lt;second-participant-secret-seed&gt; \
  --password-interactive \
  --key-type gran
</code></pre>
<p>ä½¿ç”¨ secret phrase æˆ–è€… secret seed æ›¿æ¢ <code>&lt;second-participant-secret-seed&gt;</code> ï¼Œåœ¨ä¹‹å‰ <a href="#%E7%94%9F%E6%88%90%E7%AC%AC%E4%BA%8C%E7%BB%84%E5%AF%86%E9%92%A5"><strong>ç”Ÿæˆç¬¬äºŒç»„å¯†é’¥</strong></a> çš„éƒ¨åˆ†æŸ¥æ‰¾ç›¸å…³çš„ç¬¬äºŒä¸ªå¯†é’¥å¯¹ã€‚åªæœ‰ <code>--key-type</code> çš„å€¼æ˜¯ <code>gran</code> æ‰èƒ½å¼€å¯åŒºå—æœ€ç»ˆç¡®è®¤åŠŸèƒ½ã€‚</p>
<p>å—ç»ˆç»“éœ€è¦è‡³å°‘ä¸‰åˆ†ä¹‹äºŒçš„éªŒè¯è€…å°†å…¶å¯†é’¥æ·»åŠ åˆ°å„è‡ªçš„å¯†é’¥åº“ä¸­ã€‚ç”±äºæ­¤ç½‘ç»œåœ¨ chain specification ä¸­é…ç½®äº†ä¸¤ä¸ªéªŒè¯å™¨ï¼Œå› æ­¤åªæœ‰åœ¨ç¬¬äºŒä¸ªèŠ‚ç‚¹æ·»åŠ äº†å…¶å¯†é’¥åï¼Œæ‰èƒ½å¼€å¯å—æœ€ç»ˆç¡®è®¤ã€‚</p>
<p>è¾“å…¥ç”Ÿæˆå¯†é’¥çš„å¯†ç ã€‚</p>
<p>é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤éªŒè¯ä½ çš„å¯†é’¥ï¼ˆkeyï¼‰æ˜¯å¦ä½äº <code>node02</code> çš„å¯†é’¥åº“ä¸­ï¼š
<code>ls /tmp/node02/chains/local_testnet/keystore</code></p>
<p>è¯¥å‘½ä»¤æ˜¾ç¤ºç±»ä¼¼äºä»¥ä¸‹çš„è¾“å‡ºï¼š</p>
<pre><code class="language-bash editable noplayground">617572611a4cc824f6585859851f818e71ac63cf6fdc81018189809814677b2a4699cf45
6772616e1a4cc824f6585859851f818e71ac63cf6fdc81018189809814677b2a4699cf45
</code></pre>
<p>Substrate nodes åœ¨æ’å…¥ <code>grandpa</code> å¯†é’¥ä¹‹åéœ€è¦é‡æ–°å¯åŠ¨ï¼Œå› æ­¤ï¼Œä½ å¿…é¡»å…³é—­å¹¶é‡æ–°å¯åŠ¨èŠ‚ç‚¹ï¼Œç„¶åæ‰èƒ½çœ‹åˆ°æ­£åœ¨å®Œæˆçš„å—ã€‚æŒ‰ Control-c å…³é—­èŠ‚ç‚¹ã€‚</p>
<p>é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤é‡æ–°å¯åŠ¨ç¬¬äºŒä¸ªåŒºå—é“¾èŠ‚ç‚¹ï¼š</p>
<pre><code class="language-bash editable noplayground">./target/release/node-template \
  --base-path /tmp/node02 \
  --chain ./customSpecRaw.json \
  --port 30334 \
  --ws-port 9946 \
  --rpc-port 9934 \
  --telemetry-url 'wss://telemetry.polkadot.io/submit/ 0' \
  --validator \
  --rpc-methods Unsafe \
  --name MyNode02 \
  --bootnodes /ip4/127.0.0.1/tcp/30333/p2p/12D3KooWLmrYDLoNTyTYtRdDyZLWDe1paxzxTw5RgjmHLfzW96SX \
  --password-interactive
</code></pre>
<p>åœ¨ä¸¤ä¸ªèŠ‚ç‚¹å°†å…¶å¯†é’¥ key æ·»åŠ åˆ°ä½äº /tmp/node01 å’Œ /tmp/node02 ä¸‹çš„å„è‡ªå¯†é’¥åº“å¹¶é‡æ–°å¯åŠ¨åï¼Œä½ åº”è¯¥çœ‹åˆ°ç›¸åŒçš„ genesis å—å’ŒçŠ¶æ€æ ¹å“ˆå¸Œã€‚ä½ è¿˜åº”è¯¥çœ‹åˆ°ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸€ä¸ª peerï¼ˆ<code>1 peers</code>ï¼‰ï¼Œå¹¶ä¸”å®ƒä»¬ç”Ÿæˆäº†ä¸€ä¸ªå— proposal ï¼ˆ<code>best: #2 (0xe111â€¦c084)</code>ï¼‰ã€‚å‡ ç§’é’Ÿåï¼Œä½ å°†çœ‹åˆ°ä¸¤ä¸ªèŠ‚ç‚¹ä¸Šçš„æ–°å—éƒ½å·²æœ€ç»ˆç¡®è®¤ã€‚</p>
<p><img src="https://awesomeprogram.gitee.io/imgdata/tech_bc_subtrust1.jpg" alt="" /></p>
<p><img src="https://awesomeprogram.gitee.io/imgdata/tech_bc_subtrust2.jpg" alt="" /></p>
<h2 id="æˆæƒç‰¹å®šèŠ‚ç‚¹"><a class="header" href="#æˆæƒç‰¹å®šèŠ‚ç‚¹">æˆæƒç‰¹å®šèŠ‚ç‚¹</a></h2>
<p>æœ¬èŠ‚æ•™ç¨‹æ¼”ç¤ºäº†è®¸å¯ç½‘ç»œçš„ç®€åŒ–ç‰ˆæœ¬ã€‚åœ¨è®¸å¯ç½‘ç»œä¸­ï¼Œä»…å…è®¸æˆæƒèŠ‚ç‚¹æ‰§è¡Œç‰¹å®šçš„ç½‘ç»œæ´»åŠ¨ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥æˆäºˆæŸäº›èŠ‚ç‚¹éªŒè¯å—çš„æƒé™ï¼Œè€Œæˆäºˆå…¶ä»–èŠ‚ç‚¹ä¼ æ’­äº¤æ˜“çš„æƒé™ã€‚å…·æœ‰è¢«æˆäºˆç‰¹å®šæƒé™çš„èŠ‚ç‚¹çš„åŒºå—é“¾ä¸åŒäºå…¬å…±æˆ–æ— è®¸å¯çš„åŒºå—é“¾ã€‚åœ¨æ— è®¸å¯çš„åŒºå—é“¾ä¸­ï¼Œä»»ä½•äººéƒ½å¯ä»¥é€šè¿‡åœ¨åˆé€‚çš„ç¡¬ä»¶ä¸Šè¿è¡ŒèŠ‚ç‚¹è½¯ä»¶æ¥åŠ å…¥ç½‘ç»œã€‚ä¸€èˆ¬è€Œè¨€ï¼Œæ— è®¸å¯åŒºå—é“¾æä¾›äº†æ›´å¤§çš„ç½‘ç»œå»ä¸­å¿ƒåŒ–ã€‚ç„¶è€Œï¼Œåœ¨æŸäº›ç”¨ä¾‹ä¸­ï¼Œåˆ›å»ºè®¸å¯çš„åŒºå—é“¾å¯èƒ½æ˜¯åˆé€‚çš„ã€‚ä¾‹å¦‚ï¼Œè®¸å¯åŒºå—é“¾é€‚ç”¨äºä»¥ä¸‹ç±»å‹çš„é¡¹ç›®ï¼š</p>
<ul>
<li>ç”¨äºç§äººæˆ–è”ç›Ÿç½‘ç»œï¼Œä¾‹å¦‚ç§äººä¼ä¸šæˆ–éè¥åˆ©ç»„ç»‡ã€‚</li>
<li>åœ¨é«˜åº¦ç›‘ç®¡çš„æ•°æ®ç¯å¢ƒä¸­ï¼Œå¦‚åŒ»ç–—ä¿å¥ã€é‡‘èæˆ–ä¼ä¸šå¯¹ä¼ä¸šä¹‹é—´çš„è”ç›Ÿã€‚</li>
<li>ç”¨äºå¤§è§„æ¨¡æµ‹è¯•é¢„å…¬å¼€åŒºå—é“¾ç½‘ç»œã€‚</li>
</ul>
<p>æœ¬èŠ‚æ•™ç¨‹è¯´æ˜å¦‚ä½•é€šè¿‡ <a href="https://paritytech.github.io/substrate/master/pallet_node_authorization/index.html">node authorization pallet</a> ä½¿ç”¨ Substrate æ„å»ºä¸€ä¸ªè®¸å¯ç½‘ç»œã€‚</p>
<h3 id="èŠ‚ç‚¹æˆæƒå’Œæ‰€æœ‰æƒ"><a class="header" href="#èŠ‚ç‚¹æˆæƒå’Œæ‰€æœ‰æƒ">èŠ‚ç‚¹æˆæƒå’Œæ‰€æœ‰æƒ</a></h3>
<p><code>node-authorization</code> pallet æ˜¯ä¸€ä¸ªé¢„å…ˆæ„å»ºçš„ FRAME palletï¼Œä½¿ä½ èƒ½å¤Ÿç®¡ç†ç½‘ç»œçš„ä¸€ç»„å¯é…ç½®èŠ‚ç‚¹ã€‚æ¯ä¸ªèŠ‚ç‚¹ç”±ä¸€ä¸ª <code>PeerId</code> æ ‡è¯†ï¼Œæ¯ä¸ª <code>PeerId</code> ç”±ä¸€ä¸ªä¸”ä»…ä¸€ä¸ªå£°æ˜èŠ‚ç‚¹çš„ <code>AccountId</code> æ‹¥æœ‰ã€‚æœ‰ä¸¤ç§æ–¹å¼å¯ä»¥æˆæƒèŠ‚ç‚¹åŠ å…¥ç½‘ç»œï¼š</p>
<ul>
<li>é€šè¿‡å°† <code>PeerId</code> æ·»åŠ åˆ°é¢„å®šä¹‰èŠ‚ç‚¹çš„åˆ—è¡¨ä¸­ï¼Œä½ å¿…é¡»è·å¾—ç½‘ç»œä¸­çš„ governance pallet æˆ– sudo pallet çš„æ ¸å‡†æ‰èƒ½æ‰§è¡Œæ­¤æ“ä½œã€‚</li>
<li>é€šè¿‡è¯·æ±‚æ¥è‡ªç‰¹å®šèŠ‚ç‚¹ paired peer è¿æ¥ï¼Œè¯¥èŠ‚ç‚¹å¯ä»¥æ˜¯é¢„å®šä¹‰çš„èŠ‚ç‚¹ <code>PeerId</code>ï¼Œä¹Ÿå¯ä»¥æ˜¯æ™®é€šèŠ‚ç‚¹ã€‚</li>
</ul>
<p>è¯·æ³¨æ„ï¼Œä»»ä½•ç”¨æˆ·éƒ½å¯ä»¥å£°ç§°æ˜¯ <code>PeerId</code> çš„æ‰€æœ‰è€…ï¼Œä¸ºäº†é˜²æ­¢é”™è¯¯å£°æ˜ï¼Œåº”åœ¨å¯åŠ¨èŠ‚ç‚¹ä¹‹å‰å£°æ˜èŠ‚ç‚¹ã€‚åœ¨ä½ å¯åŠ¨èŠ‚ç‚¹åï¼Œå®ƒçš„ <code>PeerID</code> å¯¹ç½‘ç»œæ˜¯å¯è§çš„ï¼Œä»»ä½•äººéšåéƒ½å¯ä»¥å£°æ˜å®ƒã€‚</p>
<p>ä½œä¸ºèŠ‚ç‚¹çš„æ‰€æœ‰è€…ï¼Œä½ å¯ä»¥æ·»åŠ å’Œåˆ é™¤èŠ‚ç‚¹çš„è¿æ¥ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥æ“çºµé¢„å®šä¹‰èŠ‚ç‚¹ä¸ä½ çš„èŠ‚ç‚¹ä¹‹é—´çš„è¿æ¥ï¼Œæˆ–è€…æ“çºµä½ çš„èŠ‚ç‚¹ä¸å…¶ä»–éé¢„å®šä¹‰èŠ‚ç‚¹ä¹‹é—´çš„å…³ç³»ã€‚ä½ ä¸èƒ½æ›´æ”¹é¢„å®šä¹‰èŠ‚ç‚¹çš„è¿æ¥ï¼Œå› ä¸ºä»–ä»¬æ€»æ˜¯è¢«å…è®¸äº’ç›¸è¿æ¥ã€‚</p>
<p><code>node-authorization</code> pallet ä½¿ç”¨ä¸€ä¸ªé“¾ä¸‹å·¥ä½œæœºé…ç½®å…¶èŠ‚ç‚¹è¿æ¥ã€‚è¯·ç¡®ä¿åœ¨å¯åŠ¨èŠ‚ç‚¹æ—¶å·²ç»å¯ç”¨äº†é“¾å¤–å·¥ä½œæœºï¼Œå› ä¸ºå¯¹äºéæˆæƒèŠ‚ç‚¹ï¼Œå®ƒåœ¨é»˜è®¤æƒ…å†µä¸‹æ˜¯ç¦ç”¨çš„ã€‚</p>
<h3 id="æ„å»ºèŠ‚ç‚¹æ¨¡æ¿"><a class="header" href="#æ„å»ºèŠ‚ç‚¹æ¨¡æ¿">æ„å»ºèŠ‚ç‚¹æ¨¡æ¿</a></h3>
<pre><code class="language-bash editable noplayground">cd substrate-node-template
git checkout polkadot-v0.9.26
cargo build --release
</code></pre>
<h3 id="æ·»åŠ èŠ‚ç‚¹æˆæƒpallet"><a class="header" href="#æ·»åŠ èŠ‚ç‚¹æˆæƒpallet">æ·»åŠ èŠ‚ç‚¹æˆæƒpallet</a></h3>
<p>ç”±äº Substrate è¿è¡Œæ—¶ç¼–è¯‘ä¸ºåŒ…å«æ ‡å‡†åº“å‡½æ•°çš„åŸç”Ÿ Rust äºŒè¿›åˆ¶æ–‡ä»¶å’Œä¸åŒ…å«æ ‡å‡†åº“çš„ WebAssemblyï¼ˆWasmï¼‰äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå› æ­¤Cargo.toml æ–‡ä»¶æ§åˆ¶ä¸¤æ¡é‡è¦ä¿¡æ¯ï¼š</p>
<ul>
<li>å°† pallets ä½œä¸ºè¿è¡Œæ—¶çš„ä¾èµ–é¡¹å¯¼å…¥ï¼ŒåŒ…æ‹¬è¦å¯¼å…¥çš„ pallets çš„ä½ç½®å’Œç‰ˆæœ¬ã€‚</li>
<li>ç¼–è¯‘åŸç”Ÿ Rust äºŒè¿›åˆ¶æ–‡ä»¶æ—¶åº”å¯ç”¨æ¯ä¸ª pallet ä¸­çš„åŠŸèƒ½ã€‚é€šè¿‡ä»æ¯ä¸ª pallet å¯ç”¨æ ‡å‡†åº“ï¼ˆ<code>std</code>ï¼‰çš„ç‰¹æ€§ï¼Œä½ å¯ä»¥ç¼–è¯‘è¿è¡Œæ—¶ä»¥åŒ…å«å‡½æ•°ã€ç±»å‹å’ŒåŸè¯­ï¼Œå¦åˆ™åœ¨æ„å»º WebAssembly äºŒè¿›åˆ¶æ–‡ä»¶æ—¶ä¼šä¸¢å¤±è¿™äº›å‡½æ•°ã€ç±»å‹å’ŒåŸè¯­ã€‚</li>
</ul>
<p>æœ‰å…³åœ¨ <code>Cargo.toml</code> æ–‡ä»¶ä¸­æ·»åŠ ä¾èµ–é¡¹çš„ä¸€äº›ä¿¡æ¯ï¼Œå¯å‚è§ Cargo æ–‡æ¡£ä¸­çš„<a href="https://doc.rust-lang.org/cargo/guide/dependencies.html"><strong>ä¾èµ–</strong></a>ã€‚æœ‰å…³å¯ç”¨å’Œç®¡ç†ä¾èµ–åŒ…çš„åŠŸèƒ½çš„ä¿¡æ¯ï¼Œå¯å‚è§ Cargo æ–‡æ¡£ä¸­çš„<a href="https://doc.rust-lang.org/cargo/reference/features.html"><strong>ç‰¹æ€§</strong></a>ã€‚</p>
<h4 id="æ·»åŠ èŠ‚ç‚¹æˆæƒçš„ä¾èµ–"><a class="header" href="#æ·»åŠ èŠ‚ç‚¹æˆæƒçš„ä¾èµ–">æ·»åŠ èŠ‚ç‚¹æˆæƒçš„ä¾èµ–</a></h4>
<p>åœ¨ <code>[dependencies]</code> éƒ¨åˆ†æ·»åŠ  <code>pallet-node-authorization</code> crateï¼Œä½¿å…¶ç”¨äº node template è¿è¡Œæ—¶ï¼š</p>
<pre><code class="language-bash editable noplayground">[dependencies]
pallet-node-authorization = { default-features = false, version = &quot;4.0.0-dev&quot;, git = &quot;https://github.com/paritytech/substrate.git&quot;, branch = &quot;polkadot-v0.9.26&quot; }
</code></pre>
<p>è¯¥è¡Œ <code>pallet-node-authorization</code> crate ä½œä¸ºä¾èµ–å¯¼å…¥ï¼Œå¹¶ä¸”ä¸ºè¯¥ crate æŒ‡å®šä»¥ä¸‹é…ç½®ç»†èŠ‚ï¼š</p>
<ul>
<li>å½“ç¼–è¯‘è¿è¡Œæ—¶ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¸å¯ç”¨ pallet ç‰¹æ€§ã€‚</li>
<li>æ£€ç´¢ <code>pallet-node-authorization</code> crate çš„å­˜å‚¨åº“ä½ç½®ã€‚</li>
<li>ç”¨äºæ£€ç´¢ crate çš„ commit tagã€‚</li>
<li>crate çš„ç‰ˆæœ¬æ ‡è¯†ç¬¦ã€‚</li>
</ul>
<p>å°† <code>pallet-node-authorization/std</code> ç‰¹æ€§æ·»åŠ åˆ° <code>features</code> åˆ—è¡¨ä¸­ï¼Œä»¥ä¾¿åœ¨ç¼–è¯‘è¿è¡Œæ—¶å¯ç”¨ã€‚</p>
<pre><code class="language-bash editable noplayground">[features]
default = ['std']
std = [
 ...
 &quot;pallet-node-authorization/std&quot;,    # add this line
 ...
]
</code></pre>
<p>å¦‚æœä½ å¿˜è®°æ›´æ–° <code>Cargo.toml</code> æ–‡ä»¶ä¸­çš„ <code>features</code> éƒ¨åˆ†ï¼Œåœ¨ç¼–è¯‘è¿è¡Œæ—¶äºŒè¿›åˆ¶æ–‡ä»¶æ—¶ï¼Œä½ å¯èƒ½ä¼šçœ‹åˆ° <code>cannot find function</code> é”™è¯¯ã€‚</p>
<p>é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œæ£€æŸ¥æ–°ä¾èµ–é¡¹æ˜¯å¦æ­£ç¡®è§£æï¼š</p>
<pre><code class="language-bash editable noplayground">cargo check -p node-template-runtime
</code></pre>
<h4 id="æ·»åŠ ç®¡ç†è§„åˆ™"><a class="header" href="#æ·»åŠ ç®¡ç†è§„åˆ™">æ·»åŠ ç®¡ç†è§„åˆ™</a></h4>
<p>ä¸ºäº†åœ¨æœ¬èŠ‚æ•™ç¨‹ä¸­æ¨¡æ‹Ÿæ²»ç†ï¼Œä½ å¯ä»¥é…ç½® pallet ä½¿ç”¨ <code>EnsureRoot</code> ç‰¹æƒå‡½æ•°ï¼Œç„¶åå°±èƒ½è¢« Sudo pallet è°ƒç”¨ ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒSudo pallet åŒ…å«åœ¨èŠ‚ç‚¹æ¨¡æ¿ä¸­ï¼Œä½¿ä½ èƒ½å¤Ÿé€šè¿‡ root-level ç®¡ç†å¸æˆ·è¿›è¡Œè°ƒç”¨ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä½ å°†ä½¿ç”¨æ›´æ¥è¿‘ç°å®çš„åŸºäºæ²»ç†çš„æ–¹å¼å»æ£€æŸ¥ã€‚</p>
<p>è¦åœ¨è¿è¡Œæ—¶å¯ç”¨ <code>EnsureRoot </code> è§„åˆ™ï¼Œéœ€è¦åœ¨ <code>runtime/src/lib.rs</code> æ–‡ä»¶ä¸­æ·»åŠ ä¸‹é¢è¿™ä¸€è¡Œï¼š</p>
<pre><code class="language-bash editable noplayground">use frame_system::EnsureRoot;
</code></pre>
<h3 id="ä¸ºpalletå®ç°config-trait"><a class="header" href="#ä¸ºpalletå®ç°config-trait">ä¸ºpalletå®ç°Config trait</a></h3>
<p>æ¯ä¸ª pallet éƒ½æœ‰ä¸€ä¸ªç§°ä¸º <code>Config</code> çš„ <strong>Rust trait</strong>ï¼Œ<code>Config</code> trait ç”¨äºè¯†åˆ« pallet æ‰€éœ€çš„å‚æ•°å’Œç±»å‹ã€‚æ·»åŠ ä¸€ä¸ª pallet æ‰€éœ€çš„å¤§å¤šæ•° pallet-specific ä»£ç éƒ½æ˜¯ä½¿ç”¨ <code>Config</code> trait å®ç°çš„ã€‚ä¾‹å¦‚ï¼ŒæŸ¥çœ‹ä½ éœ€è¦åœ¨ node-authorization pallet ä¸­å®ç° <code>Config</code> traitï¼Œä½ å¯ä»¥å‚è€ƒ <a href="https://paritytech.github.io/substrate/master/pallet_node_authorization/pallet/trait.Config.html"><code>pallet_node_authorization::Config</code></a> çš„ Rust æ–‡æ¡£ã€‚</p>
<p>è¦åœ¨ä½ çš„è¿è¡Œæ—¶å®ç° <code>node-authorization</code> pallet ï¼Œæ‰“å¼€ <code>runtime/src/lib.rs</code> æ–‡ä»¶ï¼š</p>
<ul>
<li>ä¸º pallet åœ¨ <code>parameter_types</code> éƒ¨åˆ†æ·»åŠ ä»¥ä¸‹ä»£ç ï¼š</li>
</ul>
<pre><code class="language-rust editable noplayground">parameter_types! {
 pub const MaxWellKnownNodes: u32 = 8;
 pub const MaxPeerIdLength: u32 = 128;
}</code></pre>
<ul>
<li>ä½¿ç”¨ä»¥ä¸‹ä»£ç ä¸º pallet çš„ <code>Config</code> trait æ·»åŠ  <code>impl</code> éƒ¨åˆ†</li>
</ul>
<pre><code class="language-rust editable noplayground">impl pallet_node_authorization::Config for Runtime {
 type Event = Event;
 type MaxWellKnownNodes = MaxWellKnownNodes;
 type MaxPeerIdLength = MaxPeerIdLength;
 type AddOrigin = EnsureRoot&lt;AccountId&gt;;
 type RemoveOrigin = EnsureRoot&lt;AccountId&gt;;
 type SwapOrigin = EnsureRoot&lt;AccountId&gt;;
 type ResetOrigin = EnsureRoot&lt;AccountId&gt;;
 type WeightInfo = ();
}</code></pre>
<ul>
<li>ä½¿ç”¨ä»¥ä¸‹ä»£ç è¡Œå°† pallet æ·»åŠ åˆ° <code>construct_runtime</code> å®ï¼š</li>
</ul>
<pre><code class="language-bash editable noplayground">construct_runtime!(
pub enum Runtime where
   Block = Block,
   NodeBlock = opaque::Block,
   UncheckedExtrinsic = UncheckedExtrinsic
 {
   /*** Add This Line ***/
   NodeAuthorization: pallet_node_authorization::{Pallet, Call, Storage, Event&lt;T&gt;, Config&lt;T&gt;},
 }
);
</code></pre>
<ul>
<li>
<p>ä¿å­˜ä»£ç å¹¶å…³é—­æ–‡ä»¶ã€‚</p>
</li>
<li>
<p>é€šè¿‡è¿è¡Œä»¥ä¸‹å‘½ä»¤æ£€æŸ¥é…ç½®æ˜¯å¦å¯ä»¥ç¼–è¯‘ï¼š</p>
</li>
</ul>
<pre><code class="language-bash editable noplayground">cargo check -p node-template-runtime
</code></pre>
<h4 id="ä¸ºæˆæƒèŠ‚ç‚¹æ·»åŠ åˆ›ä¸–çºªå­˜å‚¨"><a class="header" href="#ä¸ºæˆæƒèŠ‚ç‚¹æ·»åŠ åˆ›ä¸–çºªå­˜å‚¨">ä¸ºæˆæƒèŠ‚ç‚¹æ·»åŠ åˆ›ä¸–çºªå­˜å‚¨</a></h4>
<p>åœ¨å¯åŠ¨ç½‘ç»œä»¥ä½¿ç”¨èŠ‚ç‚¹æˆæƒä¹‹å‰ï¼Œéœ€è¦ä¸€äº›é¢å¤–çš„é…ç½®æ¥å¤„ç† peer æ ‡è¯†ç¬¦å’Œ account æ ‡è¯†ç¬¦ã€‚ä¾‹å¦‚ï¼Œ<code>PeerId</code> ä»¥ bs58 çš„æ ¼å¼ç¼–ç ï¼Œå› æ­¤ä½ éœ€è¦åœ¨ <code>node/Cargo.toml</code> ä¸­ä¸º bs58 åº“æ·»åŠ ä¸€ä¸ªæ–°çš„ä¾èµ–é¡¹å¯¹ <code>PeerId</code> è¿›è¡Œè§£ç ä»¥è·å–å®ƒçš„å­—èŠ‚ã€‚ä¸ºäº†ç®€åŒ–æ“ä½œï¼ŒæˆæƒèŠ‚ç‚¹ä¸é¢„å®šä¹‰å¸æˆ·ç›¸å…³è”ã€‚</p>
<p>è¦ä¸ºæˆæƒèŠ‚ç‚¹é…ç½® genesis å­˜å‚¨ï¼Œæ‰“å¼€ <code>node/Cargo.toml</code> æ–‡ä»¶ï¼Œåœ¨ [dependencies] éƒ¨åˆ†ä¸º node template æ·»åŠ  <code>bs58</code> åº“ï¼š</p>
<pre><code class="language-bash editable noplayground">[dependencies]
bs58 = &quot;0.4.0&quot;
</code></pre>
<p>ä¿å­˜ä»£ç å¹¶å…³é—­æ–‡ä»¶ã€‚</p>
<p>åœ¨ç¼–è¾‘å™¨ä¸­æ‰“å¼€ <code>node/src/chain_spec.rs</code> æ–‡ä»¶ï¼Œä½¿ç”¨ä»¥ä¸‹ä»£ç ä¸ºæˆæƒåŠ å…¥ç½‘ç»œçš„èŠ‚ç‚¹æ·»åŠ  genesis å­˜å‚¨ï¼š</p>
<pre><code class="language-bash editable noplayground">use sp_core::OpaquePeerId; // A struct wraps Vec&lt;u8&gt;, represents as our `PeerId`.
use node_template_runtime::NodeAuthorizationConfig; // The genesis config that serves for our pallet.
</code></pre>
<p>ä¸º FRAME æ¨¡å—é…ç½®åˆå§‹å­˜å‚¨çŠ¶æ€çš„ <code>testnet_genesis</code> å‡½æ•°ï¼š</p>
<pre><code class="language-bash editable noplayground">/// Configure initial storage state for FRAME modules.
fn testnet_genesis(
 wasm_binary: &amp;[u8],
 initial_authorities: Vec&lt;(AuraId, GrandpaId)&gt;,
 root_key: AccountId,
 endowed_accounts: Vec&lt;AccountId&gt;,
 _enable_println: bool,
 ) -&gt; GenesisConfig {
</code></pre>
<p>åœ¨ <code>GenesisConfig</code> å£°æ˜ä¸­ï¼Œæ·»åŠ ä»¥ä¸‹ä»£ç å—ï¼š</p>
<pre><code class="language-rust editable noplayground"> node_authorization: NodeAuthorizationConfig {
   nodes: vec![
     (
       OpaquePeerId(bs58::decode(&quot;12D3KooWBmAwcd4PJNJvfV89HwE48nwkRmAgo8Vy3uQEyNNHBox2&quot;).into_vec().unwrap()),
       endowed_accounts[0].clone()
     ),
     (
       OpaquePeerId(bs58::decode(&quot;12D3KooWQYV9dGMFoRzNStwpXztXaBUjtPqi6aU76ZgUriHhKust&quot;).into_vec().unwrap()),
       endowed_accounts[1].clone()
     ),
   ],
 },</code></pre>
<p>åœ¨è¿™éƒ¨åˆ†ä»£ç ä¸­ï¼Œ<code>NodeAuthorizationConfig</code> åŒ…å«ä¸€ä¸ª <code>nodes</code> å±æ€§ï¼Œä»£è¡¨ä¸€ä¸ªæ‹¥æœ‰ä¸¤ä¸ªå…ƒç´  tuple çš„ vectorã€‚å…ƒç»„ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ æ˜¯ <code>OpaquePeerId</code>ï¼Œ<code>bs58::decode</code> æ“ä½œè½¬åŒ–ä¸ºæ–¹ä¾¿ human-readable <code>PeerId</code>ï¼Œå¦‚ï¼Œ<code>12D3KooWBmAwcd4PJNJvfV89HwE48nwkRmAgo8Vy3uQEyNNHBox2</code> åˆ°å­—èŠ‚ã€‚å…ƒç»„ä¸­ç¬¬äºŒä¸ªå…ƒç´ æ˜¯ <code>AccountId</code>ï¼Œä»£è¡¨æ­¤èŠ‚ç‚¹çš„æ‰€æœ‰è€…ï¼Œè¯¥ç¤ºä¾‹ä½¿ç”¨é¢„å®šä¹‰çš„ Alice å’Œ Bobï¼Œæ­¤å¤„æ ‡è¯†ä¸º endowed çš„å¸æˆ· [0] å’Œ [1]ã€‚</p>
<p>ä¿å­˜ä»£ç å¹¶å…³é—­æ–‡ä»¶ã€‚</p>
<h4 id="éªŒè¯èŠ‚ç‚¹æ˜¯å¦å¯ç¼–è¯‘"><a class="header" href="#éªŒè¯èŠ‚ç‚¹æ˜¯å¦å¯ç¼–è¯‘">éªŒè¯èŠ‚ç‚¹æ˜¯å¦å¯ç¼–è¯‘</a></h4>
<p>ç°åœ¨å·²ç»å®Œæˆäº†ä»£ç æ›´æ”¹ï¼Œå¯ä»¥éªŒè¯èŠ‚ç‚¹æ˜¯å¦å¯ç¼–è¯‘ã€‚</p>
<pre><code class="language-bash editable noplayground">cargo build --release
</code></pre>
<p>å¦‚æœæ²¡æœ‰è¯­æ³•é”™è¯¯ï¼Œåˆ™å¯ä»¥ç»§ç»­ã€‚å¦‚æœå­˜åœ¨é”™è¯¯ï¼Œè¯·æŒ‰ç…§ç¼–è¯‘è¾“å‡ºä¸­çš„è¯´æ˜è¿›è¡Œä¿®å¤ï¼Œç„¶åé‡æ–°è¿è¡Œ <code>cargo build</code> å‘½ä»¤ã€‚</p>
<h3 id="å¯åŠ¨è®¸å¯ç½‘ç»œ"><a class="header" href="#å¯åŠ¨è®¸å¯ç½‘ç»œ">å¯åŠ¨è®¸å¯ç½‘ç»œ</a></h3>
<p>ä½ ç°åœ¨å¯ä»¥ä½¿ç”¨é¢„å®šä¹‰å¸æˆ·çš„èŠ‚ç‚¹å¯†é’¥å’Œå¯¹ç­‰æ ‡è¯†ç¬¦æ¥å¯åŠ¨è®¸å¯ç½‘ç»œå¹¶æˆæƒå…¶ä»–èŠ‚ç‚¹åŠ å…¥ã€‚åœ¨æœ¬èŠ‚æ•™ç¨‹ï¼Œä½ å°†å¯åŠ¨å››ä¸ªèŠ‚ç‚¹ã€‚å…¶ä¸­ä¸‰ä¸ªèŠ‚ç‚¹ä¸é¢„å®šä¹‰çš„å¸æˆ·ç›¸å…³è”ï¼Œæ‰€æœ‰ä¸‰ä¸ªèŠ‚ç‚¹éƒ½å…è®¸ç”Ÿæˆå’ŒéªŒè¯å—ã€‚ç¬¬å››èŠ‚ç‚¹æ˜¯ä¸€ä¸ªå­èŠ‚ç‚¹ï¼Œä»…æœ‰æƒåœ¨æŒ‡å®šèŠ‚ç‚¹æ‰€æœ‰è€…çš„æ‰¹å‡†ä¸‹ä»è¯¥èŠ‚ç‚¹è¯»å–æ•°æ®ã€‚</p>
<h4 id="è·å–èŠ‚ç‚¹-keys-å’Œ-peerids"><a class="header" href="#è·å–èŠ‚ç‚¹-keys-å’Œ-peerids">è·å–èŠ‚ç‚¹ keys å’Œ peerIDs</a></h4>
<p>ä½ å·²ç»åœ¨ genesis å­˜å‚¨ä¸­é…ç½®äº†ä¸ Alice å’Œ Bob å¸æˆ·å…³è”çš„èŠ‚ç‚¹ã€‚ä½ å¯ä»¥ä½¿ç”¨ subkey ç¨‹åºæ£€æŸ¥ä¸é¢„å®šä¹‰å¸æˆ·å…³è”çš„å¯†é’¥ï¼Œå¹¶ç”Ÿæˆå’Œæ£€æŸ¥ä½ è‡ªå·±çš„å¯†é’¥ã€‚ç„¶è€Œï¼Œå¦‚æœä½ è¿è¡Œ <code>subkey generate-node-key</code> å‘½ä»¤ï¼Œé‚£ä¹ˆä½ çš„èŠ‚ç‚¹ key å’Œ peer æ ‡è¯†ç¬¦æ˜¯éšæœºç”Ÿæˆçš„ï¼Œä¸æœ¬èŠ‚æ•™ç¨‹ä¸­ä½¿ç”¨çš„ key å¹¶ä¸åŒ¹é…ã€‚ç”±äºæœ¬èŠ‚æ•™ç¨‹ä½¿ç”¨é¢„å®šä¹‰çš„å¸æˆ·å’Œ well-known node keysï¼Œä¸‹è¡¨æ€»ç»“äº†æ¯ä¸ªå¸æˆ·çš„ keyã€‚
|è´¦æˆ·|ä¸è´¦æˆ·å…³è”çš„ Keys|
|:-----|:-----|
|Alice|Node key: c12b6d18942f5ee8528c8e2baf4e147b5c5c18710926ea492d09cbd9f6c9f82a|
||PeerID (generated from the node key): 12D3KooWBmAwcd4PJNJvfV89HwE48nwkRmAgo8Vy3uQEyNNHBox2|
||Decoded PeerID in hex: 0024080112201ce5f00ef6e89374afb625f1ae4c1546d31234e87e3c3f51a62b91dd6bfa57df|
|Bob|Node key: 6ce3be907dbcabf20a9a5a60a712b4256a54196000a8ed4050d352bc113f8c58
|
||PeerID (generated from the node key): 12D3KooWQYV9dGMFoRzNStwpXztXaBUjtPqi6aU76ZgUriHhKust|
||Decoded PeerID in hex: 002408011220dacde7714d8551f674b8bb4b54239383c76a2b286fa436e93b2b7eb226bf4de7|</p>
<p>å¦å¤–ä¸¤ä¸ªå¼€å‘å¸æˆ· Charlie å’Œ Dave æ²¡æœ‰ well-known node keys æˆ– peer æ ‡è¯†ç¬¦ã€‚å‡ºäºæ¼”ç¤ºç›®çš„ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ä»¥ä¸‹çš„ keysï¼š
|è´¦æˆ·|ä¸è´¦æˆ·å…³è”çš„ Keys|
|:-----|:-----|
|Charlie|Node key: 3a9d5b35b9fb4c42aafadeca046f6bf56107bd2579687f069b42646684b94d9e|
||PeerID (generated from the node key): 12D3KooWJvyP3VJYymTqG7eH4PM5rN4T2agk5cdNCfNymAqwqcvZ|
||Decoded PeerID in hex: 002408011220876a7b4984f98006dc8d666e28b60de307309835d775e7755cc770328cdacf2e|
|Dave|Node key: a99331ff4f0e0a0434a6263da0a5823ea3afcfffe590c9f3014e6cf620f2b19a|
||PeerID (generated from the node key): 12D3KooWPHWFrfaJzxPnqnAYAoRUyAHHKqACmEycGTVmeVhQYuZN|
||Decoded PeerID in hex: 002408011220c81bc1d7057a1511eb9496f056f6f53cdfe0e14c8bd5ffca47c70a8d76c1326d|</p>
<h4 id="å¯åŠ¨ç¬¬ä¸€ä¸ªèŠ‚ç‚¹"><a class="header" href="#å¯åŠ¨ç¬¬ä¸€ä¸ªèŠ‚ç‚¹">å¯åŠ¨ç¬¬ä¸€ä¸ªèŠ‚ç‚¹</a></h4>
<pre><code class="language-bash editable noplayground">./target/release/node-template \
--chain=local \
--base-path /tmp/validator1 \
--alice \
--node-key=c12b6d18942f5ee8528c8e2baf4e147b5c5c18710926ea492d09cbd9f6c9f82a \
--port 30333 \
--ws-port 9944
</code></pre>
<p>åœ¨è¿™ä¸ªå‘½ä»¤ä¸­ï¼Œä½¿ç”¨ <code>--node-key</code> é€‰é¡¹æŒ‡å®šç”¨äºå®‰å…¨è¿æ¥åˆ°ç½‘ç»œçš„ keyã€‚è¯¥ key è¿˜ç”¨äºå†…éƒ¨ç”Ÿæˆ human-readable PeerIdï¼Œå¦‚ä¸Šéƒ¨åˆ†æ‰€ç¤ºã€‚<code>--alice</code> å°†èŠ‚ç‚¹å‘½åä¸º aliceï¼Œå¹¶ä½¿èŠ‚ç‚¹æˆä¸ºå¯ä»¥ç”Ÿæˆå—å’Œå®Œæˆå—çš„éªŒè¯è€…ï¼Œæ˜¯ <code>--name alice --validator</code> çš„ç®€å†™ã€‚</p>
<h4 id="å¯åŠ¨ç¬¬äºŒä¸ªèŠ‚ç‚¹"><a class="header" href="#å¯åŠ¨ç¬¬äºŒä¸ªèŠ‚ç‚¹">å¯åŠ¨ç¬¬äºŒä¸ªèŠ‚ç‚¹</a></h4>
<pre><code class="language-bash editable noplayground">./target/release/node-template \
--chain=local \
--base-path /tmp/validator2 \
--bob \
--node-key=6ce3be907dbcabf20a9a5a60a712b4256a54196000a8ed4050d352bc113f8c58 \
--port 30334 \
--ws-port 9945
</code></pre>
<p>ä¸¤ä¸ªèŠ‚ç‚¹å¯åŠ¨åï¼Œä½ åº”è¯¥èƒ½å¤Ÿåœ¨ä¸¤ä¸ªç»ˆç«¯æ—¥å¿—ä¸­çœ‹åˆ°ç”Ÿæˆå’Œå®Œæˆçš„æ–°å—ã€‚</p>
<h4 id="æ·»åŠ ç¬¬ä¸‰ä¸ªèŠ‚ç‚¹åˆ°å·²çŸ¥èŠ‚ç‚¹åˆ—è¡¨ä¸­"><a class="header" href="#æ·»åŠ ç¬¬ä¸‰ä¸ªèŠ‚ç‚¹åˆ°å·²çŸ¥èŠ‚ç‚¹åˆ—è¡¨ä¸­">æ·»åŠ ç¬¬ä¸‰ä¸ªèŠ‚ç‚¹åˆ°å·²çŸ¥èŠ‚ç‚¹åˆ—è¡¨ä¸­</a></h4>
<p><code>node-authorization</code> pallet ä½¿ç”¨é“¾ä¸‹å·¥ä½œæœºæ¥é…ç½®èŠ‚ç‚¹è¿æ¥ã€‚å› ä¸ºç¬¬ä¸‰ä¸ªèŠ‚ç‚¹ä¸æ˜¯ä¸€ä¸ª well-known èŠ‚ç‚¹å¹¶ä¸”å®ƒå°†ç½‘ç»œä¸­çš„ç¬¬å››ä¸ªèŠ‚ç‚¹é…ç½®ä¸º read-only sub-nodeï¼Œå› æ­¤ä½ å¿…é¡»ä»¥å‘½ä»¤è¡Œé€‰é¡¹ä»¥å¯åŠ¨é“¾ä¸‹å·¥ä½œæœºã€‚</p>
<pre><code class="language-bash editable noplayground">./target/release/node-template \
--chain=local \
--base-path /tmp/validator3 \
--name charlie  \
--node-key=3a9d5b35b9fb4c42aafadeca046f6bf56107bd2579687f069b42646684b94d9e \
--port 30335 \
--ws-port=9946 \
--offchain-worker always
</code></pre>
<p>å¯åŠ¨æ­¤èŠ‚ç‚¹åï¼Œä½ åº”è¯¥ä¼šçœ‹åˆ°è¯¥èŠ‚ç‚¹æ²¡æœ‰è¿æ¥çš„ peersã€‚ç”±äºè¿™æ˜¯ä¸€ä¸ªè®¸å¯ç½‘ç»œï¼Œå› æ­¤å¿…é¡»æ˜ç¡®æˆæƒèŠ‚ç‚¹è¿›è¡Œè¿æ¥ã€‚Alice å’Œ Bob èŠ‚ç‚¹è¢«é…ç½®åœ¨åˆ›ä¸–çºª <code>chain_spec.rs</code> çš„æ–‡ä»¶ä¸­ã€‚æ‰€æœ‰å…¶å®ƒèŠ‚ç‚¹éƒ½å¿…é¡»é€šè¿‡ Sudo pallet çš„è°ƒç”¨æ¥æ‰‹åŠ¨æ·»åŠ ã€‚ </p>
<h4 id="æˆæƒå¯¹ç¬¬ä¸‰èŠ‚ç‚¹çš„è®¿é—®"><a class="header" href="#æˆæƒå¯¹ç¬¬ä¸‰èŠ‚ç‚¹çš„è®¿é—®">æˆæƒå¯¹ç¬¬ä¸‰èŠ‚ç‚¹çš„è®¿é—®</a></h4>
<p>æœ¬èŠ‚æ•™ç¨‹ä½¿ç”¨ sudo pallet è¿›è¡Œæ²»ç†ã€‚å› æ­¤ï¼Œä½ å¯ä»¥ä½¿ç”¨ <code>sudo</code> pallet è°ƒç”¨ <code>node-authorization</code> pallet æä¾›çš„ <code>add_well_known_node</code> å‡½æ•°æ¥æ·»åŠ ç¬¬ä¸‰ä¸ªèŠ‚ç‚¹ã€‚
åˆ‡æ¢åˆ° <strong>Developer</strong> é¡µé¢ï¼Œ<strong>Sudo</strong> æ ‡ç­¾ï¼Œåœ¨åº”ç”¨ç¨‹åºä¸­ï¼Œæäº¤ <code>nodeAuthorization</code> - <code>add_well_known_node</code> è°ƒç”¨ï¼Œpeer idä¸º Charlie èŠ‚ç‚¹çš„åå…­è¿›åˆ¶ï¼Œæ‰€æœ‰è€…ä¸º Charlieã€‚</p>
<p><img src="https://awesomeprogram.gitee.io/imgdata/tech_bc_subaddwekno.jpg" alt="" /></p>
<p>åœ¨äº‹åŠ¡è¢«åŒ…æ‹¬åœ¨å—ä¸­ä¹‹åï¼Œä½ åº”è¯¥å¯ä»¥çœ‹åˆ° charlie èŠ‚ç‚¹è¢«è¿æ¥åˆ° alice å’Œ bob èŠ‚ç‚¹ï¼Œå¹¶å¼€å§‹åŒæ­¥å—ã€‚è¿™ä¸‰ä¸ªèŠ‚ç‚¹å¯ä»¥ä½¿ç”¨æœ¬åœ°ç½‘ç»œä¸­é»˜è®¤å¯ç”¨çš„ <a href="https://paritytech.github.io/substrate/master/sc_network/index.html">mDNS</a> å‘ç°æœºåˆ¶æ‰¾åˆ°å½¼æ­¤ã€‚</p>
<p>å¦‚æœä½ çš„èŠ‚ç‚¹ä¸åœ¨åŒä¸€ä¸ªæœ¬åœ°ç½‘ç»œä¸Šï¼Œä½ åº”è¯¥ä½¿ç”¨å‘½ä»¤è¡Œé€‰é¡¹ <code>--no-mdns</code> æ¥ç¦ç”¨å®ƒã€‚</p>
<h4 id="æ·»åŠ ä¸€ä¸ªå­èŠ‚ç‚¹"><a class="header" href="#æ·»åŠ ä¸€ä¸ªå­èŠ‚ç‚¹">æ·»åŠ ä¸€ä¸ªå­èŠ‚ç‚¹</a></h4>
<p>è¯¥ç½‘ç»œä¸­çš„ç¬¬å››èŠ‚ç‚¹ä¸æ˜¯ well-known çš„èŠ‚ç‚¹ã€‚è¿™ä¸ªèŠ‚ç‚¹çš„æ‰€æœ‰è€…æ˜¯ç”¨æˆ· <code>dave</code>ï¼Œä½†å®ƒæ˜¯ <code>charlie</code> çš„ sub-nodeã€‚å­èŠ‚ç‚¹åªèƒ½é€šè¿‡è¿æ¥åˆ° <code>charlie</code> æ‹¥æœ‰çš„èŠ‚ç‚¹æ¥è®¿é—®ç½‘ç»œã€‚çˆ¶èŠ‚ç‚¹è´Ÿè´£ä»»ä½•å­èŠ‚ç‚¹çš„æˆæƒè¿æ¥ï¼Œå¹¶åœ¨éœ€è¦åˆ é™¤æˆ–å®¡è®¡è¯¥å­èŠ‚ç‚¹æ—¶æ§åˆ¶è®¿é—®ã€‚</p>
<pre><code class="language-bash editable noplayground">./target/release/node-template \
--chain=local \
--base-path /tmp/validator4 \
--name dave \
--node-key=a99331ff4f0e0a0434a6263da0a5823ea3afcfffe590c9f3014e6cf620f2b19a \
--port 30336 \
--ws-port 9947 \
--offchain-worker always
</code></pre>
<p>å¯åŠ¨åï¼Œæ²¡æœ‰å¯ç”¨çš„è¿æ¥ã€‚è¿™æ˜¯ä¸€ä¸ªè®¸å¯ç½‘ç»œï¼Œå› æ­¤é¦–å…ˆï¼ŒCharlie éœ€è¦é…ç½®ä»–çš„èŠ‚ç‚¹ä»¥å…è®¸ä» Dave çš„èŠ‚ç‚¹è¿›è¡Œè¿æ¥ã€‚
åˆ‡æ¢åˆ° <strong>Developer Extrinsics</strong> é¡µé¢ï¼Œè®© Charlie å»æäº¤ä¸€ä¸ª <code>addConnections</code> extrinsicã€‚ç¬¬ä¸€ä¸ª PeerId æ˜¯ Charlie æ‰€åœ¨èŠ‚ç‚¹çš„åå…­è¿›åˆ¶ peer idã€‚è¿æ¥æ˜¯ Charlie èŠ‚ç‚¹å…è®¸çš„ peer ids åˆ—è¡¨ï¼Œè¿™é‡Œæˆ‘ä»¬åªæ·»åŠ  Dave çš„ã€‚</p>
<p><img src="https://awesomeprogram.gitee.io/imgdata/tech_bc_subchaddconn.jpg" alt="" /></p>
<p>ç„¶åï¼ŒDave éœ€è¦é…ç½®ä»–çš„èŠ‚ç‚¹ä»¥å…è®¸ä» Charlie çš„èŠ‚ç‚¹è¿›è¡Œè¿æ¥ã€‚ä½†åœ¨ä»–æ·»åŠ è¿™ä¸€ç‚¹ä¹‹å‰ï¼ŒDave éœ€è¦å£°æ˜ä»–çš„èŠ‚ç‚¹ï¼Œè¯æ˜è¿™ä¸ªèŠ‚ç‚¹çš„æ‰€æœ‰æƒã€‚</p>
<p><img src="https://awesomeprogram.gitee.io/imgdata/tech_bc_subdavclano.jpg" alt="" /></p>
<p>ç±»ä¼¼åœ°ï¼ŒDave å¯ä»¥ä» Charlie çš„èŠ‚ç‚¹æ·»åŠ è¿æ¥ã€‚</p>
<p><img src="https://awesomeprogram.gitee.io/imgdata/tech_bc_subdavaddconn.jpg" alt="" /></p>
<p>ä½ ç°åœ¨åº”è¯¥çœ‹åˆ° Dave æ­£åœ¨æ•è· blocksï¼Œä¸”åªæœ‰ä¸€ä¸ªå±äº Charlie çš„åŒä¼´ï¼é‡æ–°å¯åŠ¨ Dave çš„èŠ‚ç‚¹ï¼Œä»¥é˜²å®ƒæ— æ³•ç«‹å³ä¸ Charlie è¿æ¥ã€‚</p>
<p>ä»»ä½•èŠ‚ç‚¹éƒ½å¯ä»¥å‘å¸ƒå½±å“å…¶ä»–èŠ‚ç‚¹è¡Œä¸ºçš„ extrinsicsï¼Œåªè¦å®ƒæ˜¯ç”¨ä½œå¼•ç”¨é“¾ä¸Šçš„æ•°æ®ï¼Œå¹¶ä¸”ä½ åœ¨å¯†é’¥å­˜å‚¨åº“ä¸­æ‹¥æœ‰å¯ç”¨äºæ‰€éœ€æ¥æºçš„ç›¸å…³å¸æˆ·çš„ singing keyã€‚æœ¬æ¼”ç¤ºä¸­çš„æ‰€æœ‰èŠ‚ç‚¹éƒ½å¯ä»¥è®¿é—®å¼€å‘äººå‘˜çš„ singing keyï¼Œå› æ­¤æˆ‘ä»¬èƒ½å¤Ÿä»£è¡¨ charlie ä»ç½‘ç»œä¸Šçš„ä»»ä½•è¿æ¥èŠ‚ç‚¹å‘å‡ºå½±å“ charlie å­èŠ‚ç‚¹çš„å‘½ä»¤ã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼ŒèŠ‚ç‚¹æ“ä½œå‘˜åªèƒ½è®¿é—®å…¶èŠ‚ç‚¹ keysï¼Œå¹¶ä¸”æ˜¯å”¯ä¸€èƒ½å¤Ÿæ­£ç¡®ç­¾åå’Œæäº¤ extrinsics çš„äººï¼Œå¾ˆå¯èƒ½æ¥è‡ªä»–ä»¬è‡ªå·±çš„èŠ‚ç‚¹ï¼Œåœ¨é‚£é‡Œä»–ä»¬å¯ä»¥æ§åˆ¶ key çš„å®‰å…¨æ€§ã€‚</p>
<p>ç°åœ¨ï¼Œæ‚¨å·²ç»å­¦ä¹ äº†å¦‚ä½•æ„å»ºä¸€ä¸ªç½‘ç»œï¼Œå…¶ä¸­æŸäº›èŠ‚ç‚¹å…·æœ‰æœ‰é™çš„æƒé™å’Œå¯¹ç½‘ç»œèµ„æºçš„è®¿é—®æƒé™ã€‚</p>
<h2 id="ç›‘è§†èŠ‚ç‚¹æŒ‡æ ‡"><a class="header" href="#ç›‘è§†èŠ‚ç‚¹æŒ‡æ ‡">ç›‘è§†èŠ‚ç‚¹æŒ‡æ ‡</a></h2>
<h2 id="å‡çº§ä¸€ä¸ªè¿è¡Œä¸­çš„ç½‘ç»œ"><a class="header" href="#å‡çº§ä¸€ä¸ªè¿è¡Œä¸­çš„ç½‘ç»œ">å‡çº§ä¸€ä¸ªè¿è¡Œä¸­çš„ç½‘ç»œ</a></h2>
<p>ä¸è®¸å¤šåŒºå—é“¾ä¸åŒï¼ŒSubstrate å¼€å‘æ¡†æ¶æ”¯æŒå¯¹ä½œä¸ºåŒºå—é“¾æ ¸å¿ƒçš„è¿è¡Œæ—¶è¿›è¡Œ<strong>æ— åˆ†å‰å‡çº§</strong>ã€‚å¤§å¤šæ•°åŒºå—é“¾é¡¹ç›®éœ€è¦ä¸€ä¸ª<a href="https://docs.substrate.io/reference/glossary/#fork">ç¡¬åˆ†å‰</a>çš„ä»£ç åº“ï¼Œä»¥æ”¯æŒæ–°åŠŸèƒ½çš„æŒç»­å¼€å‘æˆ–ç°æœ‰åŠŸèƒ½çš„å¢å¼ºã€‚ä½¿ç”¨Substrateï¼Œä½ å¯ä»¥éƒ¨ç½²å¢å¼ºçš„è¿è¡Œæ—¶åŠŸèƒ½ï¼Œåœ¨ä¸ä½¿ç”¨ç¡¬åˆ†å‰çš„æƒ…å†µä¸‹è¿›è¡Œä¸­æ–­è¿­ä»£ã€‚å› ä¸ºè¿è¡Œæ—¶çš„å®šä¹‰æœ¬èº«æ˜¯ Substrate é“¾çŠ¶æ€ä¸­çš„ä¸€ä¸ªå…ƒç´ ï¼Œç½‘ç»œå‚ä¸è€…å¯ä»¥é€šè¿‡è°ƒç”¨äº¤æ˜“ä¸­çš„ <a href="https://paritytech.github.io/substrate/master/frame_system/pallet/enum.Call.html#variant.set_code"><code>set_code</code> å‡½æ•°</a>æ¥æ›´æ–°æ­¤å€¼ã€‚ç”±äºè¿è¡Œæ—¶çŠ¶æ€çš„æ›´æ–°æ˜¯å¯¹åŒºå—é“¾çš„å…±è¯†æœºåˆ¶å’ŒåŠ å¯†ä¿è¯è¿›è¡ŒéªŒè¯ï¼Œç½‘ç»œå‚ä¸è€…å¯ä»¥ä½¿ç”¨åŒºå—é“¾æœ¬èº«åˆ†å‘æ›´æ–°æˆ–æ‰©å±•çš„è¿è¡Œæ—¶é€»è¾‘ï¼Œè€Œæ— éœ€åˆ†å‰é“¾æˆ–å‘å¸ƒæ–°çš„åŒºå—é“¾å®¢æˆ·ç«¯ã€‚</p>
<p>æœ¬èŠ‚æ•™ç¨‹æ¼”ç¤ºå¦‚ä½•é€šè¿‡å°†ä»¥ä¸‹æ›´æ”¹éƒ¨ç½²åˆ°ç°æœ‰çš„ Substrate è¿è¡Œæ—¶æ¥æ‰§è¡Œæ— åˆ†å‰å‡çº§ï¼š</p>
<ul>
<li>å°† Scheduler pallet æ·»åŠ åˆ°è¿è¡Œæ—¶ã€‚</li>
<li>ä½¿ç”¨ Scheduler pallet å¢åŠ ç½‘ç»œå¸æˆ·çš„æœ€ä½ä½™é¢ã€‚</li>
</ul>
<h3 id="ä½¿ç”¨sudoæ‰˜ç›˜æˆæƒå‡çº§"><a class="header" href="#ä½¿ç”¨sudoæ‰˜ç›˜æˆæƒå‡çº§">ä½¿ç”¨Sudoæ‰˜ç›˜æˆæƒå‡çº§</a></h3>
<p>åœ¨ FRAME ä¸­ï¼Œ<code>Root</code> æºæ ‡è¯†ç€è¿è¡Œæ—¶ç®¡ç†å‘˜ã€‚åªæœ‰æ­¤ç®¡ç†å‘˜æ‰èƒ½é€šè¿‡è°ƒç”¨ <code>set_code</code> å‡½æ•°æ¥æ›´æ–°è¿è¡Œæ—¶ã€‚è¦ä½¿ç”¨ <code>Root</code> æºè°ƒç”¨æ­¤å‡½æ•°ï¼Œå¯ä»¥ä½¿ç”¨ Sudo pallet ä¸­çš„ <code>sudo</code> å‡½æ•°æ¥æŒ‡å®šå…·æœ‰è¶…çº§ç”¨æˆ·ç®¡ç†æƒé™çš„å¸æˆ·ã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œnode template çš„ chain specification æ–‡ä»¶æŒ‡å®š <code>alice</code> å¼€å‘å¸æˆ·æ˜¯ Sudo ç®¡ç†å¸æˆ·çš„æ‰€æœ‰è€…ã€‚å› æ­¤ï¼Œæœ¬èŠ‚æ•™ç¨‹ä½¿ç”¨ <code>alice</code> å¸æˆ·æ‰§è¡Œè¿è¡Œæ—¶å‡çº§ã€‚</p>
<h4 id="è¿è¡Œæ—¶å‡çº§çš„èµ„æºæ ¸ç®—"><a class="header" href="#è¿è¡Œæ—¶å‡çº§çš„èµ„æºæ ¸ç®—">è¿è¡Œæ—¶å‡çº§çš„èµ„æºæ ¸ç®—</a></h4>
<p>åˆ†å‘åˆ° Substrate è¿è¡Œæ—¶çš„å‡½æ•°è°ƒç”¨æ€»æ˜¯ä¸<a href="https://docs.substrate.io/reference/glossary/#weight">æƒé‡</a>ç›¸å…³è”ï¼Œä»¥åæ˜ èµ„æºä½¿ç”¨æƒ…å†µã€‚FRAME System æ¨¡å—è®¾ç½®è¾¹ç•Œï¼Œå¯ä»¥ä½¿ç”¨è¿™äº›äº¤æ˜“çš„å—é•¿åº¦å’Œå—æƒé‡ã€‚ç„¶è€Œï¼Œ<code>set_code</code> å‡½æ•°è¢«æœ‰æ„è®¾è®¡ä¸ºæ¶ˆè€—ä¸€ä¸ªå—æ‰€èƒ½å®¹çº³çš„æœ€å¤§æƒé‡ã€‚å¼ºåˆ¶è¿è¡Œæ—¶å‡çº§ä»¥æ¶ˆè€—æ•´ä¸ªå—ï¼Œå¯ä»¥é˜²æ­¢åŒä¸€å—ä¸­çš„äº¤æ˜“åœ¨è¿è¡Œæ—¶çš„ä¸åŒç‰ˆæœ¬ä¸Šæ‰§è¡Œã€‚</p>
<p><code>set_code</code> å‡½æ•°çš„æƒé‡æ³¨é‡Šè¿˜æŒ‡å®šè¯¥å‡½æ•°ä½äº <code>Operational</code> ç±»ä¸­ï¼Œå› ä¸ºå®ƒæä¾›ç½‘ç»œåŠŸèƒ½ã€‚æ ‡è¯†ä¸ºå¯æ“ä½œçš„å‡½æ•°è°ƒç”¨ï¼š</p>
<ul>
<li>å¯ä»¥æ¶ˆè€—ä¸€ä¸ªå—çš„å…¨éƒ¨æƒé‡é™åˆ¶ã€‚</li>
<li>ä¼˜å…ˆçº§æœ€é«˜ã€‚</li>
<li>å…é™¤æ”¯ä»˜äº¤æ˜“è´¹ç”¨ã€‚</li>
</ul>
<h4 id="ç®¡ç†èµ„æºæ ¸ç®—"><a class="header" href="#ç®¡ç†èµ„æºæ ¸ç®—">ç®¡ç†èµ„æºæ ¸ç®—</a></h4>
<p>åœ¨æœ¬èŠ‚æ•™ç¨‹ä¸­ï¼Œ<a href="https://paritytech.github.io/substrate/master/pallet_sudo/pallet/enum.Call.html#variant.sudo_unchecked_weight"><code>sudo_unchecked_weight</code></a> å‡½æ•°ç”¨äºä¸ºè¿è¡Œæ—¶å‡çº§è°ƒç”¨ <code>set_code</code> å‡½æ•°ã€‚<code>sudo_unchecked_weight</code> å‡½æ•°ä¸ <code>sudo</code> å‡½æ•°ç›¸åŒï¼Œåªæ˜¯å®ƒæ”¯æŒä¸€ä¸ªé™„åŠ å‚æ•°æ¥æŒ‡å®šç”¨äºè°ƒç”¨çš„æƒé‡ã€‚æ­¤å‚æ•°ä½¿ä½ èƒ½å¤Ÿç»•è¿‡èµ„æºæ ¸ç®—ä¿æŠ¤æªæ–½ï¼Œä¸ºåˆ†å‘ <code>set_code</code> å‡½æ•°çš„è°ƒç”¨æŒ‡å®šé›¶æƒé‡ã€‚æ­¤è®¾ç½®å…è®¸ä¸€ä¸ªå—èŠ±è´¹æ— é™æ—¶é—´è¿›è¡Œè®¡ç®—ï¼Œä»¥ç¡®ä¿è¿è¡Œæ—¶å‡çº§ä¸ä¼šå¤±è´¥ï¼Œæ— è®ºæ“ä½œå¤šä¹ˆå¤æ‚ã€‚å®ƒå¯èƒ½éœ€è¦æ‰€æœ‰æ—¶é—´æ‰èƒ½æ˜¾ç¤ºæˆåŠŸæˆ–å¤±è´¥ã€‚</p>
<h3 id="å‡çº§è¿è¡Œæ—¶ä»¥æ·»åŠ è°ƒåº¦ç¨‹åºpallet"><a class="header" href="#å‡çº§è¿è¡Œæ—¶ä»¥æ·»åŠ è°ƒåº¦ç¨‹åºpallet">å‡çº§è¿è¡Œæ—¶ä»¥æ·»åŠ è°ƒåº¦ç¨‹åºpallet</a></h3>
<p>node template åœ¨å…¶è¿è¡Œæ—¶ä¸­ä¸åŒ…å« <a href="https://paritytech.github.io/substrate/master/pallet_scheduler/index.html">Scheduler pallet</a>ã€‚ä¸ºäº†æ¼”ç¤ºè¿è¡Œæ—¶å‡çº§ï¼Œè®©æˆ‘ä»¬å°† Scheduler pallet æ·»åŠ åˆ°è¿è¡ŒèŠ‚ç‚¹ã€‚</p>
<p>è¦å‡çº§è¿è¡Œæ—¶ï¼Œé€šè¿‡è¿è¡Œä¸‹é¢çš„å‘½ä»¤åœ¨å¼€å‘æ¨¡å¼ä¸‹å¯åŠ¨æœ¬åœ°èŠ‚ç‚¹ï¼š</p>
<pre><code class="language-bash editable noplayground">cargo run --release -- --dev
</code></pre>
<p>ä¿æŒèŠ‚ç‚¹è¿è¡Œã€‚ä½ å¯ä»¥ç¼–è¾‘å¹¶é‡æ–°ç¼–è¯‘ä»¥å‡çº§è¿è¡Œæ—¶ï¼Œè€Œæ— éœ€åœæ­¢æˆ–é‡æ–°å¯åŠ¨æ­£åœ¨è¿è¡Œçš„èŠ‚ç‚¹ã€‚</p>
<p>åœ¨ç¬¬äºŒä¸ªç»ˆç«¯ä¸­ï¼Œåœ¨ç¼–è¾‘å™¨ä¸­æ‰“å¼€ <code>substrate-node-template/runtime/Cargo.toml</code> æ–‡ä»¶ï¼Œæ·»åŠ  Scheduler pallet ä½œä¸ºä¾èµ–é¡¹ã€‚</p>
<pre><code class="language-toml editable noplayground">[dependencies]
...
pallet-scheduler = { version = &quot;4.0.0-dev&quot;, default-features = false, git = &quot;https://github.com/paritytech/substrate.git&quot;, branch = &quot;polkadot-v0.9.28&quot; }
...
</code></pre>
<p>æ·»åŠ  Scheduler pallet åˆ° <code>features</code> åˆ—è¡¨ä¸­ã€‚</p>
<pre><code class="language-toml editable noplayground">[features]
default = [&quot;std&quot;]
std = [
 ...
 &quot;pallet-scheduler/std&quot;,
 ...
</code></pre>
<p>åœ¨ç¼–è¾‘å™¨ä¸­æ‰“å¼€ <code>substrate-node-template/runtime/src/lib.rs</code> æ–‡ä»¶ï¼Œæ·»åŠ  Scheduler pallet æ‰€éœ€çš„ç±»å‹ã€‚</p>
<pre><code class="language-rust editable noplayground">parameter_types! {
 pub MaximumSchedulerWeight: Weight = 10_000_000;
 pub const MaxScheduledPerBlock: u32 = 50;
}</code></pre>
<p>ä¸º Scheduler pallet çš„ Config trait æ·»åŠ å®ç°ã€‚</p>
<pre><code class="language-rust editable noplayground">impl pallet_scheduler::Config for Runtime {
 type Event = Event;
 type Origin = Origin;
 type PalletsOrigin = OriginCaller;
 type Call = Call;
 type MaximumWeight = MaximumSchedulerWeight;
 type ScheduleOrigin = frame_system::EnsureRoot&lt;AccountId&gt;;
 type MaxScheduledPerBlock = MaxScheduledPerBlock;
 type WeightInfo = ();
 type OriginPrivilegeCmp = EqualPrivilegeOnly;
 type PreimageProvider = ();
 type NoPreimagePostponement = ();
}</code></pre>
<p>åœ¨ <code>construct_runtime!</code> å®é‡Œæ·»åŠ  Scheduler palletã€‚</p>
<pre><code class="language-rust editable noplayground">construct_runtime!(
 pub enum Runtime where
 Block = Block,
 NodeBlock = opaque::Block,
 UncheckedExtrinsic = UncheckedExtrinsic
 {
   /*** snip ***/
   Scheduler: pallet_scheduler,
 }
);</code></pre>
<p>åœ¨æ–‡ä»¶çš„é¡¶éƒ¨æ·»åŠ ä»¥ä¸‹ trait ä¾èµ–ï¼š</p>
<pre><code class="language-rust editable noplayground">pub use frame_support::traits::EqualPrivilegeOnly;</code></pre>
<p>å¢åŠ  <a href="https://paritytech.github.io/substrate/master/sp_version/struct.RuntimeVersion.html"><code>RuntimeVersion</code> ç»“æ„</a>ä¸­çš„ <a href="https://paritytech.github.io/substrate/master/sp_version/struct.RuntimeVersion.html#structfield.spec_version">spec_version</a> ä»¥å‡çº§è¿è¡Œæ—¶ç‰ˆæœ¬ã€‚</p>
<pre><code class="language-rust editable noplayground">pub const VERSION: RuntimeVersion = RuntimeVersion {
 spec_name: create_runtime_str!(&quot;node-template&quot;),
 impl_name: create_runtime_str!(&quot;node-template&quot;),
 authoring_version: 1,
 spec_version: 101,  // *Increment* this value, the template uses 100 as a base
 impl_version: 1,
 apis: RUNTIME_API_VERSIONS,
 transaction_version: 1,
};</code></pre>
<p>æ£€æŸ¥ <code>RuntimeVersion</code> ç»“æ„ä½“çš„ç»„ä»¶ï¼š</p>
<ul>
<li><code>spec_name</code> æŒ‡å®šè¿è¡Œæ—¶çš„åç§°ã€‚</li>
<li><code>impl_name</code> æŒ‡å®šå®¢æˆ·ç«¯çš„åç§°ã€‚</li>
<li><code>authoring_version</code> æŒ‡å®š <a href="https://docs.substrate.io/reference/glossary/#author">block authors</a> çš„ç‰ˆæœ¬ã€‚</li>
<li><code>spec_version</code> æŒ‡å®šè¿è¡Œæ—¶çš„ç‰ˆæœ¬ã€‚</li>
<li><code>impl_version</code> æŒ‡å®šå®¢æˆ·ç«¯çš„ç‰ˆæœ¬ã€‚</li>
<li><code>apis</code> æŒ‡å®šæ”¯æŒçš„ APIs åˆ—è¡¨ã€‚</li>
<li><code>transaction_version</code> æŒ‡å®š <a href="https://docs.substrate.io/reference/glossary/#dispatch">dispatchable function</a> æ¥å£çš„ç‰ˆæœ¬ã€‚</li>
</ul>
<p>è¦å‡çº§è¿è¡Œæ—¶ï¼Œä½ å¿…é¡»é€’å¢ <code>spec_version</code> çš„å€¼ã€‚æ›´å¤šä¿¡æ¯è¯·å‚è§ <a href="https://github.com/paritytech/substrate/blob/v3.0.0/frame/system/src/lib.rs">FRAME System</a> æ¨¡å—å’Œ <code>can_set_code</code> å‡½æ•°ã€‚</p>
<p>ä¿å­˜ä»£ç å¹¶å…³é—­ <code>substrate-node-template/runtime/src/lib.rs</code> æ–‡ä»¶ã€‚</p>
<p>åœ¨ç¬¬äºŒä¸ªç»ˆç«¯çª—å£æˆ–é€‰é¡¹å¡ä¸­æ„å»ºæ›´æ–°çš„è¿è¡Œæ—¶ï¼Œè€Œä¸åœæ­¢æ­£åœ¨è¿è¡Œçš„èŠ‚ç‚¹ã€‚</p>
<pre><code class="language-bash editable noplayground">cargo build --release -p node-template-runtime
</code></pre>
<p><code>--release</code> å‘½ä»¤è¡Œé€‰é¡¹éœ€è¦è¾ƒé•¿çš„ç¼–è¯‘æ—¶é—´ã€‚ç„¶è€Œå®ƒç”Ÿæˆäº†ä¸€ä¸ªæ›´å°çš„æ„å»ºå·¥ä»¶ï¼Œæ›´é€‚åˆæäº¤åˆ°åŒºå—é“¾ç½‘ç»œã€‚å­˜å‚¨ä¼˜åŒ–å¯¹äºä»»ä½•åŒºå—é“¾éƒ½è‡³å…³é‡è¦ã€‚ä½¿ç”¨æ­¤å‘½ä»¤ï¼Œæ„å»ºå·¥ä»¶å°†è¾“å‡ºåˆ° <code>target/release</code> ç›®å½•ã€‚</p>
<p>è¿æ¥åˆ°æœ¬åœ°èŠ‚ç‚¹ä½¿ç”¨æ–°çš„æ„å»ºæ„ä»¶å‡çº§è¿è¡Œæ—¶ã€‚
ä½ å¯ä»¥ä½¿ç”¨ <a href="https://polkadot.js.org/apps/#/extrinsics?rpc=ws://127.0.0.1:9944">Polkadot-JS application</a> è¿æ¥åˆ°æœ¬åœ°èŠ‚ç‚¹ã€‚</p>
<p>é€‰æ‹© Alice å¸æˆ·æäº¤å¯¹ <code>sudoUncheckedWeight</code> å‡½æ•°çš„è°ƒç”¨ï¼Œå¹¶ä¸”ä» <code>system</code> pallet è°ƒç”¨ <code>setCode</code> å‡½æ•°ä½œä¸ºå…¶å‚æ•°ã€‚</p>
<p><img src="https://awesomeprogram.gitee.io/imgdata/tech_bc_subselaca.jpg" alt="" /></p>
<p>é€‰æ‹© <code>file upload</code>ï¼Œç„¶åé€‰æ‹©æˆ–æ‹–æ”¾è¿è¡Œæ—¶ç”Ÿæˆçš„ WebAssembly æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œç‚¹å‡»é€‰æ‹© <code>target/release/wbuild/node-template-runtime/node_template_runtime.compact.compressed.wasm</code> æ–‡ä»¶ã€‚ä¿ç•™ <code>_weight</code> å‚æ•°çš„é»˜è®¤å€¼ä¸º <code>0</code>ã€‚</p>
<p><img src="https://awesomeprogram.gitee.io/imgdata/tech_bc_sudupg.jpg" alt="" /></p>
<p>ç‚¹å‡» <strong>Submit Transaction</strong>ã€‚</p>
<p>æŸ¥çœ‹æˆæƒï¼Œç„¶åç‚¹å‡» <strong>Sign and Submit</strong>ã€‚</p>
<p>åœ¨äº¤æ˜“åŒ…å«åœ¨ä¸€ä¸ªå—ä¸­ä¹‹åï¼ŒPolkadot-JS åº”ç”¨ç¨‹åºä¸­æ˜¾ç¤ºçš„ç‰ˆæœ¬å·è¡¨æ˜è¿è¡Œæ—¶ç‰ˆæœ¬ç°åœ¨æ˜¯ <code>101</code>ã€‚</p>
<p><img src="https://awesomeprogram.gitee.io/imgdata/tech_bc_subver101.jpg" alt="" /></p>
<p>å¦‚æœä½ çš„æœ¬åœ°èŠ‚ç‚¹åœ¨ç»ˆç«¯ä¸­ç”Ÿæˆçš„å—ä¸æµè§ˆå™¨ä¸­æ˜¾ç¤ºçš„åŒ¹é…ï¼Œé‚£ä¹ˆä½ å·²ç»æˆåŠŸå®Œæˆäº†è¿è¡Œæ—¶å‡çº§ã€‚</p>
<p>ä¸‹ä¸€æ­¥ï¼Œæˆ‘ä»¬å°†ï¼š</p>
<ol>
<li>å‡çº§ä½ çš„è¿è¡Œæ—¶ç‰ˆæœ¬</li>
<li>ä½¿ç”¨ Scheduler pallet æ¥è°ƒåº¦æ­£åœ¨é“¾ä¸Šè¿è¡Œçš„è¿è¡Œæ—¶å‡çº§</li>
</ol>
<h3 id="è°ƒåº¦ä¸€ä¸ªå‡çº§"><a class="header" href="#è°ƒåº¦ä¸€ä¸ªå‡çº§">è°ƒåº¦ä¸€ä¸ªå‡çº§</a></h3>
<p>æ—¢ç„¶ node template å·²ç»å‡çº§åˆ°åŒ…å« Scheduler palletï¼Œé‚£ä¹ˆ <a href="https://paritytech.github.io/substrate/master/pallet_scheduler/pallet/enum.Call.html#variant.schedule"><code>schedule</code> å‡½æ•°</a> å°±å¯ä»¥ç”¨äºæ‰§è¡Œä¸‹ä¸€æ¬¡è¿è¡Œæ—¶å‡çº§ã€‚åœ¨ä¹‹å‰çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>sudo_unchecked_weight</code> å‡½æ•°è¦†ç›– <code>set_code</code> å‡½æ•°çš„å…³è”æƒé‡ï¼›åœ¨æœ¬èŠ‚ä¸­ï¼Œå°†å®‰æ’è¿è¡Œæ—¶å‡çº§ï¼Œä»¥ä¾¿å®ƒå¯ä»¥ä½œä¸ºå—ä¸­çš„å”¯ä¸€<a href="https://docs.substrate.io/fundamentals/transaction-types/">å¤–éƒ¨</a>å› ç´ å¤„ç†ã€‚</p>
<h4 id="å‡†å¤‡ä¸€ä¸ªå¯å‡çº§çš„è¿è¡Œæ—¶"><a class="header" href="#å‡†å¤‡ä¸€ä¸ªå¯å‡çº§çš„è¿è¡Œæ—¶">å‡†å¤‡ä¸€ä¸ªå¯å‡çº§çš„è¿è¡Œæ—¶</a></h4>
<p>æ­¤å‡çº§æ¯”ä¹‹å‰çš„å‡çº§æ›´ç®€å•ï¼Œåªéœ€è¦æ›´æ–° <code>runtime/src/lib.rs</code> ä¸­çš„å•ä¸ªå€¼ï¼Œé™¤äº†è¿è¡Œæ—¶çš„ <code>spec_version</code> ä¹‹å¤–ã€‚</p>
<pre><code class="language-rust editable noplayground">pub const VERSION: RuntimeVersion = RuntimeVersion {
 spec_name: create_runtime_str!(&quot;node-template&quot;),
 impl_name: create_runtime_str!(&quot;node-template&quot;),
 authoring_version: 1,
 spec_version: 102,  // *Increment* this value.
 impl_version: 1,
 apis: RUNTIME_API_VERSIONS,
 transaction_version: 1,
};

/*** snip ***/

parameter_types! {
 pub const ExistentialDeposit: u128 = 1000;  // Update this value.
 pub const MaxLocks: u32 = 50;
}

/*** snip ***/</code></pre>
<p>è¿™ä¸€å˜åŒ–å¢åŠ äº† Balances pallet çš„ <a href="https://docs.substrate.io/reference/glossary/#existential-deposit"><code>ExistentialDeposit</code></a>ï¼Œä» Balances pallet çš„è§’åº¦æ¥çœ‹ï¼Œéœ€è¦ä¿æŒå¸æˆ·å­˜æ´»çš„æœ€ä½ä½™é¢ã€‚</p>
<p>è¯·è®°ä½ï¼Œæ­¤æ›´æ”¹ä¸ä¼šå¯¼è‡´æ‰€æœ‰åœ¨500åˆ°1000ä¹‹é—´çš„ä½™é¢éƒ½è¢«è·å–ï¼Œè¿™å°†éœ€è¦è¿›è¡Œå­˜å‚¨è¿ç§»ï¼Œä¸åœ¨æœ¬èŠ‚æ•™ç¨‹çš„èŒƒå›´ã€‚</p>
<h4 id="æ„å»ºä¸€ä¸ªå¯å‡çº§çš„è¿è¡Œæ—¶"><a class="header" href="#æ„å»ºä¸€ä¸ªå¯å‡çº§çš„è¿è¡Œæ—¶">æ„å»ºä¸€ä¸ªå¯å‡çº§çš„è¿è¡Œæ—¶</a></h4>
<pre><code class="language-bash editable noplayground">cargo build --release -p node-template-runtime
</code></pre>
<p>è¿™å°†è¦†ç›–ä»»ä½•ä»¥å‰çš„æ„å»ºå·¥ä»¶ã€‚å› æ­¤å¦‚æœä½ å¸Œæœ›æœ‰æœ€åä¸€ä¸ªè¿è¡Œæ—¶ Wasm æ„å»ºæ–‡ä»¶çš„å‰¯æœ¬ï¼Œè¯·ç¡®ä¿å·²ç»å°†å®ƒä»¬å¤åˆ¶åˆ°å…¶ä»–åœ°æ–¹ã€‚</p>
<h4 id="å‡çº§è¿è¡Œæ—¶"><a class="header" href="#å‡çº§è¿è¡Œæ—¶">å‡çº§è¿è¡Œæ—¶</a></h4>
<p>åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œ<code>Scheduler pallet</code> é…ç½®äº† <code>Root</code> æºä½œä¸ºå…¶ <a href="https://paritytech.github.io/substrate/master/pallet_scheduler/pallet/trait.Config.html#associatedtype.ScheduleOrigin"><code>ScheduleOrigin</code></a>ï¼Œè¿™æ„å‘³ç€å¯ä»¥ä½¿ç”¨ <code>sudo</code> å‡½æ•°ï¼ˆè€Œä¸æ˜¯ <code>sudo_unchecked_weight</code>ï¼‰æ¥è°ƒç”¨ <code>schedule</code> å‡½æ•°ã€‚ä½¿ç”¨æ­¤é“¾æ¥æ‰“å¼€ Polkadot JS åº”ç”¨ç¨‹åº UI çš„ <code>Sudo</code> æ ‡ç­¾ï¼š<a href="https://polkadot.js.org/apps/#/sudo?rpc=ws://127.0.0.1:9944">https://polkadot.js.org/apps/#/sudo?rpc=ws://127.0.0.1:9944</a>ã€‚</p>
<p>åœ¨æä¾› <code>when</code> å‚æ•°ä¹‹å‰ï¼Œç­‰å¾…æ‰€æœ‰å…¶ä»–å­—æ®µéƒ½è¢«å¡«å……ã€‚ä¿ç•™ <code>maybe_periodic</code> å‚æ•°ä¸ºç©ºï¼Œ<code>priority</code> å‚æ•°çš„é»˜è®¤å€¼ä¸º <code>0</code>ã€‚é€‰æ‹© System pallet çš„ <code>set_code</code> å‡½æ•°ä½œä¸º <code>call</code> å‚æ•°ï¼Œå¹¶åƒä¹‹å‰ä¸€æ ·æä¾› Wasm äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ä¿ç•™ <strong>with weight override</strong> é€‰é¡¹ä¸æ¿€æ´»ã€‚ä¸€æ—¦å¡«å……äº†æ‰€æœ‰å…¶ä»–å­—æ®µï¼Œä»¥åä½¿ç”¨å¤§çº¦10ä¸ªåŒºå—ï¼ˆ1åˆ†é’Ÿï¼‰çš„åŒºå—å·æ¥å¡«å…… <code>when</code> å‚æ•°å¹¶å¿«é€Ÿæäº¤äº¤æ˜“ã€‚</p>
<p><img src="https://awesomeprogram.gitee.io/imgdata/tech_bc_subschupg.jpg" alt="" /></p>
<p>ä½ å¯ä»¥ä½¿ç”¨æ¨¡æ¿èŠ‚ç‚¹çš„å‘½ä»¤è¡Œè¾“å‡ºæˆ– <a href="https://polkadot.js.org/apps/#/explorer?rpc=ws://127.0.0.1:9944">Polkadot JS Apps UI block explorer</a> æ¥ç›‘è§†è¿™ä¸ªé¢„å®šè°ƒç”¨çš„å‘ç”Ÿã€‚</p>
<p><img src="https://awesomeprogram.gitee.io/imgdata/tech_bc_subscupsu.jpg" alt="" /></p>
<p>åœ¨ç›®æ ‡åŒºå—è¢«åŒ…å«åœ¨é“¾ä¸­ä¹‹åï¼ŒPolkadot JS åº”ç”¨ç¨‹åºç•Œé¢å·¦ä¸Šè§’çš„ç‰ˆæœ¬å·åº”è¯¥åæ˜ å‡ºè¿è¡Œæ—¶çš„ç‰ˆæœ¬ç°åœ¨æ˜¯ <code>102</code>ã€‚</p>
<p>ç„¶åï¼Œä½ å¯ä»¥é€šè¿‡ä½¿ç”¨ <a href="https://polkadot.js.org/apps/#/chainstate/constants?rpc=ws://127.0.0.1:9944">Polkadot JS app UI Chain State</a> åº”ç”¨ç¨‹åºæ¥è§‚å¯Ÿå‡çº§ä¸­æ‰€åšçš„å…·ä½“å˜åŒ–ï¼Œä»¥ä» Balances pallet ä¸­æŸ¥è¯¢ <code>existentialDeposit</code> å¸¸é‡å€¼ã€‚</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../blockchain/chapter_1_2_1_2.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../blockchain/chapter_1_2_1_4.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../blockchain/chapter_1_2_1_2.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../blockchain/chapter_1_2_1_4.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>


        <!-- Google Analytics Tag -->
        <script>
            var localAddrs = ["localhost", "127.0.0.1", ""];

            // make sure we don't activate google analytics if the developer is
            // inspecting the book locally...
            if (localAddrs.indexOf(document.location.hostname) === -1) {
                (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
                (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
                m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
                })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

                ga('create', 'G-ZHWPPT6ESV', 'auto');
                ga('send', 'pageview');
            }
        </script>


        <script>
            window.playground_copyable = true;
        </script>

        <script src="../ace.js"></script>
        <script src="../editor.js"></script>
        <script src="../mode-rust.js"></script>
        <script src="../theme-dawn.js"></script>
        <script src="../theme-tomorrow_night.js"></script>

        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
